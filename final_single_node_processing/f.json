{
    "list": [
        {
            "queryId": "20200703_012602_07132_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_original_events_delta -- 1289838\nAS\n\n    SELECT  uuid, msid, app_id, instance_id, date_created, was_demo, initiator_name\n            , case  when evid=19 then 'remove_app' else 'add_app' end AS action_type\n    FROM        sunduk.baguild.slowly_src50_events_delta    a\n    LEFT JOIN   prod.verticals.transfer_site_type           b ON    msid=temp_site\n    LEFT JOIN   prod.verticals.slowly_apps_to_filter        c ON    app_id=apps_to_filter_out\n    WHERE evid in (17, 34, 19) AND coalesce(temp_site,apps_to_filter_out) is null\n                                UNION ALL\n    SELECT  uuid, msid, '1380b703-ce81-ff05-f115-39571d94dfcd' AS app_id, store_id AS instance_id\n            , date_created, null AS was_demo, null AS initiator_name, 'stores_migration' AS action_type \n    FROM        sunduk.baguild.slowly_src10_events_delta    a\n    LEFT JOIN   prod.verticals.transfer_site_type      b ON    msid=temp_site\n    WHERE temp_site is null AND evid=1306 -- stores migration",
            "queryName": "create sunduk.baguild.slowly_original_events_delta",
            "queryStats": {
                "elapsedTime": "13.71s",
                "planningTime": "2.51s",
                "analysisTime": "3.45s",
                "queuedTime": "2.44ms",
                "executionTime": "10.26s",
                "totalCpuTime": "23.13s",
                "rawInputDataSize": "2.28GB",
                "internalNetworkInputDataSize": "1.01GB",
                "physicalInputDataSize": "2.28GB",
                "processedInputDataSize": "2.28GB",
                "rawInputPositions": "3082834",
                "internalNetworkInputPositions": "5708356",
                "physicalInputPositions": "3082834",
                "processedInputPositions": "3082834",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "496.04MB",
                "writtenPositions": "2593187",
                "peakTotalMemoryReservation": "16.52MB",
                "peakTaskTotalMemory": "16.52MB",
                "totalSplits": 735,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "prod.verticals.slowly_apps_to_filter",
                    "prod.verticals.transfer_site_type",
                    "sunduk.baguild.slowly_src10_events_delta",
                    "sunduk.baguild.slowly_src50_events_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "7.73s",
                    "totalQueuedTime": "3.91ms",
                    "totalScheduledTime": "860.12ms",
                    "totalCpuTime": "32.27ms",
                    "totalBlockedTime": "34.27s",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "3.98s",
                    "totalQueuedTime": "4.96m",
                    "totalScheduledTime": "17.65s",
                    "totalCpuTime": "8.47s",
                    "totalBlockedTime": "9.72m",
                    "rawInputDataSize": "521.76MB",
                    "internalNetworkInputDataSize": "521.76MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "546.74MB",
                    "rawInputPositions": "2854174",
                    "internalNetworkInputPositions": "2854174",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "2854174",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 464,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "2.54s",
                    "totalQueuedTime": "1.96m",
                    "totalScheduledTime": "3.90s",
                    "totalCpuTime": "3.85s",
                    "totalBlockedTime": "2.77m",
                    "rawInputDataSize": "511.23MB",
                    "internalNetworkInputDataSize": "511.23MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "534.02MB",
                    "rawInputPositions": "2854166",
                    "internalNetworkInputPositions": "2854166",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "2854166",
                    "outputDataSize": "537.81MB",
                    "outputPositions": "2666657",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 192,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "970.00ms",
                    "totalQueuedTime": "21.02s",
                    "totalScheduledTime": "23.59s",
                    "totalCpuTime": "9.98s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "2.20GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "2.20GB",
                    "processedInputDataSize": "2.20GB",
                    "rawInputPositions": "2707808",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2707808",
                    "processedInputPositions": "2707808",
                    "outputDataSize": "525.07MB",
                    "outputPositions": "2666657",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 40,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "970.00ms",
                    "totalQueuedTime": "8.81s",
                    "totalScheduledTime": "2.23s",
                    "totalCpuTime": "348.43ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "1.61MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "1.61MB",
                    "processedInputDataSize": "1.61MB",
                    "rawInputPositions": "187509",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "187509",
                    "processedInputPositions": "187509",
                    "outputDataSize": "8.94MB",
                    "outputPositions": "187509",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "5": {
                    "stageDuration": "904.00ms",
                    "totalQueuedTime": "83.72ms",
                    "totalScheduledTime": "60.29ms",
                    "totalCpuTime": "11.62ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "0B",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "0B",
                    "rawInputPositions": "8",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "8",
                    "processedInputPositions": "8",
                    "outputDataSize": "728B",
                    "outputPositions": "8",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 1,
                    "spilledDataSize": "0B"
                },
                "6": {
                    "stageDuration": "975.00ms",
                    "totalQueuedTime": "433.22us",
                    "totalScheduledTime": "53.75us",
                    "totalCpuTime": "51.96us",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "0B",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "0B",
                    "rawInputPositions": "0",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "0",
                    "outputDataSize": "0B",
                    "outputPositions": "0",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 1,
                    "spilledDataSize": "0B"
                },
                "7": {
                    "stageDuration": "978.00ms",
                    "totalQueuedTime": "7.57s",
                    "totalScheduledTime": "2.15s",
                    "totalCpuTime": "440.57ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "85.81MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "85.81MB",
                    "processedInputDataSize": "85.81MB",
                    "rawInputPositions": "187509",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "187509",
                    "processedInputPositions": "187509",
                    "outputDataSize": "8.94MB",
                    "outputPositions": "187509",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: prod.verticals.transfer_site_type scanned 2 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.6/5    elapsed: 00:00:35.169,  cpu: 00:00:00.032,  blocked: 00:00:34.270,  queue: 00:00:00.003,  scheduled: 00:00:00.860 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.858,  finishWall: 00:00:00.000)  other: 00:00:00.035,  timeCost: 1.7%,  blocked: 97.4%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  275.8/464  elapsed: 00:18:16.895,  cpu: 00:00:08.470,  blocked: 00:09:43.200,  queue: 00:04:57.770,  scheduled: 00:00:17.650 (addInputWall: 00:00:06.217,  getOutputWall: 00:00:01.500,  finishWall: 00:00:09.904)  other: 00:03:18.275,  timeCost: 35.0%,  blocked: 53.2%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "2"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.0"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "3"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.0"
                },
                {
                    "source": {
                        "stageId": "1",
                        "taskId": "11"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(90.65MB)/P50(30.08MB) = 3.0 times"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  144.0/192  elapsed: 00:06:05.878,  cpu: 00:00:03.850,  blocked: 00:02:46.200,  queue: 00:01:57.533,  scheduled: 00:00:03.900 (addInputWall: 00:00:02.478,  getOutputWall: 00:00:01.135,  finishWall: 00:00:00.283)  other: 00:01:18.244,  timeCost: 7.7%,  blocked: 45.4%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.0"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   46.0/40   elapsed: 00:00:44.605,  cpu: 00:00:09.980,  blocked: 00:00:00.000,  queue: 00:00:21.015,  scheduled: 00:00:23.590 (addInputWall: 00:00:17.110,  getOutputWall: 00:00:20.940,  finishWall: 00:00:00.268)  other: 00:00:00.000,  timeCost: 46.8%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4   11.4/16   elapsed: 00:00:11.041,  cpu: 00:00:00.348,  blocked: 00:00:00.000,  queue: 00:00:08.812,  scheduled: 00:00:02.230 (addInputWall: 00:00:00.139,  getOutputWall: 00:00:02.200,  finishWall: 00:00:00.007)  other: 00:00:00.000,  timeCost: 4.4%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "5"
                    },
                    "level": "INFO",
                    "message": "stage.5    0.2/1    elapsed: 00:00:00.144,  cpu: 00:00:00.011,  blocked: 00:00:00.000,  queue: 00:00:00.083,  scheduled: 00:00:00.060 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.060,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "6"
                    },
                    "level": "INFO",
                    "message": "stage.6    0.0/1    elapsed: 00:00:00.000,  cpu: 00:00:00.000,  blocked: 00:00:00.000,  queue: 00:00:00.000,  scheduled: 00:00:00.000 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.000,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "7"
                    },
                    "level": "INFO",
                    "message": "stage.7    9.9/16   elapsed: 00:00:09.723,  cpu: 00:00:00.440,  blocked: 00:00:00.000,  queue: 00:00:07.572,  scheduled: 00:00:02.150 (addInputWall: 00:00:00.571,  getOutputWall: 00:00:02.120,  finishWall: 00:00:00.007)  other: 00:00:00.000,  timeCost: 4.3%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "7",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 89.6 of data dropped"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"30\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"28\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_original_events_delta; tablePath=s3a://wix-bi-sunduk/baguild/e2e4e481-fcce-469d-8b88-23540a06bdb9; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [date_created, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(16), 8]], hash=482714130]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1027\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"847\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"29\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid_58\\nmsid := msid_59\\napp_id := app_id_60\\ninstance_id := instance_id_61\\ndate_created := date_created_62\\nwas_demo := was_demo_63\\ninitiator_name := initiator_name_64\\naction_type := expr_65\\n\",\n  \"children\" : [ {\n    \"id\" : \"1026\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1025\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[ROUND_ROBIN] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"14\",\n        \"name\" : \"Project\",\n        \"identifier\" : \"[]\",\n        \"details\" : \"expr_26 := CAST((CASE WHEN (\\\"evid\\\" = BIGINT '19') THEN 'remove_app' ELSE CAST('add_app' AS varchar(10)) END) AS varchar(16))\\n\",\n        \"children\" : [ {\n          \"id\" : \"355\",\n          \"name\" : \"FilterProject\",\n          \"identifier\" : \"[filterPredicate = (COALESCE(\\\"temp_site\\\", CAST(\\\"apps_to_filter_out\\\" AS varchar)) IS NULL)]\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"9\",\n            \"name\" : \"LeftJoin\",\n            \"identifier\" : \"[(\\\"app_id\\\" = \\\"apps_to_filter_out_3\\\")][$hashvalue, $hashvalue_88]\",\n            \"details\" : \"Distribution: PARTITIONED\\n\",\n            \"children\" : [ {\n              \"id\" : \"842\",\n              \"name\" : \"RemoteSource\",\n              \"identifier\" : \"[2]\",\n              \"details\" : \"\",\n              \"children\" : [ ],\n              \"remoteSources\" : [ \"2\" ]\n            }, {\n              \"id\" : \"1023\",\n              \"name\" : \"LocalExchange\",\n              \"identifier\" : \"[HASH][$hashvalue_88] (\\\"apps_to_filter_out_3\\\")\",\n              \"details\" : \"\",\n              \"children\" : [ {\n                \"id\" : \"843\",\n                \"name\" : \"RemoteSource\",\n                \"identifier\" : \"[5]\",\n                \"details\" : \"\",\n                \"children\" : [ ],\n                \"remoteSources\" : [ \"5\" ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      }, {\n        \"id\" : \"24\",\n        \"name\" : \"Project\",\n        \"identifier\" : \"[]\",\n        \"details\" : \"expr_55 := CAST(null AS boolean)\\nexpr_56 := CAST(null AS varchar)\\nexpr_41 := 'stores_migration'\\nexpr_52 := CAST('1380b703-ce81-ff05-f115-39571d94dfcd' AS varchar)\\n\",\n        \"children\" : [ {\n          \"id\" : \"360\",\n          \"name\" : \"FilterProject\",\n          \"identifier\" : \"[filterPredicate = (\\\"temp_site_31\\\" IS NULL)]\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"19\",\n            \"name\" : \"LeftJoin\",\n            \"identifier\" : \"[(\\\"msid_29\\\" = \\\"temp_site_31\\\")][$hashvalue_91, $hashvalue_93]\",\n            \"details\" : \"Distribution: PARTITIONED\\n\",\n            \"children\" : [ {\n              \"id\" : \"845\",\n              \"name\" : \"RemoteSource\",\n              \"identifier\" : \"[6]\",\n              \"details\" : \"\",\n              \"children\" : [ ],\n              \"remoteSources\" : [ \"6\" ]\n            }, {\n              \"id\" : \"1024\",\n              \"name\" : \"LocalExchange\",\n              \"identifier\" : \"[HASH][$hashvalue_93] (\\\"temp_site_31\\\")\",\n              \"details\" : \"\",\n              \"children\" : [ {\n                \"id\" : \"846\",\n                \"name\" : \"RemoteSource\",\n                \"identifier\" : \"[7]\",\n                \"details\" : \"\",\n                \"children\" : [ ],\n                \"remoteSources\" : [ \"7\" ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"1162\",\n  \"name\" : \"Project\",\n  \"identifier\" : \"[]\",\n  \"details\" : \"$hashvalue_87 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0))\\n\",\n  \"children\" : [ {\n    \"id\" : \"4\",\n    \"name\" : \"LeftJoin\",\n    \"identifier\" : \"[(\\\"msid\\\" = \\\"temp_site\\\")][$hashvalue_82, $hashvalue_84]\",\n    \"details\" : \"Distribution: PARTITIONED\\n\",\n    \"children\" : [ {\n      \"id\" : \"840\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[3]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"3\" ]\n    }, {\n      \"id\" : \"1022\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[HASH][$hashvalue_84] (\\\"temp_site\\\")\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"841\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[4]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"4\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": [
                                    {
                                        "stageId": "3",
                                        "plan": "{\n  \"id\" : \"1160\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_src50_events_delta', folderName='c4b34e59-7080-45d8-a8bf-b9c1849256b7', columns='[[app_id,varchar,false], [date_created,timestamp,false], [evid,bigint,false], [initiator_name,varchar,false], [instance_id,varchar,false], [metasitename,varchar,false], [msid,varchar,false], [src,bigint,false], [targetmetasiteid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"evid\\\" IN (BIGINT '17', BIGINT '19', BIGINT '34'))]\",\n  \"details\" : \"$hashvalue_83 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nmsid := [msid, varchar, 6]\\ninstance_id := [instance_id, varchar, 4]\\nevid := [evid, bigint, 2]\\n    :: [[17], [19], [34]]\\nwas_demo := [was_demo, boolean, 10]\\ndate_created := [date_created, timestamp, 1]\\ninitiator_name := [initiator_name, varchar, 3]\\nuuid := [uuid, varchar, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                        "subStages": []
                                    },
                                    {
                                        "stageId": "4",
                                        "plan": "{\n  \"id\" : \"1161\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='transfer_site_type', folderName='0b0048d8-2473-401a-91a2-daa4e37f8d80', columns='[[temp_site,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_86 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"temp_site\\\"), 0))\\ntemp_site := [temp_site, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                        "subStages": []
                                    }
                                ]
                            },
                            {
                                "stageId": "5",
                                "plan": "{\n  \"id\" : \"1163\",\n  \"name\" : \"Project\",\n  \"identifier\" : \"[]\",\n  \"details\" : \"$hashvalue_90 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"apps_to_filter_out_3\\\"), 0))\\n\",\n  \"children\" : [ {\n    \"id\" : \"8\",\n    \"name\" : \"ScanProject\",\n    \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_apps_to_filter', folderName='64af508c-a944-4e5b-8a8b-cdb6e73bf158', columns='[[apps_to_filter_out,varchar(36),false]]'}]\",\n    \"details\" : \"apps_to_filter_out_3 := CAST(\\\"apps_to_filter_out\\\" AS varchar)\\napps_to_filter_out := [apps_to_filter_out, varchar(36), 0]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "6",
                                "plan": "{\n  \"id\" : \"357\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_src10_events_delta', folderName='5198d92c-1542-47a3-a8cf-746a1a1058ea', columns='[[date_created,timestamp,false], [evid,bigint,false], [msid,varchar,false], [store_id,varchar,false], [uuid,varchar,false]]'}, filterPredicate = (\\\"evid_28\\\" = BIGINT '1306')]\",\n  \"details\" : \"$hashvalue_92 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_29\\\"), 0))\\nstore_id := [store_id, varchar, 3]\\nuuid_30 := [uuid, varchar, 4]\\ndate_created_27 := [date_created, timestamp, 0]\\nmsid_29 := [msid, varchar, 2]\\nevid_28 := [evid, bigint, 1]\\n    :: [[1306]]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "7",
                                "plan": "{\n  \"id\" : \"1164\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='transfer_site_type', folderName='0b0048d8-2473-401a-91a2-daa4e37f8d80', columns='[[temp_site,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_95 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"temp_site_31\\\"), 0))\\ntemp_site_31 := [temp_site, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_012616_07163_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  prod.verticals.slowly_transfer_site_new_delta --1176\nAS\n\n    SELECT  origin_uuid, uuid, origin_msid, msid, date_created, transfer_type, is_real_site, last_publish_date, is_published\n    FROM prod.verticals.transfer_full_data\n    WHERE   is_real_site AND transfer_type = 'new' -- only non-temp sites\n            AND date_created between date_add('second', -10, date_trunc('second', (timestamp '2020-07-02 01:00:56'))) and date_add('second', 10, date_trunc('second', (timestamp '2020-07-03 00:56:28')))\n    GROUP by 1,2,3,4,5,6,7,8,9",
            "queryName": "create prod.verticals.slowly_transfer_site_new_delta",
            "queryStats": {
                "elapsedTime": "4.24s",
                "planningTime": "781.09ms",
                "analysisTime": "271.50ms",
                "queuedTime": "6.64ms",
                "executionTime": "3.97s",
                "totalCpuTime": "1.76s",
                "rawInputDataSize": "95.74MB",
                "internalNetworkInputDataSize": "356.74kB",
                "physicalInputDataSize": "95.74MB",
                "processedInputDataSize": "95.74MB",
                "rawInputPositions": "647787",
                "internalNetworkInputPositions": "1851",
                "physicalInputPositions": "647787",
                "processedInputPositions": "647787",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "347.61kB",
                "writtenPositions": "1835",
                "peakTotalMemoryReservation": "143.75kB",
                "peakTaskTotalMemory": "71.88kB",
                "totalSplits": 153,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "prod.verticals.transfer_full_data"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "3.18s",
                    "totalQueuedTime": "3.81ms",
                    "totalScheduledTime": "862.54ms",
                    "totalCpuTime": "28.68ms",
                    "totalBlockedTime": "11.56s",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "1.49s",
                    "totalQueuedTime": "9.13s",
                    "totalScheduledTime": "3.01s",
                    "totalCpuTime": "269.88ms",
                    "totalBlockedTime": "3.13m",
                    "rawInputDataSize": "355.75kB",
                    "internalNetworkInputDataSize": "355.75kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "363.76kB",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "1835",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "1835",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 144,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "241.00ms",
                    "totalQueuedTime": "3.69ms",
                    "totalScheduledTime": "2.08s",
                    "totalCpuTime": "1.46s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "95.74MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "95.74MB",
                    "processedInputDataSize": "95.74MB",
                    "rawInputPositions": "647787",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "647787",
                    "processedInputPositions": "647787",
                    "outputDataSize": "363.78kB",
                    "outputPositions": "1835",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 4,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    3.9/5    elapsed: 00:00:12.437,  cpu: 00:00:00.028,  blocked: 00:00:11.560,  queue: 00:00:00.003,  scheduled: 00:00:00.862 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.860,  finishWall: 00:00:00.000)  other: 00:00:00.011,  timeCost: 14.5%,  blocked: 92.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  149.6/144  elapsed: 00:03:42.247,  cpu: 00:00:00.269,  blocked: 00:03:07.800,  queue: 00:00:09.126,  scheduled: 00:00:03.010 (addInputWall: 00:00:00.297,  getOutputWall: 00:00:00.071,  finishWall: 00:00:02.643)  other: 00:00:22.311,  timeCost: 50.6%,  blocked: 84.5%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2    8.6/4    elapsed: 00:00:02.078,  cpu: 00:00:01.460,  blocked: 00:00:00.000,  queue: 00:00:00.003,  scheduled: 00:00:02.080 (addInputWall: 00:00:01.224,  getOutputWall: 00:00:02.054,  finishWall: 00:00:00.003)  other: 00:00:00.000,  timeCost: 34.9%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.1"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 99.6 of data dropped"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"11\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"9\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[prod:connectorId=prod; schemaName=verticals; tableName=slowly_transfer_site_new_delta; tablePath=s3a://wix-bi-data-warehouse/dynamic/5f32479c-ba39-454f-852b-f2c35732f970; columnHandles=[[origin_uuid, varchar, 1], [uuid, varchar, 2], [origin_msid, varchar, 3], [msid, varchar, 4], [date_created, timestamp, 5], [transfer_type, varchar(11), 6], [is_real_site, boolean, 7], [last_publish_date, timestamp, 8], [is_published, boolean, 9]], hash=-1959519924]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"274\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"227\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"10\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"origin_uuid := origin_uuid\\nuuid := uuid\\norigin_msid := origin_msid\\nmsid := msid\\ndate_created := date_created\\ntransfer_type := transfer_type\\nis_real_site := is_real_site\\nlast_publish_date := last_publish_date\\nis_published := is_published\\n\",\n  \"children\" : [ {\n    \"id\" : \"273\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"338\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"4\",\n        \"name\" : \"Aggregate(FINAL)[origin_uuid, uuid, origin_msid, msid, date_created, transfer_type, is_real_site, last_publish_date, is_published][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"290\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"origin_uuid\\\", \\\"uuid\\\", \\\"origin_msid\\\", \\\"msid\\\", \\\"date_created\\\", \\\"transfer_type\\\", \\\"is_real_site\\\", \\\"last_publish_date\\\", \\\"is_published\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"296\",\n            \"name\" : \"RemoteSource\",\n            \"identifier\" : \"[2]\",\n            \"details\" : \"\",\n            \"children\" : [ ],\n            \"remoteSources\" : [ \"2\" ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"294\",\n  \"name\" : \"Aggregate(PARTIAL)[origin_uuid, uuid, origin_msid, msid, date_created, transfer_type, is_real_site, last_publish_date, is_published][$hashvalue_45]\",\n  \"identifier\" : \"\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"337\",\n    \"name\" : \"ScanFilterProject\",\n    \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='transfer_full_data', folderName='10638113-2af9-4e4c-bf56-5a6d4bde8410', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}, filterPredicate = (((\\\"transfer_type\\\" = CAST('new' AS varchar(11))) AND (\\\"date_created\\\" BETWEEN \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593651646000) AND \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593737798000))) AND \\\"is_real_site\\\")]\",\n    \"details\" : \"$hashvalue_45 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"origin_uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"origin_msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"transfer_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_real_site\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"last_publish_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0))\\nis_real_site := [is_real_site, boolean, 2]\\nmsid := [msid, varchar, 4]\\norigin_msid := [origin_msid, varchar, 5]\\nlast_publish_date := [last_publish_date, timestamp, 3]\\nis_published := [is_published, boolean, 1]\\ndate_created := [date_created, timestamp, 0]\\n    :: [[2020-07-02 01:00:46.000, 2020-07-03 00:56:38.000]]\\norigin_uuid := [origin_uuid, varchar, 6]\\ntransfer_type := [transfer_type, varchar(11), 7]\\n    :: [[new]]\\nuuid := [uuid, varchar, 8]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_012620_07170_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  prod.verticals.slowly_delete_site_delta --32338\nAS\n\n    SELECT  msid, date_created, 'delete_site' as action_type\n    FROM sunduk.baguild.slowly_src50_events_delta\n    WHERE evid=29\n    -- no need to filter for temp_site is null sites from prod.verticals.transfer_site_type, it's enough that 'add_app' events are filtered",
            "queryName": "create prod.verticals.slowly_delete_site_delta",
            "queryStats": {
                "elapsedTime": "4.73s",
                "planningTime": "785.67ms",
                "analysisTime": "192.29ms",
                "queuedTime": "155.23us",
                "executionTime": "4.53s",
                "totalCpuTime": "2.24s",
                "rawInputDataSize": "24.40MB",
                "internalNetworkInputDataSize": "2.03kB",
                "physicalInputDataSize": "24.40MB",
                "processedInputDataSize": "24.40MB",
                "rawInputPositions": "2707808",
                "internalNetworkInputPositions": "33",
                "physicalInputPositions": "2707808",
                "processedInputPositions": "2707808",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "1.58MB",
                "writtenPositions": "25116",
                "peakTotalMemoryReservation": "0B",
                "peakTaskTotalMemory": "0B",
                "totalSplits": 78,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "sunduk.baguild.slowly_src50_events_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "3.64s",
                    "totalQueuedTime": "1.20ms",
                    "totalScheduledTime": "864.84ms",
                    "totalCpuTime": "29.83ms",
                    "totalBlockedTime": "13.80s",
                    "rawInputDataSize": "2.03kB",
                    "internalNetworkInputDataSize": "2.03kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "462B",
                    "rawInputPositions": "33",
                    "internalNetworkInputPositions": "33",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "33",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "347.00ms",
                    "totalQueuedTime": "8.99s",
                    "totalScheduledTime": "15.44s",
                    "totalCpuTime": "2.21s",
                    "totalBlockedTime": "8.80s",
                    "rawInputDataSize": "24.40MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "24.40MB",
                    "processedInputDataSize": "24.40MB",
                    "rawInputPositions": "2707808",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2707808",
                    "processedInputPositions": "2707808",
                    "outputDataSize": "462B",
                    "outputPositions": "33",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 73,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.0/5    elapsed: 00:00:14.721,  cpu: 00:00:00.029,  blocked: 00:00:13.800,  queue: 00:00:00.001,  scheduled: 00:00:00.864 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.861,  finishWall: 00:00:00.000)  other: 00:00:00.055,  timeCost: 5.3%,  blocked: 93.7%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  100.2/73   elapsed: 00:00:34.756,  cpu: 00:00:02.210,  blocked: 00:00:08.800,  queue: 00:00:08.985,  scheduled: 00:00:15.440 (addInputWall: 00:00:03.954,  getOutputWall: 00:00:09.232,  finishWall: 00:00:06.170)  other: 00:00:01.530,  timeCost: 94.7%,  blocked: 25.3%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=5.9"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 93.5 of data dropped"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "1"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=4.4"
                },
                {
                    "source": {
                        "stageId": "1",
                        "taskId": "24"
                    },
                    "level": "INFO",
                    "message": "Long tail task detected: Max/P90=2.9"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[prod:connectorId=prod; schemaName=verticals; tableName=slowly_delete_site_delta; tablePath=s3a://wix-bi-data-warehouse/dynamic/e7fe6106-26b0-47bf-9f27-41d869c30bac; columnHandles=[[msid, varchar, 1], [date_created, timestamp, 2], [action_type, varchar(11), 3]], hash=1485569204]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"248\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"208\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"msid := msid\\ndate_created := date_created\\naction_type := expr\\n\",\n  \"children\" : [ {\n    \"id\" : \"247\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"2\",\n      \"name\" : \"ScanFilterProject\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_src50_events_delta', folderName='c4b34e59-7080-45d8-a8bf-b9c1849256b7', columns='[[app_id,varchar,false], [date_created,timestamp,false], [evid,bigint,false], [initiator_name,varchar,false], [instance_id,varchar,false], [metasitename,varchar,false], [msid,varchar,false], [src,bigint,false], [targetmetasiteid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"evid\\\" = BIGINT '29')]\",\n      \"details\" : \"expr := 'delete_site'\\nmsid := [msid, varchar, 6]\\nevid := [evid, bigint, 2]\\n    :: [[29]]\\ndate_created := [date_created, timestamp, 1]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_012625_07182_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_distinct_msids_merge -- 57311193\nAS\n\n    SELECT msid AS msid_list, min(msid_min_date) AS msid_min_date\n    FROM    (\n            SELECT msid, min(date_created) as msid_min_date FROM prod.verticals.slowly_transfer_site_new_delta  GROUP by 1\n            UNION ALL\n            SELECT msid, min(date_created) as msid_min_date FROM sunduk.baguild.slowly_original_events_delta    GROUP by 1\n            UNION ALL\n            SELECT msid_list AS msid, msid_min_date         FROM sunduk.baguild.slowly_distinct_msids\n            )\n    GROUP by 1",
            "queryName": "create sunduk.baguild.slowly_distinct_msids_merge",
            "queryStats": {
                "elapsedTime": "55.46s",
                "planningTime": "1.22s",
                "analysisTime": "437.85ms",
                "queuedTime": "11.02ms",
                "executionTime": "55.02s",
                "totalCpuTime": "4.74m",
                "rawInputDataSize": "3.04GB",
                "internalNetworkInputDataSize": "6.67GB",
                "physicalInputDataSize": "3.04GB",
                "processedInputDataSize": "3.04GB",
                "rawInputPositions": "128800113",
                "internalNetworkInputPositions": "127869277",
                "physicalInputPositions": "128800113",
                "processedInputPositions": "128800113",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "5.88GB",
                "writtenPositions": "126374632",
                "peakTotalMemoryReservation": "12.93GB",
                "peakTaskTotalMemory": "852.33MB",
                "totalSplits": 469,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "prod.verticals.slowly_transfer_site_new_delta",
                    "sunduk.baguild.slowly_distinct_msids",
                    "sunduk.baguild.slowly_original_events_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "53.78s",
                    "totalQueuedTime": "1.62ms",
                    "totalScheduledTime": "1.25s",
                    "totalCpuTime": "22.22ms",
                    "totalBlockedTime": "4.38m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "36.73s",
                    "totalQueuedTime": "1.58m",
                    "totalScheduledTime": "2.75m",
                    "totalCpuTime": "2.17m",
                    "totalBlockedTime": "43.56m",
                    "rawInputDataSize": "6.67GB",
                    "internalNetworkInputDataSize": "6.67GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "7.03GB",
                    "rawInputPositions": "127869261",
                    "internalNetworkInputPositions": "127869261",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "127869261",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 400,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "1.49s",
                    "totalQueuedTime": "1.60s",
                    "totalScheduledTime": "1.11s",
                    "totalCpuTime": "179.51ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "32.90kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "32.90kB",
                    "processedInputDataSize": "32.90kB",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1835",
                    "processedInputPositions": "1835",
                    "outputDataSize": "105.54kB",
                    "outputPositions": "1832",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "1.49s",
                    "totalQueuedTime": "4.27s",
                    "totalScheduledTime": "5.51s",
                    "totalCpuTime": "3.50s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "31.68MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "31.68MB",
                    "processedInputDataSize": "31.68MB",
                    "rawInputPositions": "2593187",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2593187",
                    "processedInputPositions": "2593187",
                    "outputDataSize": "93.52MB",
                    "outputPositions": "1662338",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "3.26s",
                    "totalQueuedTime": "6.87s",
                    "totalScheduledTime": "3.07m",
                    "totalCpuTime": "2.50m",
                    "totalBlockedTime": "5.57s",
                    "rawInputDataSize": "3.01GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "3.01GB",
                    "processedInputDataSize": "3.01GB",
                    "rawInputPositions": "126205091",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "126205091",
                    "processedInputPositions": "126205091",
                    "outputDataSize": "6.93GB",
                    "outputPositions": "126205091",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 32,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.9/5    elapsed: 00:04:23.921,  cpu: 00:00:00.022,  blocked: 00:04:22.800,  queue: 00:00:00.001,  scheduled: 00:00:01.250 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.250,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.4%,  blocked: 99.6%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   95.1/400  elapsed: 00:58:13.295,  cpu: 00:02:10.200,  blocked: 00:43:33.600,  queue: 00:01:34.651,  scheduled: 00:02:45.000 (addInputWall: 00:01:53.853,  getOutputWall: 00:00:16.132,  finishWall: 00:00:34.527)  other: 00:10:20.043,  timeCost: 46.2%,  blocked: 74.8%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.5"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "2"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.5"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2    1.8/16   elapsed: 00:00:02.712,  cpu: 00:00:00.179,  blocked: 00:00:00.000,  queue: 00:00:01.600,  scheduled: 00:00:01.110 (addInputWall: 00:00:00.169,  getOutputWall: 00:00:01.100,  finishWall: 00:00:00.006)  other: 00:00:00.001,  timeCost: 0.3%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.5"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3    6.6/16   elapsed: 00:00:09.777,  cpu: 00:00:03.500,  blocked: 00:00:00.000,  queue: 00:00:04.266,  scheduled: 00:00:05.510 (addInputWall: 00:00:01.511,  getOutputWall: 00:00:04.672,  finishWall: 00:00:00.081)  other: 00:00:00.000,  timeCost: 1.5%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.3"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4   72.3/32   elapsed: 00:03:55.324,  cpu: 00:02:30.000,  blocked: 00:00:05.570,  queue: 00:00:06.868,  scheduled: 00:03:04.200 (addInputWall: 00:01:34.960,  getOutputWall: 00:02:11.070,  finishWall: 00:00:00.018)  other: 00:00:38.685,  timeCost: 51.6%,  blocked: 2.4%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.4"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "WARN",
                    "message": "High avg CPU usage 63.74%, the most consuming operator ScanFilterAndProjectOperator (35.44%)"
                },
                {
                    "source": {
                        "stageId": "4",
                        "taskId": "23"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(380.13MB)/P50(63.06MB) = 6.0 times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"28\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"26\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_distinct_msids_merge; tablePath=s3a://wix-bi-sunduk/baguild/e7cb2074-7818-429a-9e2e-a1a7ef375ef1; columnHandles=[[msid_list, varchar, 1], [msid_min_date, timestamp, 2]], hash=1596050931]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"538\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"455\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"27\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"msid_list := msid_23\\nmsid_min_date := min_31\\n\",\n  \"children\" : [ {\n    \"id\" : \"537\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"699\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"21\",\n        \"name\" : \"Aggregate(FINAL)[msid_23][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min_31 := min(\\\"min_40\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"565\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"msid_23\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"560\",\n            \"name\" : \"Project\",\n            \"identifier\" : \"[]\",\n            \"details\" : \"msid_23 := \\\"msid\\\"\\n\",\n            \"children\" : [ {\n              \"id\" : \"559\",\n              \"name\" : \"Aggregate(PARTIAL)[msid][$hashvalue_43]\",\n              \"identifier\" : \"\",\n              \"details\" : \"min_40 := min(\\\"min\\\")\\n\",\n              \"children\" : [ {\n                \"id\" : \"3\",\n                \"name\" : \"Aggregate(FINAL)[msid][$hashvalue_43]\",\n                \"identifier\" : \"\",\n                \"details\" : \"min := min(\\\"min_41\\\")\\n\",\n                \"children\" : [ {\n                  \"id\" : \"580\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_43] (\\\"msid\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"586\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[2]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"2\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          }, {\n            \"id\" : \"562\",\n            \"name\" : \"Project\",\n            \"identifier\" : \"[]\",\n            \"details\" : \"msid_23 := \\\"msid_7\\\"\\n\",\n            \"children\" : [ {\n              \"id\" : \"561\",\n              \"name\" : \"Aggregate(PARTIAL)[msid_7][$hashvalue_46]\",\n              \"identifier\" : \"\",\n              \"details\" : \"min_40 := min(\\\"min_12\\\")\\n\",\n              \"children\" : [ {\n                \"id\" : \"9\",\n                \"name\" : \"Aggregate(FINAL)[msid_7][$hashvalue_46]\",\n                \"identifier\" : \"\",\n                \"details\" : \"min_12 := min(\\\"min_42\\\")\\n\",\n                \"children\" : [ {\n                  \"id\" : \"595\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_46] (\\\"msid_7\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"601\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          }, {\n            \"id\" : \"564\",\n            \"name\" : \"Project\",\n            \"identifier\" : \"[]\",\n            \"details\" : \"msid_23 := \\\"msid_list\\\"\\n\",\n            \"children\" : [ {\n              \"id\" : \"607\",\n              \"name\" : \"RemoteSource\",\n              \"identifier\" : \"[4]\",\n              \"details\" : \"\",\n              \"children\" : [ ],\n              \"remoteSources\" : [ \"4\" ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"584\",\n  \"name\" : \"Aggregate(PARTIAL)[msid][$hashvalue_45]\",\n  \"identifier\" : \"\",\n  \"details\" : \"min_41 := min(\\\"date_created\\\")\\n\",\n  \"children\" : [ {\n    \"id\" : \"696\",\n    \"name\" : \"ScanProject\",\n    \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_transfer_site_new_delta', folderName='5f32479c-ba39-454f-852b-f2c35732f970', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}]\",\n    \"details\" : \"$hashvalue_45 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nmsid := [msid, varchar, 4]\\ndate_created := [date_created, timestamp, 0]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"599\",\n  \"name\" : \"Aggregate(PARTIAL)[msid_7][$hashvalue_48]\",\n  \"identifier\" : \"\",\n  \"details\" : \"min_42 := min(\\\"date_created_6\\\")\\n\",\n  \"children\" : [ {\n    \"id\" : \"697\",\n    \"name\" : \"ScanProject\",\n    \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_original_events_delta', folderName='e2e4e481-fcce-469d-8b88-23540a06bdb9', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [initiator_name,varchar,false], [instance_id,varchar,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n    \"details\" : \"$hashvalue_48 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_7\\\"), 0))\\ndate_created_6 := [date_created, timestamp, 2]\\nmsid_7 := [msid, varchar, 5]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"605\",\n  \"name\" : \"Aggregate(PARTIAL)[msid_list][$hashvalue_50]\",\n  \"identifier\" : \"\",\n  \"details\" : \"min_40 := min(\\\"msid_min_date\\\")\\n\",\n  \"children\" : [ {\n    \"id\" : \"698\",\n    \"name\" : \"ScanProject\",\n    \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_distinct_msids', folderName='f5e1fbe1-12b7-46a8-bb53-cb90beee1d06', columns='[[msid_list,varchar,false], [msid_min_date,timestamp,false]]'}]\",\n    \"details\" : \"$hashvalue_50 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_list\\\"), 0))\\nmsid_list := [msid_list, varchar, 0]\\nmsid_min_date := [msid_min_date, timestamp, 1]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_012722_07279_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.pavelk_slowly_direct_actions_delta --1231990\nAS\n\n    SELECT  uuid\n        , msid\n        , app_id\n        , instance_id\n        , date_created\n        , was_demo\n        , initiator_name\n        , action_type -- {'add_app', 'remove_app'}\n        , case  when action_type='remove_app' then 'close' else 'open' end AS event_type    \n    FROM sunduk.baguild.slowly_original_events_delta\n    WHERE   action_type='remove_app' -- revokes\n            OR\n            coalesce(initiator_name, '-') not in ('DUPLICATE', 'TRANSFER') -- direct provisions",
            "queryName": "create sunduk.baguild.pavelk_slowly_direct_actions_delta",
            "queryStats": {
                "elapsedTime": "27.05s",
                "planningTime": "308.15ms",
                "analysisTime": "177.51ms",
                "queuedTime": "1.09ms",
                "executionTime": "26.87s",
                "totalCpuTime": "14.07s",
                "rawInputDataSize": "1.35GB",
                "internalNetworkInputDataSize": "1008B",
                "physicalInputDataSize": "1.35GB",
                "processedInputDataSize": "1.35GB",
                "rawInputPositions": "2593187",
                "internalNetworkInputPositions": "16",
                "physicalInputPositions": "2593187",
                "processedInputPositions": "2593187",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "487.35MB",
                "writtenPositions": "2438164",
                "peakTotalMemoryReservation": "2.29kB",
                "peakTaskTotalMemory": "2.29kB",
                "totalSplits": 37,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "sunduk.baguild.slowly_original_events_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "26.56s",
                    "totalQueuedTime": "1.10ms",
                    "totalScheduledTime": "690.30ms",
                    "totalCpuTime": "23.84ms",
                    "totalBlockedTime": "2.16m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "25.82s",
                    "totalQueuedTime": "1.12m",
                    "totalScheduledTime": "26.14s",
                    "totalCpuTime": "14.05s",
                    "totalBlockedTime": "18.26s",
                    "rawInputDataSize": "1.35GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "1.35GB",
                    "processedInputDataSize": "1.35GB",
                    "rawInputPositions": "2593187",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2593187",
                    "processedInputPositions": "2593187",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 32,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.9/5    elapsed: 00:02:10.027,  cpu: 00:00:00.023,  blocked: 00:02:09.600,  queue: 00:00:00.001,  scheduled: 00:00:00.690 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.688,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 2.6%,  blocked: 99.7%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1    5.1/32   elapsed: 00:02:10.581,  cpu: 00:00:14.050,  blocked: 00:00:18.260,  queue: 00:01:07.301,  scheduled: 00:00:26.140 (addInputWall: 00:00:33.875,  getOutputWall: 00:00:10.887,  finishWall: 00:00:09.040)  other: 00:00:18.880,  timeCost: 97.4%,  blocked: 14.0%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=7.0"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "1"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=5.7"
                },
                {
                    "source": {
                        "stageId": "1",
                        "taskId": "15"
                    },
                    "level": "INFO",
                    "message": "Long tail task detected: Max/P90=2.6"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=pavelk_slowly_direct_actions_delta; tablePath=s3a://wix-bi-sunduk/baguild/733c010b-a105-4c7c-8c3f-737b68ac7c91; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [date_created, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(16), 8], [event_type, varchar(5), 9]], hash=-1909004806]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"242\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"202\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid\\nmsid := msid\\napp_id := app_id\\ninstance_id := instance_id\\ndate_created := date_created\\nwas_demo := was_demo\\ninitiator_name := initiator_name\\naction_type := action_type\\nevent_type := expr\\n\",\n  \"children\" : [ {\n    \"id\" : \"241\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"2\",\n      \"name\" : \"ScanFilterProject\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_original_events_delta', folderName='e2e4e481-fcce-469d-8b88-23540a06bdb9', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [initiator_name,varchar,false], [instance_id,varchar,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((\\\"action_type\\\" = CAST('remove_app' AS varchar(16))) OR (NOT (COALESCE(\\\"initiator_name\\\", CAST('-' AS varchar)) IN (CAST('DUPLICATE' AS varchar), CAST('TRANSFER' AS varchar)))))]\",\n      \"details\" : \"expr := (CASE WHEN (\\\"action_type\\\" = CAST('remove_app' AS varchar(16))) THEN 'close' ELSE CAST('open' AS varchar(5)) END)\\nmsid := [msid, varchar, 5]\\ninstance_id := [instance_id, varchar, 4]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 7]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 3]\\nuuid := [uuid, varchar, 6]\\napp_id := [app_id, varchar, 1]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_012749_07300_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  prod.verticals.slowly_new_transfer_copy_left_and_duplicate_delta -- 1231990\nAS\n\nWITH rawdata AS (\n    SELECT  a.uuid, a.msid, a.app_id, a.instance_id, a.date_created, a.was_demo, a.initiator_name, a.action_type, 'open' AS event_type\n            , abs(date_diff('millisecond', a.date_created, b.date_created)) as date_created_diff\n            , b.origin_uuid, b.date_created as transfer_date\n            , row_number() over (partition by a.uuid, a.msid, a.app_id, a.instance_id, a.date_created order by abs(date_diff('millisecond', a.date_created, b.date_created))) as nearest_transfer_event\n    FROM        sunduk.baguild.slowly_original_events_delta     a\n    LEFT JOIN   prod.verticals.slowly_transfer_site_new_delta   b ON a.uuid=b.uuid AND b.date_created >= date(timestamp '2020-07-02 01:00:56')\n    WHERE action_type='add_app' AND initiator_name='DUPLICATE'\n    )\n\n    SELECT  origin_uuid AS  uuid\n            , msid\n            , app_id\n            , instance_id\n            , transfer_date AS date_created\n            , was_demo\n            , initiator_name\n            , 'transfer_copy' AS  action_type\n            , 'open' AS event_type\n    FROM rawdata\n    WHERE nearest_transfer_event=1 AND date_created_diff < 5000 \n        UNION ALL\n    SELECT  uuid\n            , msid\n            , app_id\n            , instance_id\n            , date_created\n            , was_demo\n            , initiator_name\n            , 'duplicate' AS action_type\n            , 'open' AS  event_type\n    FROM rawdata\n    WHERE coalesce(nearest_transfer_event, 1)=1 AND coalesce(date_created_diff,5000) >= 5000",
            "queryName": "create prod.verticals.slowly_new_transfer_copy_left_and_duplicate_delta",
            "queryStats": {
                "elapsedTime": "2.49m",
                "planningTime": "961.77ms",
                "analysisTime": "261.92ms",
                "queuedTime": "126.43us",
                "executionTime": "2.49m",
                "totalCpuTime": "13.10s",
                "rawInputDataSize": "491.79MB",
                "internalNetworkInputDataSize": "56.60MB",
                "physicalInputDataSize": "491.79MB",
                "processedInputDataSize": "491.79MB",
                "rawInputPositions": "5190044",
                "internalNetworkInputPositions": "313732",
                "physicalInputPositions": "5190044",
                "processedInputPositions": "5190044",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "28.94MB",
                "writtenPositions": "155023",
                "peakTotalMemoryReservation": "70.52MB",
                "peakTaskTotalMemory": "5.05MB",
                "totalSplits": 661,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "prod.verticals.slowly_transfer_site_new_delta",
                    "sunduk.baguild.slowly_original_events_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.47m",
                    "totalQueuedTime": "1.44ms",
                    "totalScheduledTime": "678.22ms",
                    "totalCpuTime": "20.86ms",
                    "totalBlockedTime": "12.31m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "2.41m",
                    "totalQueuedTime": "4.35m",
                    "totalScheduledTime": "6.94s",
                    "totalCpuTime": "3.22s",
                    "totalBlockedTime": "12.72h",
                    "rawInputDataSize": "56.60MB",
                    "internalNetworkInputDataSize": "56.60MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "58.83MB",
                    "rawInputPositions": "313716",
                    "internalNetworkInputPositions": "313716",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "313716",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 592,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "5.33s",
                    "totalQueuedTime": "6.81s",
                    "totalScheduledTime": "6.99s",
                    "totalCpuTime": "4.75s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "230.59MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "230.59MB",
                    "processedInputDataSize": "230.59MB",
                    "rawInputPositions": "2593187",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2593187",
                    "processedInputPositions": "2593187",
                    "outputDataSize": "29.28MB",
                    "outputPositions": "155023",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "5.33s",
                    "totalQueuedTime": "50.61s",
                    "totalScheduledTime": "1.23s",
                    "totalCpuTime": "216.09ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "37.82MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "37.82MB",
                    "processedInputDataSize": "37.82MB",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1835",
                    "processedInputPositions": "1835",
                    "outputDataSize": "179.20kB",
                    "outputPositions": "1835",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "5.33s",
                    "totalQueuedTime": "13.94s",
                    "totalScheduledTime": "7.06s",
                    "totalCpuTime": "4.69s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "223.34MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "223.34MB",
                    "processedInputDataSize": "223.34MB",
                    "rawInputPositions": "2593187",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2593187",
                    "processedInputPositions": "2593187",
                    "outputDataSize": "29.28MB",
                    "outputPositions": "155023",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "5": {
                    "stageDuration": "5.33s",
                    "totalQueuedTime": "1.08m",
                    "totalScheduledTime": "1.43s",
                    "totalCpuTime": "208.20ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "39.90kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "39.90kB",
                    "processedInputDataSize": "39.90kB",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1835",
                    "processedInputPositions": "1835",
                    "outputDataSize": "105.71kB",
                    "outputPositions": "1835",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.slowly_original_events_delta scanned 2 times"
                },
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: prod.verticals.slowly_transfer_site_new_delta scanned 2 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:12:18.995,  cpu: 00:00:00.020,  blocked: 00:12:18.600,  queue: 00:00:00.001,  scheduled: 00:00:00.678 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.676,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 2.8%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  370.0/592  elapsed: 14:51:20.726,  cpu: 00:00:03.220,  blocked: 12:43:12.000,  queue: 00:04:20.988,  scheduled: 00:00:06.940 (addInputWall: 00:00:00.610,  getOutputWall: 00:00:02.484,  finishWall: 00:00:03.825)  other: 02:03:40.797,  timeCost: 28.5%,  blocked: 85.6%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2    2.6/16   elapsed: 00:00:13.797,  cpu: 00:00:04.750,  blocked: 00:00:00.000,  queue: 00:00:06.809,  scheduled: 00:00:06.990 (addInputWall: 00:00:05.486,  getOutputWall: 00:00:06.850,  finishWall: 00:00:00.035)  other: 00:00:00.000,  timeCost: 28.7%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=4.0"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 87.3 of data dropped"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "5"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(69.76MB)/P50(11.01MB) = 6.3 times"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3    9.7/16   elapsed: 00:00:51.842,  cpu: 00:00:00.216,  blocked: 00:00:00.000,  queue: 00:00:50.610,  scheduled: 00:00:01.230 (addInputWall: 00:00:00.380,  getOutputWall: 00:00:01.220,  finishWall: 00:00:00.007)  other: 00:00:00.001,  timeCost: 5.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=12.8"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 99.5 of data dropped"
                },
                {
                    "source": {
                        "stageId": "3",
                        "taskId": "7"
                    },
                    "level": "INFO",
                    "message": "Long tail task detected: Max/P90=7.8"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4    3.9/16   elapsed: 00:00:20.997,  cpu: 00:00:04.690,  blocked: 00:00:00.000,  queue: 00:00:13.939,  scheduled: 00:00:07.060 (addInputWall: 00:00:03.897,  getOutputWall: 00:00:06.910,  finishWall: 00:00:00.036)  other: 00:00:00.000,  timeCost: 29.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=4.1"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 86.9 of data dropped"
                },
                {
                    "source": {
                        "stageId": "5"
                    },
                    "level": "INFO",
                    "message": "stage.5   12.4/16   elapsed: 00:01:05.962,  cpu: 00:00:00.208,  blocked: 00:00:00.000,  queue: 00:01:04.530,  scheduled: 00:00:01.430 (addInputWall: 00:00:00.184,  getOutputWall: 00:00:01.420,  finishWall: 00:00:00.014)  other: 00:00:00.002,  timeCost: 5.9%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "5",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=10.0"
                },
                {
                    "source": {
                        "stageId": "5",
                        "taskId": "6"
                    },
                    "level": "INFO",
                    "message": "Long tail task detected: Max/P90=4.3"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"42\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"40\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[prod:connectorId=prod; schemaName=verticals; tableName=slowly_new_transfer_copy_left_and_duplicate_delta; tablePath=s3a://wix-bi-data-warehouse/dynamic/51421dcd-ef7f-4484-93e4-71e0f4e69890; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [date_created, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(13), 8], [event_type, varchar(4), 9]], hash=-1855143294]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1239\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"1048\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"41\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := origin_uuid_209\\nmsid := msid_210\\napp_id := app_id_211\\ninstance_id := instance_id_212\\ndate_created := transfer_date_213\\nwas_demo := was_demo_214\\ninitiator_name := initiator_name_215\\naction_type := expr_216\\nevent_type := expr_217\\n\",\n  \"children\" : [ {\n    \"id\" : \"1238\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1237\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[ROUND_ROBIN] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"16\",\n        \"name\" : \"Project\",\n        \"identifier\" : \"[]\",\n        \"details\" : \"expr_80 := 'transfer_copy'\\nexpr_81 := 'open'\\n\",\n        \"children\" : [ {\n          \"id\" : \"10\",\n          \"name\" : \"FilterProject\",\n          \"identifier\" : \"[filterPredicate = ((\\\"row_number\\\" = BIGINT '1') AND (\\\"abs\\\" < BIGINT '5000'))]\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"1381\",\n            \"name\" : \"Project\",\n            \"identifier\" : \"[]\",\n            \"details\" : \"\",\n            \"children\" : [ {\n              \"id\" : \"689\",\n              \"name\" : \"TopNRowNumber\",\n              \"identifier\" : \"[partition by (uuid, msid, app_id, instance_id, date_created), order by (abs ASC_NULLS_LAST) limit 1][$hashvalue]\",\n              \"details\" : \"row_number := row_number()\\n\",\n              \"children\" : [ {\n                \"id\" : \"1234\",\n                \"name\" : \"LocalExchange\",\n                \"identifier\" : \"[HASH][$hashvalue] (\\\"uuid\\\", \\\"msid\\\", \\\"app_id\\\", \\\"instance_id\\\", \\\"date_created\\\")\",\n                \"details\" : \"\",\n                \"children\" : [ {\n                  \"id\" : \"8\",\n                  \"name\" : \"Project\",\n                  \"identifier\" : \"[]\",\n                  \"details\" : \"abs := abs(date_diff('millisecond', \\\"date_created\\\", \\\"date_created_0\\\"))\\n$hashvalue_241 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created\\\"), 0))\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"6\",\n                    \"name\" : \"LeftJoin\",\n                    \"identifier\" : \"[(\\\"uuid\\\" = \\\"uuid_2\\\")][$hashvalue_236, $hashvalue_238]\",\n                    \"details\" : \"Distribution: PARTITIONED\\n\",\n                    \"children\" : [ {\n                      \"id\" : \"1042\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[2]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"2\" ]\n                    }, {\n                      \"id\" : \"1233\",\n                      \"name\" : \"LocalExchange\",\n                      \"identifier\" : \"[HASH][$hashvalue_238] (\\\"uuid_2\\\")\",\n                      \"details\" : \"\",\n                      \"children\" : [ {\n                        \"id\" : \"1043\",\n                        \"name\" : \"RemoteSource\",\n                        \"identifier\" : \"[3]\",\n                        \"details\" : \"\",\n                        \"children\" : [ ],\n                        \"remoteSources\" : [ \"3\" ]\n                      } ],\n                      \"remoteSources\" : [ ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      }, {\n        \"id\" : \"36\",\n        \"name\" : \"FilterProject\",\n        \"identifier\" : \"[filterPredicate = ((COALESCE(\\\"row_number_116\\\", BIGINT '1') = BIGINT '1') AND (COALESCE(\\\"abs_115\\\", BIGINT '5000') >= BIGINT '5000'))]\",\n        \"details\" : \"expr_207 := CAST('duplicate' AS varchar(13))\\nexpr_190 := 'open'\\n\",\n        \"children\" : [ {\n          \"id\" : \"1383\",\n          \"name\" : \"Project\",\n          \"identifier\" : \"[]\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"27\",\n            \"name\" : \"Window\",\n            \"identifier\" : \"[partition by (uuid_97, msid_96, app_id_92, instance_id_95, date_created_93), order by (abs_115 ASC_NULLS_LAST)][$hashvalue_242]\",\n            \"details\" : \"row_number_116 := row_number() RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\n\",\n            \"children\" : [ {\n              \"id\" : \"1236\",\n              \"name\" : \"LocalExchange\",\n              \"identifier\" : \"[HASH][$hashvalue_242] (\\\"uuid_97\\\", \\\"msid_96\\\", \\\"app_id_92\\\", \\\"instance_id_95\\\", \\\"date_created_93\\\")\",\n              \"details\" : \"\",\n              \"children\" : [ {\n                \"id\" : \"26\",\n                \"name\" : \"Project\",\n                \"identifier\" : \"[]\",\n                \"details\" : \"abs_115 := abs(date_diff('millisecond', \\\"date_created_93\\\", \\\"date_created_99\\\"))\\n$hashvalue_248 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid_97\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_96\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_92\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_95\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created_93\\\"), 0))\\n\",\n                \"children\" : [ {\n                  \"id\" : \"24\",\n                  \"name\" : \"LeftJoin\",\n                  \"identifier\" : \"[(\\\"uuid_97\\\" = \\\"uuid_107\\\")][$hashvalue_243, $hashvalue_245]\",\n                  \"details\" : \"Distribution: PARTITIONED\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"1046\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[4]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"4\" ]\n                  }, {\n                    \"id\" : \"1235\",\n                    \"name\" : \"LocalExchange\",\n                    \"identifier\" : \"[HASH][$hashvalue_245] (\\\"uuid_107\\\")\",\n                    \"details\" : \"\",\n                    \"children\" : [ {\n                      \"id\" : \"1047\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[5]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"5\" ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"490\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_original_events_delta', folderName='e2e4e481-fcce-469d-8b88-23540a06bdb9', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [initiator_name,varchar,false], [instance_id,varchar,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((\\\"action_type\\\" = CAST('add_app' AS varchar(16))) AND (\\\"initiator_name\\\" = CAST('DUPLICATE' AS varchar)))]\",\n  \"details\" : \"$hashvalue_237 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0))\\nmsid := [msid, varchar, 5]\\ninstance_id := [instance_id, varchar, 4]\\naction_type := [action_type, varchar(16), 0]\\n    :: [[add_app]]\\nwas_demo := [was_demo, boolean, 7]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 3]\\n    :: [[DUPLICATE]]\\nuuid := [uuid, varchar, 6]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"1380\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_transfer_site_new_delta', folderName='5f32479c-ba39-454f-852b-f2c35732f970', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}, filterPredicate = (\\\"date_created_0\\\" >= \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593648000000))]\",\n  \"details\" : \"$hashvalue_240 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid_2\\\"), 0))\\ndate_created_0 := [date_created, timestamp, 0]\\n    :: [[2020-07-02 00:00:00.000, <max>)]\\nuuid_2 := [uuid, varchar, 8]\\norigin_uuid := [origin_uuid, varchar, 6]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"496\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_original_events_delta', folderName='e2e4e481-fcce-469d-8b88-23540a06bdb9', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [initiator_name,varchar,false], [instance_id,varchar,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((\\\"action_type_91\\\" = CAST('add_app' AS varchar(16))) AND (\\\"initiator_name_94\\\" = CAST('DUPLICATE' AS varchar)))]\",\n  \"details\" : \"$hashvalue_244 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid_97\\\"), 0))\\nmsid_96 := [msid, varchar, 5]\\napp_id_92 := [app_id, varchar, 1]\\naction_type_91 := [action_type, varchar(16), 0]\\n    :: [[add_app]]\\nuuid_97 := [uuid, varchar, 6]\\ndate_created_93 := [date_created, timestamp, 2]\\ninitiator_name_94 := [initiator_name, varchar, 3]\\n    :: [[DUPLICATE]]\\nwas_demo_98 := [was_demo, boolean, 7]\\ninstance_id_95 := [instance_id, varchar, 4]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "5",
                                "plan": "{\n  \"id\" : \"1382\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_transfer_site_new_delta', folderName='5f32479c-ba39-454f-852b-f2c35732f970', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}, filterPredicate = (\\\"date_created_99\\\" >= \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593648000000))]\",\n  \"details\" : \"$hashvalue_247 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid_107\\\"), 0))\\nuuid_107 := [uuid, varchar, 8]\\ndate_created_99 := [date_created, timestamp, 0]\\n    :: [[2020-07-02 00:00:00.000, <max>)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_013019_07381_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.pavelk_slowly_direct_actions_temp_delta -- 194140162\nAS\n    SELECT uuid,msid,app_id,instance_id,date_created AS open_date,was_demo,initiator_name,action_type,event_type, FALSE as is_published\n    FROM sunduk.baguild.pavelk_slowly_direct_actions_delta\n        UNION ALL\n    SELECT uuid,msid,app_id,instance_id,date_created AS open_date,was_demo,initiator_name,action_type,event_type, FALSE as is_published\n    FROM prod.verticals.slowly_new_transfer_copy_left_and_duplicate_delta\n        UNION ALL\n    SELECT uuid,msid,app_id,instance_id,open_date,was_demo,initiator_name, open_reason AS action_type, 'open' AS event_type, is_published\n    FROM sunduk.baguild.apps_log\n    WHERE close_date > date '2050-01-01'",
            "queryName": "create sunduk.baguild.pavelk_slowly_direct_actions_temp_delta",
            "queryStats": {
                "elapsedTime": "14.87m",
                "planningTime": "1.35s",
                "analysisTime": "427.90ms",
                "queuedTime": "4.08ms",
                "executionTime": "14.87m",
                "totalCpuTime": "1.72h",
                "rawInputDataSize": "127.19GB",
                "internalNetworkInputDataSize": "179.67GB",
                "physicalInputDataSize": "127.19GB",
                "processedInputDataSize": "127.19GB",
                "rawInputPositions": "1922884888",
                "internalNetworkInputPositions": "955525342",
                "physicalInputPositions": "1922884888",
                "processedInputPositions": "1922884888",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "188.36GB",
                "writtenPositions": "955525326",
                "peakTotalMemoryReservation": "2.24GB",
                "peakTaskTotalMemory": "294.26MB",
                "totalSplits": 1011,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "prod.verticals.slowly_new_transfer_copy_left_and_duplicate_delta",
                    "sunduk.baguild.apps_log",
                    "sunduk.baguild.pavelk_slowly_direct_actions_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "14.84m",
                    "totalQueuedTime": "1.19ms",
                    "totalScheduledTime": "944.46ms",
                    "totalCpuTime": "61.11ms",
                    "totalBlockedTime": "1.24h",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "14.01m",
                    "totalQueuedTime": "7.62m",
                    "totalScheduledTime": "45.69m",
                    "totalCpuTime": "34.46m",
                    "totalBlockedTime": "6.83h",
                    "rawInputDataSize": "179.67GB",
                    "internalNetworkInputDataSize": "179.67GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "188.36GB",
                    "rawInputPositions": "955525326",
                    "internalNetworkInputPositions": "955525326",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "955525326",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 80,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "30.11s",
                    "totalQueuedTime": "1.23m",
                    "totalScheduledTime": "10.14s",
                    "totalCpuTime": "6.89s",
                    "totalBlockedTime": "765.67ms",
                    "rawInputDataSize": "133.49MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "133.49MB",
                    "processedInputDataSize": "133.49MB",
                    "rawInputPositions": "2438164",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2438164",
                    "processedInputPositions": "2438164",
                    "outputDataSize": "492.01MB",
                    "outputPositions": "2438164",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "20.79s",
                    "totalQueuedTime": "1.88m",
                    "totalScheduledTime": "2.26s",
                    "totalCpuTime": "759.36ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "29.82MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "29.82MB",
                    "processedInputDataSize": "29.82MB",
                    "rawInputPositions": "155023",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "155023",
                    "processedInputPositions": "155023",
                    "outputDataSize": "31.68MB",
                    "outputPositions": "155023",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "11.97m",
                    "totalQueuedTime": "1.62d",
                    "totalScheduledTime": "1.58h",
                    "totalCpuTime": "1.14h",
                    "totalBlockedTime": "4.47h",
                    "rawInputDataSize": "127.03GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "127.03GB",
                    "processedInputDataSize": "127.03GB",
                    "rawInputPositions": "1920291701",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1920291701",
                    "processedInputPositions": "1920291701",
                    "outputDataSize": "187.89GB",
                    "outputPositions": "952932139",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 894,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 01:14:09.111,  cpu: 00:00:00.061,  blocked: 01:14:24.000,  queue: 00:00:00.001,  scheduled: 00:00:00.944 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.942,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 100.3%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   76.5/80   elapsed: 17:51:00.964,  cpu: 00:34:27.600,  blocked: 06:49:48.000,  queue: 00:07:37.352,  scheduled: 00:45:41.400 (addInputWall: 00:34:31.801,  getOutputWall: 00:00:34.490,  finishWall: 00:10:31.200)  other: 10:07:54.212,  timeCost: 32.5%,  blocked: 38.3%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2    3.0/16   elapsed: 00:01:29.183,  cpu: 00:00:06.890,  blocked: 00:00:00.765,  queue: 00:01:13.788,  scheduled: 00:00:10.140 (addInputWall: 00:00:02.462,  getOutputWall: 00:00:09.580,  finishWall: 00:00:00.000)  other: 00:00:04.489,  timeCost: 0.1%,  blocked: 0.9%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=4.0"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "11"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(74.54MB)/P50(0B) = Infinity times"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3    5.5/16   elapsed: 00:01:55.167,  cpu: 00:00:00.759,  blocked: 00:00:00.000,  queue: 00:01:52.903,  scheduled: 00:00:02.260 (addInputWall: 00:00:01.097,  getOutputWall: 00:00:02.240,  finishWall: 00:00:00.000)  other: 00:00:00.004,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.7"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4  302.6/894  elapsed: 60:20:32.684,  cpu: 01:08:23.999,  blocked: 04:28:12.000,  queue: 38:52:04.899,  scheduled: 01:34:48.000 (addInputWall: 00:41:58.800,  getOutputWall: 01:31:48.000,  finishWall: 00:00:00.001)  other: 15:25:27.785,  timeCost: 67.4%,  blocked: 7.4%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"18\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"16\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=pavelk_slowly_direct_actions_temp_delta; tablePath=s3a://wix-bi-sunduk/baguild/4d73643a-cf2f-41a0-86c9-f04bd2c030c0; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [open_date, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(16), 8], [event_type, varchar(5), 9], [is_published, boolean, 10]], hash=-1078129355]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"496\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"426\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"17\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid_104\\nmsid := msid_105\\napp_id := app_id_106\\ninstance_id := instance_id_107\\nopen_date := date_created_108\\nwas_demo := was_demo_109\\ninitiator_name := initiator_name_110\\naction_type := action_type_111\\nevent_type := event_type_112\\nis_published := expr_113\\n\",\n  \"children\" : [ {\n    \"id\" : \"495\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"425\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[2,3,4]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"2\", \"3\", \"4\" ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"1\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_slowly_direct_actions_delta', folderName='733c010b-a105-4c7c-8c3f-737b68ac7c91', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"expr := false\\nmsid := [msid, varchar, 6]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 8]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 7]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"6\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_new_transfer_copy_left_and_duplicate_delta', folderName='51421dcd-ef7f-4484-93e4-71e0f4e69890', columns='[[action_type,varchar(13),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(4),false], [initiator_name,varchar,false], [instance_id,varchar,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"expr_55 := CAST(\\\"action_type_19\\\" AS varchar(16))\\nexpr_56 := CAST(\\\"event_type_22\\\" AS varchar(5))\\nexpr_37 := false\\ndate_created_21 := [date_created, timestamp, 2]\\naction_type_19 := [action_type, varchar(13), 0]\\nevent_type_22 := [event_type, varchar(4), 3]\\ninstance_id_24 := [instance_id, varchar, 5]\\nwas_demo_27 := [was_demo, boolean, 8]\\nmsid_25 := [msid, varchar, 6]\\napp_id_20 := [app_id, varchar, 1]\\ninitiator_name_23 := [initiator_name, varchar, 4]\\nuuid_26 := [uuid, varchar, 7]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"12\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='apps_log', folderName='fb1d2dde-331f-4fe6-ad86-94479752e9c6', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"close_date\\\" > \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(2524608000000))]\",\n  \"details\" : \"expr_102 := CAST('open' AS varchar(5))\\nopen_date := [open_date, timestamp, 7]\\nclose_date := [close_date, timestamp, 1]\\n    :: [(2050-01-01 00:00:00.000, <max>)]\\nmsid_71 := [msid, varchar, 6]\\nis_published := [is_published, boolean, 5]\\napp_id_68 := [app_id, varchar, 0]\\nopen_reason := [open_reason, varchar(16), 8]\\nuuid_72 := [uuid, varchar, 9]\\ninstance_id_70 := [instance_id, varchar, 4]\\nwas_demo_73 := [was_demo, boolean, 10]\\ninitiator_name_69 := [initiator_name, varchar, 3]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_014512_08213_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  prod.verticals.slowly_new_transfer_synt_events_delta -- 20516\nAS\n\nWITH a AS (\n    SELECT  b.uuid\n            , c.msid\n            , c.uuid AS new_uuid\n            , b.app_id\n            , b.instance_id\n            , b.open_date AS date_created\n            , c.date_created as transfer_date_created\n            , b.event_type\n            , c.last_publish_date\n            , row_number () over (partition by c.uuid, c.msid, b.app_id, c.date_created order by b.open_date desc, b.event_type desc) as rownum\n    FROM        sunduk.baguild.pavelk_slowly_direct_actions_temp_delta  b\n    RIGHT JOIN  prod.verticals.slowly_transfer_site_new_delta           c ON b.msid=c.msid\n    WHERE c.date_created > date_add('second', 5, b.open_date)\n            AND c.date_created >= date (timestamp '2020-07-02 01:00:56') and c.date_created < date (timestamp '2020-07-03 00:56:28')\n    )\n\n    SELECT   new_uuid                   AS  uuid\n            ,                               msid\n            ,                               app_id\n            ,                               instance_id\n            , transfer_date_created     AS  date_created\n            , FALSE                     AS  was_demo\n            , ''                        AS  initiator_name\n            , 'transfer'                AS  action_type\n            , 'open'                    AS  event_type\n            , case when last_publish_date between date_created AND transfer_date_created then TRUE else FALSE end as is_published\n    FROM a\n    WHERE   rownum = 1 AND event_type = 'open' -- to make sure the last event for that msid and app_id was open and not close\n    \n    UNION ALL\n    \n    SELECT   uuid                       AS  uuid\n            ,                               msid\n            ,                               app_id\n            ,                               instance_id\n            , transfer_date_created     AS  date_created\n            , FALSE                     AS  was_demo\n            , ''                        AS  initiator_name\n            , 'transfer'                AS  action_type\n            , 'close'                   AS  event_type\n            , case when last_publish_date between date_created AND transfer_date_created then TRUE else FALSE end as is_published\n    FROM a\n    WHERE   rownum = 1 AND event_type = 'open' -- to make sure the last event for that msid and app_id was open and not close",
            "queryName": "create prod.verticals.slowly_new_transfer_synt_events_delta",
            "queryStats": {
                "elapsedTime": "2.30m",
                "planningTime": "1.42s",
                "analysisTime": "248.56ms",
                "queuedTime": "412.90us",
                "executionTime": "2.30m",
                "totalCpuTime": "1.66h",
                "rawInputDataSize": "83.76GB",
                "internalNetworkInputDataSize": "291.97GB",
                "physicalInputDataSize": "83.76GB",
                "processedInputDataSize": "83.76GB",
                "rawInputPositions": "1911054322",
                "internalNetworkInputPositions": "1911054318",
                "physicalInputPositions": "1911054322",
                "processedInputPositions": "1911054322",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "15.32MB",
                "writtenPositions": "81600",
                "peakTotalMemoryReservation": "3.83GB",
                "peakTaskTotalMemory": "601.73MB",
                "totalSplits": 1463,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "prod.verticals.slowly_transfer_site_new_delta",
                    "sunduk.baguild.pavelk_slowly_direct_actions_temp_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.27m",
                    "totalQueuedTime": "1.23ms",
                    "totalScheduledTime": "951.06ms",
                    "totalCpuTime": "34.62ms",
                    "totalBlockedTime": "11.28m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "2.26m",
                    "totalQueuedTime": "1.85m",
                    "totalScheduledTime": "6.75m",
                    "totalCpuTime": "4.08m",
                    "totalBlockedTime": "14.37h",
                    "rawInputDataSize": "291.97GB",
                    "internalNetworkInputDataSize": "291.97GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "303.45GB",
                    "rawInputPositions": "1911054302",
                    "internalNetworkInputPositions": "1911054302",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "1911054302",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 592,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "45.16s",
                    "totalQueuedTime": "2.13h",
                    "totalScheduledTime": "1.10h",
                    "totalCpuTime": "41.48m",
                    "totalBlockedTime": "6.77m",
                    "rawInputDataSize": "38.04GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "38.04GB",
                    "processedInputDataSize": "38.04GB",
                    "rawInputPositions": "955525326",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955525326",
                    "processedInputPositions": "955525326",
                    "outputDataSize": "133.48GB",
                    "outputPositions": "955525326",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 417,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "1.67s",
                    "totalQueuedTime": "384.78ms",
                    "totalScheduledTime": "2.20s",
                    "totalCpuTime": "255.15ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "6.38MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "6.38MB",
                    "processedInputDataSize": "6.38MB",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1835",
                    "processedInputPositions": "1835",
                    "outputDataSize": "194.17kB",
                    "outputPositions": "1825",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "51.73s",
                    "totalQueuedTime": "2.56h",
                    "totalScheduledTime": "1.38h",
                    "totalCpuTime": "53.77m",
                    "totalBlockedTime": "8.44m",
                    "rawInputDataSize": "45.72GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "45.72GB",
                    "processedInputDataSize": "45.72GB",
                    "rawInputPositions": "955525326",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955525326",
                    "processedInputPositions": "955525326",
                    "outputDataSize": "169.96GB",
                    "outputPositions": "955525326",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 417,
                    "spilledDataSize": "0B"
                },
                "5": {
                    "stageDuration": "1.67s",
                    "totalQueuedTime": "67.50ms",
                    "totalScheduledTime": "2.34s",
                    "totalCpuTime": "278.99ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "532.30kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "532.30kB",
                    "processedInputDataSize": "532.30kB",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1835",
                    "processedInputPositions": "1835",
                    "outputDataSize": "194.17kB",
                    "outputPositions": "1825",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: prod.verticals.slowly_transfer_site_new_delta scanned 2 times"
                },
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.pavelk_slowly_direct_actions_temp_delta scanned 2 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:11:18.019,  cpu: 00:00:00.034,  blocked: 00:11:16.800,  queue: 00:00:00.001,  scheduled: 00:00:00.951 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.949,  finishWall: 00:00:00.000)  other: 00:00:00.266,  timeCost: 0.0%,  blocked: 99.8%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  420.6/592  elapsed: 15:49:13.356,  cpu: 00:04:04.800,  blocked: 14:22:12.000,  queue: 00:01:51.282,  scheduled: 00:06:45.000 (addInputWall: 00:00:03.297,  getOutputWall: 00:06:27.321,  finishWall: 00:00:09.141)  other: 01:18:25.074,  timeCost: 4.3%,  blocked: 90.8%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "2",
                        "operatorId": "1"
                    },
                    "level": "WARN",
                    "message": "InnerJoin by non-uniq column(s), multiplier 22.7"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "5",
                        "operatorId": "1"
                    },
                    "level": "WARN",
                    "message": "InnerJoin by non-uniq column(s), multiplier 22.7"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  311.5/417  elapsed: 03:54:30.088,  cpu: 00:41:28.800,  blocked: 00:06:46.200,  queue: 02:08:05.089,  scheduled: 01:06:00.000 (addInputWall: 00:29:11.400,  getOutputWall: 00:48:32.400,  finishWall: 00:00:05.920)  other: 00:33:38.798,  timeCost: 42.4%,  blocked: 2.9%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.0"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3    1.6/16   elapsed: 00:00:02.587,  cpu: 00:00:00.255,  blocked: 00:00:00.000,  queue: 00:00:00.384,  scheduled: 00:00:02.200 (addInputWall: 00:00:00.021,  getOutputWall: 00:00:02.180,  finishWall: 00:00:00.020)  other: 00:00:00.002,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.4"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 97.0 of data dropped"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4  325.2/417  elapsed: 04:40:22.751,  cpu: 00:53:46.200,  blocked: 00:08:26.399,  queue: 02:33:37.920,  scheduled: 01:22:48.000 (addInputWall: 00:34:51.600,  getOutputWall: 01:00:36.000,  finishWall: 00:00:05.460)  other: 00:35:30.430,  timeCost: 53.2%,  blocked: 3.0%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.0"
                },
                {
                    "source": {
                        "stageId": "5"
                    },
                    "level": "INFO",
                    "message": "stage.5    1.4/16   elapsed: 00:00:02.409,  cpu: 00:00:00.278,  blocked: 00:00:00.000,  queue: 00:00:00.067,  scheduled: 00:00:02.340 (addInputWall: 00:00:00.277,  getOutputWall: 00:00:02.310,  finishWall: 00:00:00.030)  other: 00:00:00.001,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "5",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.9"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"40\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"38\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[prod:connectorId=prod; schemaName=verticals; tableName=slowly_new_transfer_synt_events_delta; tablePath=s3a://wix-bi-data-warehouse/dynamic/f8609bfb-a0b2-4905-aec0-a955da384968; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [date_created, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar(0), 7], [action_type, varchar(8), 8], [event_type, varchar(5), 9], [is_published, boolean, 10]], hash=-331849498]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1058\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"907\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"39\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := new_uuid_186\\nmsid := msid_187\\napp_id := app_id_188\\ninstance_id := instance_id_189\\ndate_created := transfer_date_created_190\\nwas_demo := expr_191\\ninitiator_name := expr_192\\naction_type := expr_193\\nevent_type := expr_194\\nis_published := expr_195\\n\",\n  \"children\" : [ {\n    \"id\" : \"1057\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1056\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[ROUND_ROBIN] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"17\",\n        \"name\" : \"FilterProject\",\n        \"identifier\" : \"[filterPredicate = ((\\\"row_number\\\" = BIGINT '1') AND (\\\"event_type\\\" = CAST('open' AS varchar(5))))]\",\n        \"details\" : \"expr_67 := (CASE WHEN (\\\"last_publish_date\\\" BETWEEN \\\"open_date\\\" AND \\\"date_created\\\") THEN true ELSE false END)\\nexpr_86 := CAST('open' AS varchar(5))\\nexpr_64 := ''\\nexpr_65 := 'transfer'\\nexpr_63 := false\\n\",\n        \"children\" : [ {\n          \"id\" : \"1178\",\n          \"name\" : \"Project\",\n          \"identifier\" : \"[]\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"637\",\n            \"name\" : \"TopNRowNumber\",\n            \"identifier\" : \"[partition by (uuid_2, msid_1, app_id, date_created), order by (open_date DESC_NULLS_LAST, event_type DESC_NULLS_LAST) limit 1][$hashvalue]\",\n            \"details\" : \"row_number := row_number()\\n\",\n            \"children\" : [ {\n              \"id\" : \"1053\",\n              \"name\" : \"LocalExchange\",\n              \"identifier\" : \"[HASH][$hashvalue] (\\\"uuid_2\\\", \\\"msid_1\\\", \\\"app_id\\\", \\\"date_created\\\")\",\n              \"details\" : \"\",\n              \"children\" : [ {\n                \"id\" : \"1177\",\n                \"name\" : \"Project\",\n                \"identifier\" : \"[]\",\n                \"details\" : \"$hashvalue_221 := combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid_2\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created\\\"), 0))\\n\",\n                \"children\" : [ {\n                  \"id\" : \"4\",\n                  \"name\" : \"InnerJoin\",\n                  \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_1\\\") AND (\\\"date_created\\\" > date_add('second', BIGINT '5', \\\"open_date\\\"))][$hashvalue_216, $hashvalue_218]\",\n                  \"details\" : \"Distribution: PARTITIONED\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"902\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[2]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"2\" ]\n                  }, {\n                    \"id\" : \"1052\",\n                    \"name\" : \"LocalExchange\",\n                    \"identifier\" : \"[HASH][$hashvalue_218] (\\\"msid_1\\\")\",\n                    \"details\" : \"\",\n                    \"children\" : [ {\n                      \"id\" : \"903\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[3]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"3\" ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      }, {\n        \"id\" : \"33\",\n        \"name\" : \"Project\",\n        \"identifier\" : \"[]\",\n        \"details\" : \"expr_171 := false\\nexpr_172 := ''\\nexpr_173 := 'transfer'\\nexpr_174 := 'close'\\nexpr_175 := (CASE WHEN (\\\"last_publish_date_101\\\" BETWEEN \\\"open_date_95\\\" AND \\\"date_created_98\\\") THEN true ELSE false END)\\n\",\n        \"children\" : [ {\n          \"id\" : \"27\",\n          \"name\" : \"FilterProject\",\n          \"identifier\" : \"[filterPredicate = ((\\\"row_number_115\\\" = BIGINT '1') AND (\\\"event_type_90\\\" = CAST('open' AS varchar(5))))]\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"1182\",\n            \"name\" : \"Project\",\n            \"identifier\" : \"[]\",\n            \"details\" : \"\",\n            \"children\" : [ {\n              \"id\" : \"638\",\n              \"name\" : \"TopNRowNumber\",\n              \"identifier\" : \"[partition by (uuid_106, msid_102, app_id_89, date_created_98), order by (open_date_95 DESC_NULLS_LAST, event_type_90 DESC_NULLS_LAST) limit 1][$hashvalue_222]\",\n              \"details\" : \"row_number_115 := row_number()\\n\",\n              \"children\" : [ {\n                \"id\" : \"1055\",\n                \"name\" : \"LocalExchange\",\n                \"identifier\" : \"[HASH][$hashvalue_222] (\\\"uuid_106\\\", \\\"msid_102\\\", \\\"app_id_89\\\", \\\"date_created_98\\\")\",\n                \"details\" : \"\",\n                \"children\" : [ {\n                  \"id\" : \"1181\",\n                  \"name\" : \"Project\",\n                  \"identifier\" : \"[]\",\n                  \"details\" : \"$hashvalue_228 := combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid_106\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_102\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_89\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created_98\\\"), 0))\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"22\",\n                    \"name\" : \"InnerJoin\",\n                    \"identifier\" : \"[(\\\"msid_94\\\" = \\\"msid_102\\\") AND (\\\"date_created_98\\\" > date_add('second', BIGINT '5', \\\"open_date_95\\\"))][$hashvalue_223, $hashvalue_225]\",\n                    \"details\" : \"Distribution: PARTITIONED\\n\",\n                    \"children\" : [ {\n                      \"id\" : \"905\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[4]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"4\" ]\n                    }, {\n                      \"id\" : \"1054\",\n                      \"name\" : \"LocalExchange\",\n                      \"identifier\" : \"[HASH][$hashvalue_225] (\\\"msid_102\\\")\",\n                      \"details\" : \"\",\n                      \"children\" : [ {\n                        \"id\" : \"906\",\n                        \"name\" : \"RemoteSource\",\n                        \"identifier\" : \"[5]\",\n                        \"details\" : \"\",\n                        \"children\" : [ ],\n                        \"remoteSources\" : [ \"5\" ]\n                      } ],\n                      \"remoteSources\" : [ ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"1175\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_slowly_direct_actions_temp_delta', folderName='4d73643a-cf2f-41a0-86c9-f04bd2c030c0', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_217 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\ninstance_id := [instance_id, varchar, 4]\\nevent_type := [event_type, varchar(5), 2]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"1176\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_transfer_site_new_delta', folderName='5f32479c-ba39-454f-852b-f2c35732f970', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}, filterPredicate = ((\\\"date_created\\\" >= \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593648000000)) AND (\\\"date_created\\\" < \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593734400000)))]\",\n  \"details\" : \"$hashvalue_220 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_1\\\"), 0))\\nmsid_1 := [msid, varchar, 4]\\nlast_publish_date := [last_publish_date, timestamp, 3]\\nuuid_2 := [uuid, varchar, 8]\\ndate_created := [date_created, timestamp, 0]\\n    :: [[2020-07-02 00:00:00.000, 2020-07-03 00:00:00.000)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"1179\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_slowly_direct_actions_temp_delta', folderName='4d73643a-cf2f-41a0-86c9-f04bd2c030c0', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_224 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_94\\\"), 0))\\nmsid_94 := [msid, varchar, 6]\\nevent_type_90 := [event_type, varchar(5), 2]\\nopen_date_95 := [open_date, timestamp, 7]\\nuuid_96 := [uuid, varchar, 8]\\ninstance_id_92 := [instance_id, varchar, 4]\\napp_id_89 := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "5",
                                "plan": "{\n  \"id\" : \"1180\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_transfer_site_new_delta', folderName='5f32479c-ba39-454f-852b-f2c35732f970', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}, filterPredicate = ((\\\"date_created_98\\\" >= \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593648000000)) AND (\\\"date_created_98\\\" < \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593734400000)))]\",\n  \"details\" : \"$hashvalue_227 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_102\\\"), 0))\\ndate_created_98 := [date_created, timestamp, 0]\\n    :: [[2020-07-02 00:00:00.000, 2020-07-03 00:00:00.000)]\\nmsid_102 := [msid, varchar, 4]\\nlast_publish_date_101 := [last_publish_date, timestamp, 3]\\nuuid_106 := [uuid, varchar, 8]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_014730_08520_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_core_and_transfer_delta -- 194160678\nAS\n    SELECT uuid,msid,app_id,instance_id,open_date AS date_created,was_demo,initiator_name,action_type,event_type, is_published\n    FROM sunduk.baguild.pavelk_slowly_direct_actions_temp_delta\n        UNION ALL\n    SELECT uuid,msid,app_id,instance_id,date_created,was_demo,initiator_name,action_type,event_type, is_published\n    FROM prod.verticals.slowly_new_transfer_synt_events_delta",
            "queryName": "create sunduk.baguild.slowly_core_and_transfer_delta",
            "queryStats": {
                "elapsedTime": "3.40m",
                "planningTime": "1.19s",
                "analysisTime": "510.61ms",
                "queuedTime": "4.64ms",
                "executionTime": "3.39m",
                "totalCpuTime": "1.49h",
                "rawInputDataSize": "56.17GB",
                "internalNetworkInputDataSize": "179.71GB",
                "physicalInputDataSize": "56.17GB",
                "processedInputDataSize": "188.41GB",
                "rawInputPositions": "955606926",
                "internalNetworkInputPositions": "955606942",
                "physicalInputPositions": "955606926",
                "processedInputPositions": "955606926",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "188.38GB",
                "writtenPositions": "955606926",
                "peakTotalMemoryReservation": "2.07GB",
                "peakTaskTotalMemory": "181.76MB",
                "totalSplits": 518,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "prod.verticals.slowly_new_transfer_synt_events_delta",
                    "sunduk.baguild.pavelk_slowly_direct_actions_temp_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "3.37m",
                    "totalQueuedTime": "10.25ms",
                    "totalScheduledTime": "738.18ms",
                    "totalCpuTime": "54.30ms",
                    "totalBlockedTime": "16.80m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "3.05m",
                    "totalQueuedTime": "84.06ms",
                    "totalScheduledTime": "48.07m",
                    "totalCpuTime": "40.55m",
                    "totalBlockedTime": "2.77h",
                    "rawInputDataSize": "179.71GB",
                    "internalNetworkInputDataSize": "179.71GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "188.38GB",
                    "rawInputPositions": "955606926",
                    "internalNetworkInputPositions": "955606926",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "955606926",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 80,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "2.71m",
                    "totalQueuedTime": "5.66h",
                    "totalScheduledTime": "58.70m",
                    "totalCpuTime": "48.82m",
                    "totalBlockedTime": "3.91h",
                    "rawInputDataSize": "56.17GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "56.17GB",
                    "processedInputDataSize": "188.41GB",
                    "rawInputPositions": "955525326",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955525326",
                    "processedInputPositions": "955525326",
                    "outputDataSize": "188.41GB",
                    "outputPositions": "955525326",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 417,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "439.00ms",
                    "totalQueuedTime": "23.62ms",
                    "totalScheduledTime": "2.40s",
                    "totalCpuTime": "584.35ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "148.30kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "148.30kB",
                    "processedInputDataSize": "148.30kB",
                    "rawInputPositions": "81600",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "81600",
                    "processedInputPositions": "81600",
                    "outputDataSize": "15.91MB",
                    "outputPositions": "81600",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:16:48.814,  cpu: 00:00:00.054,  blocked: 00:16:48.000,  queue: 00:00:00.010,  scheduled: 00:00:00.738 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.736,  finishWall: 00:00:00.000)  other: 00:00:00.065,  timeCost: 0.0%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   75.9/80   elapsed: 03:51:02.235,  cpu: 00:40:33.000,  blocked: 02:46:12.000,  queue: 00:00:00.084,  scheduled: 00:48:04.200 (addInputWall: 00:41:52.301,  getOutputWall: 00:00:49.270,  finishWall: 00:05:13.801)  other: 00:16:45.951,  timeCost: 45.0%,  blocked: 71.9%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  234.9/417  elapsed: 10:36:38.111,  cpu: 00:48:49.200,  blocked: 03:54:36.000,  queue: 05:39:38.075,  scheduled: 00:58:42.000 (addInputWall: 00:17:09.600,  getOutputWall: 00:55:09.000,  finishWall: 00:00:00.002)  other: 00:03:42.036,  timeCost: 55.0%,  blocked: 36.8%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3    5.5/16   elapsed: 00:00:02.427,  cpu: 00:00:00.584,  blocked: 00:00:00.000,  queue: 00:00:00.023,  scheduled: 00:00:02.400 (addInputWall: 00:00:00.040,  getOutputWall: 00:00:02.390,  finishWall: 00:00:00.000)  other: 00:00:00.004,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.7"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"12\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"10\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_core_and_transfer_delta; tablePath=s3a://wix-bi-sunduk/baguild/b9abc80b-3dbd-4965-ac10-68fd30883d11; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [date_created, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(16), 8], [event_type, varchar(5), 9], [is_published, boolean, 10]], hash=2111196041]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"298\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"254\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"11\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid_58\\nmsid := msid_59\\napp_id := app_id_60\\ninstance_id := instance_id_61\\ndate_created := open_date_62\\nwas_demo := was_demo_63\\ninitiator_name := initiator_name_64\\naction_type := action_type_65\\nevent_type := event_type_66\\nis_published := is_published_67\\n\",\n  \"children\" : [ {\n    \"id\" : \"297\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"253\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[2,3]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"2\", \"3\" ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"0\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_slowly_direct_actions_temp_delta', folderName='4d73643a-cf2f-41a0-86c9-f04bd2c030c0', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"open_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\ninstance_id := [instance_id, varchar, 4]\\nevent_type := [event_type, varchar(5), 2]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 5]\\ninitiator_name := [initiator_name, varchar, 3]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"6\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_new_transfer_synt_events_delta', folderName='f8609bfb-a0b2-4905-aec0-a955da384968', columns='[[action_type,varchar(8),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar(0),false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"expr := CAST(\\\"initiator_name_23\\\" AS varchar)\\nexpr_55 := CAST(\\\"action_type_20\\\" AS varchar(16))\\nwas_demo_28 := [was_demo, boolean, 9]\\nevent_type_22 := [event_type, varchar(5), 3]\\ninstance_id_24 := [instance_id, varchar, 5]\\ndate_created := [date_created, timestamp, 2]\\nmsid_26 := [msid, varchar, 7]\\napp_id_21 := [app_id, varchar, 1]\\ninitiator_name_23 := [initiator_name, varchar(0), 4]\\naction_type_20 := [action_type, varchar(8), 0]\\nis_published_25 := [is_published, boolean, 6]\\nuuid_27 := [uuid, varchar, 8]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015054_08787_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  prod.verticals.slowly_revokes_delta -- 108643\nAS\n\n    SELECT *\n    FROM sunduk.baguild.slowly_core_and_transfer_delta\n    WHERE event_type='close'",
            "queryName": "create prod.verticals.slowly_revokes_delta",
            "queryStats": {
                "elapsedTime": "18.43s",
                "planningTime": "414.84ms",
                "analysisTime": "167.14ms",
                "queuedTime": "148.05us",
                "executionTime": "18.26s",
                "totalCpuTime": "8.64m",
                "rawInputDataSize": "25.78GB",
                "internalNetworkInputDataSize": "2.46kB",
                "physicalInputDataSize": "25.78GB",
                "processedInputDataSize": "25.78GB",
                "rawInputPositions": "261417148",
                "internalNetworkInputPositions": "40",
                "physicalInputPositions": "261417148",
                "processedInputPositions": "261417148",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "28.78MB",
                "writtenPositions": "143751",
                "peakTotalMemoryReservation": "2.29MB",
                "peakTaskTotalMemory": "474.85kB",
                "totalSplits": 162,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "sunduk.baguild.slowly_core_and_transfer_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "17.84s",
                    "totalQueuedTime": "1.01ms",
                    "totalScheduledTime": "799.08ms",
                    "totalCpuTime": "28.39ms",
                    "totalBlockedTime": "1.42m",
                    "rawInputDataSize": "2.46kB",
                    "internalNetworkInputDataSize": "2.46kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "560B",
                    "rawInputPositions": "40",
                    "internalNetworkInputPositions": "40",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "40",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "7.84s",
                    "totalQueuedTime": "2.70m",
                    "totalScheduledTime": "10.11m",
                    "totalCpuTime": "8.64m",
                    "totalBlockedTime": "4.93m",
                    "rawInputDataSize": "25.78GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "25.78GB",
                    "processedInputDataSize": "25.78GB",
                    "rawInputPositions": "261417148",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "261417148",
                    "processedInputPositions": "261417148",
                    "outputDataSize": "560B",
                    "outputPositions": "40",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 157,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.8/5    elapsed: 00:01:26.016,  cpu: 00:00:00.028,  blocked: 00:01:25.200,  queue: 00:00:00.001,  scheduled: 00:00:00.799 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.796,  finishWall: 00:00:00.000)  other: 00:00:00.016,  timeCost: 0.1%,  blocked: 99.1%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  136.0/157  elapsed: 00:17:45.615,  cpu: 00:08:38.400,  blocked: 00:04:55.800,  queue: 00:02:42.108,  scheduled: 00:10:06.600 (addInputWall: 00:05:02.292,  getOutputWall: 00:09:58.204,  finishWall: 00:00:07.750)  other: 00:00:01.107,  timeCost: 99.9%,  blocked: 27.8%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.3"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 99.9 of data dropped"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "1"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.2"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[prod:connectorId=prod; schemaName=verticals; tableName=slowly_revokes_delta; tablePath=s3a://wix-bi-data-warehouse/dynamic/4f10f360-ac09-4b9e-bd79-152398442ee7; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [date_created, timestamp, 3], [event_type, varchar(5), 4], [initiator_name, varchar, 5], [instance_id, varchar, 6], [is_published, boolean, 7], [msid, varchar, 8], [uuid, varchar, 9], [was_demo, boolean, 10]], hash=-1408438743]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"208\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"174\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndate_created := date_created\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nuuid := uuid\\nwas_demo := was_demo\\n\",\n  \"children\" : [ {\n    \"id\" : \"207\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"173\",\n      \"name\" : \"ScanFilter\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_core_and_transfer_delta', folderName='b9abc80b-3dbd-4965-ac10-68fd30883d11', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"event_type\\\" = 'close')]\",\n      \"details\" : \"msid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\n    :: [[close]]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015113_08794_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_adds_delta -- 194052035\nAS\n    SELECT *\n    FROM sunduk.baguild.slowly_core_and_transfer_delta\n    WHERE event_type='open'",
            "queryName": "create sunduk.baguild.slowly_adds_delta",
            "queryStats": {
                "elapsedTime": "2.04m",
                "planningTime": "1.00s",
                "analysisTime": "173.22ms",
                "queuedTime": "114.61us",
                "executionTime": "2.03m",
                "totalCpuTime": "1.30h",
                "rawInputDataSize": "81.62GB",
                "internalNetworkInputDataSize": "2.46kB",
                "physicalInputDataSize": "81.62GB",
                "processedInputDataSize": "81.62GB",
                "rawInputPositions": "955606926",
                "internalNetworkInputPositions": "40",
                "physicalInputPositions": "955606926",
                "processedInputPositions": "955606926",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "188.39GB",
                "writtenPositions": "955463175",
                "peakTotalMemoryReservation": "294.84kB",
                "peakTaskTotalMemory": "7.37kB",
                "totalSplits": 464,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "sunduk.baguild.slowly_core_and_transfer_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.02m",
                    "totalQueuedTime": "973.86us",
                    "totalScheduledTime": "867.51ms",
                    "totalCpuTime": "58.15ms",
                    "totalBlockedTime": "10.02m",
                    "rawInputDataSize": "2.46kB",
                    "internalNetworkInputDataSize": "2.46kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "560B",
                    "rawInputPositions": "40",
                    "internalNetworkInputPositions": "40",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "40",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "59.09s",
                    "totalQueuedTime": "2.21h",
                    "totalScheduledTime": "1.58h",
                    "totalCpuTime": "1.30h",
                    "totalBlockedTime": "1.11h",
                    "rawInputDataSize": "81.62GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "81.62GB",
                    "processedInputDataSize": "81.62GB",
                    "rawInputPositions": "955606926",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955606926",
                    "processedInputPositions": "955606926",
                    "outputDataSize": "560B",
                    "outputPositions": "40",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 459,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:10:01.828,  cpu: 00:00:00.058,  blocked: 00:10:01.200,  queue: 00:00:00.000,  scheduled: 00:00:00.867 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.864,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  300.3/459  elapsed: 04:55:43.242,  cpu: 01:18:00.000,  blocked: 01:06:36.000,  queue: 02:12:24.268,  scheduled: 01:34:48.000 (addInputWall: 00:57:00.323,  getOutputWall: 00:49:26.190,  finishWall: 00:06:33.601)  other: 00:01:54.974,  timeCost: 100.0%,  blocked: 22.5%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_adds_delta; tablePath=s3a://wix-bi-sunduk/baguild/f48d4df5-706e-4162-869d-cfb4f8a72f30; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [date_created, timestamp, 3], [event_type, varchar(5), 4], [initiator_name, varchar, 5], [instance_id, varchar, 6], [is_published, boolean, 7], [msid, varchar, 8], [uuid, varchar, 9], [was_demo, boolean, 10]], hash=1224659568]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"208\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"174\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndate_created := date_created\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nuuid := uuid\\nwas_demo := was_demo\\n\",\n  \"children\" : [ {\n    \"id\" : \"207\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"173\",\n      \"name\" : \"ScanFilter\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_core_and_transfer_delta', folderName='b9abc80b-3dbd-4965-ac10-68fd30883d11', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"event_type\\\" = CAST('open' AS varchar(5)))]\",\n      \"details\" : \"msid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\n    :: [[open]]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015315_08901_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.pavelk_unpublish_events_delta -- 14309\nAS\n\n    SELECT msid, date_created, 'unpublish_site' as action_type\n    FROM        sunduk.baguild.slowly_src50_events_delta\n    WHERE evid=31  --AND date_created >= date (timestamp '2020-07-02 01:00:56') AND date_created < date (timestamp '2020-07-03 00:56:28')",
            "queryName": "create sunduk.baguild.pavelk_unpublish_events_delta",
            "queryStats": {
                "elapsedTime": "2.99s",
                "planningTime": "489.65ms",
                "analysisTime": "213.94ms",
                "queuedTime": "127.44us",
                "executionTime": "2.77s",
                "totalCpuTime": "2.45s",
                "rawInputDataSize": "308.27MB",
                "internalNetworkInputDataSize": "1.42kB",
                "physicalInputDataSize": "308.27MB",
                "processedInputDataSize": "308.27MB",
                "rawInputPositions": "2707808",
                "internalNetworkInputPositions": "23",
                "physicalInputPositions": "2707808",
                "processedInputPositions": "2707808",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "660.59kB",
                "writtenPositions": "9804",
                "peakTotalMemoryReservation": "0B",
                "peakTaskTotalMemory": "0B",
                "totalSplits": 68,
                "connectorSplits": "0",
                "numberOfWorkers": 40,
                "connectorTables": [
                    "sunduk.baguild.slowly_src50_events_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.28s",
                    "totalQueuedTime": "921.04us",
                    "totalScheduledTime": "1.41s",
                    "totalCpuTime": "22.15ms",
                    "totalBlockedTime": "4.33s",
                    "rawInputDataSize": "1.42kB",
                    "internalNetworkInputDataSize": "1.42kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "322B",
                    "rawInputPositions": "23",
                    "internalNetworkInputPositions": "23",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "23",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "299.00ms",
                    "totalQueuedTime": "628.47ms",
                    "totalScheduledTime": "14.38s",
                    "totalCpuTime": "2.43s",
                    "totalBlockedTime": "7.24s",
                    "rawInputDataSize": "308.27MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "308.27MB",
                    "processedInputDataSize": "308.27MB",
                    "rawInputPositions": "2707808",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "2707808",
                    "processedInputPositions": "2707808",
                    "outputDataSize": "322B",
                    "outputPositions": "23",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 63,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    2.5/5    elapsed: 00:00:05.753,  cpu: 00:00:00.022,  blocked: 00:00:04.330,  queue: 00:00:00.000,  scheduled: 00:00:01.410 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.410,  finishWall: 00:00:00.000)  other: 00:00:00.012,  timeCost: 8.9%,  blocked: 75.3%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   74.4/63   elapsed: 00:00:22.249,  cpu: 00:00:02.430,  blocked: 00:00:07.240,  queue: 00:00:00.628,  scheduled: 00:00:14.380 (addInputWall: 00:00:08.206,  getOutputWall: 00:00:11.181,  finishWall: 00:00:03.180)  other: 00:00:00.001,  timeCost: 91.1%,  blocked: 32.5%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.3"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 99.8 of data dropped"
                },
                {
                    "source": {
                        "stageId": "1",
                        "taskId": "11"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(123.13MB)/P50(791.71kB) = 159.3 times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=pavelk_unpublish_events_delta; tablePath=s3a://wix-bi-sunduk/baguild/6527a6af-fc0f-4f8c-b791-13a85c5540d7; columnHandles=[[msid, varchar, 1], [date_created, timestamp, 2], [action_type, varchar(14), 3]], hash=-330129057]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"248\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"208\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"msid := msid\\ndate_created := date_created\\naction_type := expr\\n\",\n  \"children\" : [ {\n    \"id\" : \"247\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"2\",\n      \"name\" : \"ScanFilterProject\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_src50_events_delta', folderName='c4b34e59-7080-45d8-a8bf-b9c1849256b7', columns='[[app_id,varchar,false], [date_created,timestamp,false], [evid,bigint,false], [initiator_name,varchar,false], [instance_id,varchar,false], [metasitename,varchar,false], [msid,varchar,false], [src,bigint,false], [targetmetasiteid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"evid\\\" = BIGINT '31')]\",\n      \"details\" : \"expr := 'unpublish_site'\\nmsid := [msid, varchar, 6]\\nevid := [evid, bigint, 2]\\n    :: [[31]]\\ndate_created := [date_created, timestamp, 1]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015318_08903_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\ncreate table if not exists sunduk.baguild.slowly_adds_delta_f\nAS\nselect *\nfrom sunduk.baguild.slowly_adds_delta\nwhere app_id in ('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e', '139ef4fa-c108-8f9a-c7be-d5f492a2c939', '141fbfae-511e-6817-c9f0-48993a7547d1'\n                , '1480c568-5cbd-9392-5604-1148f5faffa0', '13ee94c1-b635-8505-3391-97919052c16f', '14bca956-e09f-f4d6-14d7-466cb3f09103'\n                , '150ae7ee-c74a-eecd-d3d7-2112895b988a', '1375baa8-8eca-5659-ce9d-455b2009250d')",
            "queryName": "create sunduk.baguild.slowly_adds_delta_f",
            "queryStats": {
                "elapsedTime": "1.11m",
                "planningTime": "709.40ms",
                "analysisTime": "235.73ms",
                "queuedTime": "333.03us",
                "executionTime": "1.11m",
                "totalCpuTime": "48.89m",
                "rawInputDataSize": "64.22GB",
                "internalNetworkInputDataSize": "2.46kB",
                "physicalInputDataSize": "64.22GB",
                "processedInputDataSize": "64.22GB",
                "rawInputPositions": "955463175",
                "internalNetworkInputPositions": "40",
                "physicalInputPositions": "955463175",
                "processedInputPositions": "955463175",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "78.44GB",
                "writtenPositions": "397351572",
                "peakTotalMemoryReservation": "221.13kB",
                "peakTaskTotalMemory": "12.29kB",
                "totalSplits": 477,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.09m",
                    "totalQueuedTime": "892.86us",
                    "totalScheduledTime": "881.92ms",
                    "totalCpuTime": "39.04ms",
                    "totalBlockedTime": "5.40m",
                    "rawInputDataSize": "2.46kB",
                    "internalNetworkInputDataSize": "2.46kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "560B",
                    "rawInputPositions": "40",
                    "internalNetworkInputPositions": "40",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "40",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "29.99s",
                    "totalQueuedTime": "1.27h",
                    "totalScheduledTime": "59.51m",
                    "totalCpuTime": "48.89m",
                    "totalBlockedTime": "14.35m",
                    "rawInputDataSize": "64.22GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "64.22GB",
                    "processedInputDataSize": "64.22GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "560B",
                    "outputPositions": "40",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 472,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.9/5    elapsed: 00:05:24.857,  cpu: 00:00:00.039,  blocked: 00:05:24.000,  queue: 00:00:00.000,  scheduled: 00:00:00.881 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.878,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.7%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  300.3/472  elapsed: 02:30:05.999,  cpu: 00:48:53.400,  blocked: 00:14:21.000,  queue: 01:16:10.474,  scheduled: 00:59:30.600 (addInputWall: 00:29:13.256,  getOutputWall: 00:40:30.259,  finishWall: 00:03:24.601)  other: 00:00:03.924,  timeCost: 100.0%,  blocked: 9.6%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_adds_delta_f; tablePath=s3a://wix-bi-sunduk/baguild/ca5812ae-2ac4-4a73-8f40-035256ba4f35; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [date_created, timestamp, 3], [event_type, varchar(5), 4], [initiator_name, varchar, 5], [instance_id, varchar, 6], [is_published, boolean, 7], [msid, varchar, 8], [uuid, varchar, 9], [was_demo, boolean, 10]], hash=1770508557]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"210\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"176\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndate_created := date_created\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nuuid := uuid\\nwas_demo := was_demo\\n\",\n  \"children\" : [ {\n    \"id\" : \"209\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"175\",\n      \"name\" : \"ScanFilter\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta', folderName='f48d4df5-706e-4162-869d-cfb4f8a72f30', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('1375baa8-8eca-5659-ce9d-455b2009250d' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar)))]\",\n      \"details\" : \"msid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n    :: [[135c3d92-0fea-1f9d-2ba5-2a1dfb04297e], [1375baa8-8eca-5659-ce9d-455b2009250d], [139ef4fa-c108-8f9a-c7be-d5f492a2c939], [13ee94c1-b635-8505-3391-97919052c16f], [141fbfae-511e-6817-c9f0-48993a7547d1], [1480c568-5cbd-9392-5604-1148f5faffa0], [14bca956-e09f-f4d6-14d7-466cb3f09103], [150ae7ee-c74a-eecd-d3d7-2112895b988a]]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015425_09027_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\ncreate table if not exists sunduk.baguild.slowly_adds_delta_l_1\nAS\nselect *\nfrom sunduk.baguild.slowly_adds_delta\nwhere app_id in ('14b89688-9b25-5214-d1cb-a3fb9683618b',\n'146c0d71-352e-4464-9a03-2e868aabe7b9',\n'55cd9036-36bb-480b-8ddc-afda3cb2eb8d',\n'f123e8f1-4350-4c9b-b269-04adfadda977',\n'14517e1a-3ff0-af98-408e-2bd6953c36a2',\n'ea2821fc-7d97-40a9-9f75-772f29178430',\n'14ce1214-b278-a7e4-1373-00cebd1bef7c',\n'13aa9735-aa50-4bdb-877c-0bb46804bd71',\n'14bcded7-0066-7c35-14d7-466cb3f09103',\n'1380b703-ce81-ff05-f115-39571d94dfcd',\n'9bead16f-1c73-4cda-b6c4-28cff46988db',\n'e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b',\n'a322993b-2c74-426f-bbb8-444db73d0d1b',\n'14271d6f-ba62-d045-549b-ab972ae1f70e',\n'13d21c63-b5ec-5912-8397-c3a5ddb27a97',\n'307ba931-689c-4b55-bb1d-6a382bad9222',\n'd70b68e2-8d77-4e0c-9c00-c292d6e0025e')",
            "queryName": "create sunduk.baguild.slowly_adds_delta_l_1",
            "queryStats": {
                "elapsedTime": "1.06m",
                "planningTime": "534.61ms",
                "analysisTime": "167.84ms",
                "queuedTime": "119.93us",
                "executionTime": "1.05m",
                "totalCpuTime": "54.88m",
                "rawInputDataSize": "43.88GB",
                "internalNetworkInputDataSize": "3.01kB",
                "physicalInputDataSize": "43.88GB",
                "processedInputDataSize": "43.88GB",
                "rawInputPositions": "955463175",
                "internalNetworkInputPositions": "49",
                "physicalInputPositions": "955463175",
                "processedInputPositions": "955463175",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "86.81GB",
                "writtenPositions": "440229901",
                "peakTotalMemoryReservation": "400.50kB",
                "peakTaskTotalMemory": "14.74kB",
                "totalSplits": 486,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.05m",
                    "totalQueuedTime": "1.15ms",
                    "totalScheduledTime": "946.98ms",
                    "totalCpuTime": "43.70ms",
                    "totalBlockedTime": "5.15m",
                    "rawInputDataSize": "3.01kB",
                    "internalNetworkInputDataSize": "3.01kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "686B",
                    "rawInputPositions": "49",
                    "internalNetworkInputPositions": "49",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "49",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "37.93s",
                    "totalQueuedTime": "1.17h",
                    "totalScheduledTime": "1.13h",
                    "totalCpuTime": "54.87m",
                    "totalBlockedTime": "23.91m",
                    "rawInputDataSize": "43.88GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "43.88GB",
                    "processedInputDataSize": "43.88GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "686B",
                    "outputPositions": "49",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 481,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.9/5    elapsed: 00:05:09.955,  cpu: 00:00:00.043,  blocked: 00:05:09.000,  queue: 00:00:00.001,  scheduled: 00:00:00.946 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.943,  finishWall: 00:00:00.000)  other: 00:00:00.006,  timeCost: 0.0%,  blocked: 99.7%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  256.2/481  elapsed: 02:41:57.416,  cpu: 00:54:52.200,  blocked: 00:23:54.600,  queue: 01:10:09.611,  scheduled: 01:07:47.999 (addInputWall: 00:28:16.592,  getOutputWall: 00:45:53.798,  finishWall: 00:03:03.003)  other: 00:00:05.205,  timeCost: 100.0%,  blocked: 14.8%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.1"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "1"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.0"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_adds_delta_l_1; tablePath=s3a://wix-bi-sunduk/baguild/4b10cc82-524b-466d-b854-56a1ef7e4c5e; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [date_created, timestamp, 3], [event_type, varchar(5), 4], [initiator_name, varchar, 5], [instance_id, varchar, 6], [is_published, boolean, 7], [msid, varchar, 8], [uuid, varchar, 9], [was_demo, boolean, 10]], hash=1753794664]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"210\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"176\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndate_created := date_created\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nuuid := uuid\\nwas_demo := was_demo\\n\",\n  \"children\" : [ {\n    \"id\" : \"209\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"175\",\n      \"name\" : \"ScanFilter\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta', folderName='f48d4df5-706e-4162-869d-cfb4f8a72f30', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id\\\" IN (CAST('1380b703-ce81-ff05-f115-39571d94dfcd' AS varchar), CAST('13aa9735-aa50-4bdb-877c-0bb46804bd71' AS varchar), CAST('13d21c63-b5ec-5912-8397-c3a5ddb27a97' AS varchar), CAST('14271d6f-ba62-d045-549b-ab972ae1f70e' AS varchar), CAST('14517e1a-3ff0-af98-408e-2bd6953c36a2' AS varchar), CAST('146c0d71-352e-4464-9a03-2e868aabe7b9' AS varchar), CAST('14b89688-9b25-5214-d1cb-a3fb9683618b' AS varchar), CAST('14bcded7-0066-7c35-14d7-466cb3f09103' AS varchar), CAST('14ce1214-b278-a7e4-1373-00cebd1bef7c' AS varchar), CAST('307ba931-689c-4b55-bb1d-6a382bad9222' AS varchar), CAST('55cd9036-36bb-480b-8ddc-afda3cb2eb8d' AS varchar), CAST('9bead16f-1c73-4cda-b6c4-28cff46988db' AS varchar), CAST('a322993b-2c74-426f-bbb8-444db73d0d1b' AS varchar), CAST('d70b68e2-8d77-4e0c-9c00-c292d6e0025e' AS varchar), CAST('e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b' AS varchar), CAST('ea2821fc-7d97-40a9-9f75-772f29178430' AS varchar), CAST('f123e8f1-4350-4c9b-b269-04adfadda977' AS varchar)))]\",\n      \"details\" : \"msid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n    :: [[1380b703-ce81-ff05-f115-39571d94dfcd], [13aa9735-aa50-4bdb-877c-0bb46804bd71], [13d21c63-b5ec-5912-8397-c3a5ddb27a97], [14271d6f-ba62-d045-549b-ab972ae1f70e], [14517e1a-3ff0-af98-408e-2bd6953c36a2], [146c0d71-352e-4464-9a03-2e868aabe7b9], [14b89688-9b25-5214-d1cb-a3fb9683618b], [14bcded7-0066-7c35-14d7-466cb3f09103], [14ce1214-b278-a7e4-1373-00cebd1bef7c], [307ba931-689c-4b55-bb1d-6a382bad9222], [55cd9036-36bb-480b-8ddc-afda3cb2eb8d], [9bead16f-1c73-4cda-b6c4-28cff46988db], [a322993b-2c74-426f-bbb8-444db73d0d1b], [d70b68e2-8d77-4e0c-9c00-c292d6e0025e], [e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b], [ea2821fc-7d97-40a9-9f75-772f29178430], [f123e8f1-4350-4c9b-b269-04adfadda977]]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015528_09118_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\ncreate table if not exists sunduk.baguild.slowly_adds_delta_l_2\nAS\nselect *\nfrom sunduk.baguild.slowly_adds_delta\nwhere app_id not in ('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e', '139ef4fa-c108-8f9a-c7be-d5f492a2c939', '141fbfae-511e-6817-c9f0-48993a7547d1'\n                , '1480c568-5cbd-9392-5604-1148f5faffa0', '13ee94c1-b635-8505-3391-97919052c16f', '14bca956-e09f-f4d6-14d7-466cb3f09103'\n                , '150ae7ee-c74a-eecd-d3d7-2112895b988a', '1375baa8-8eca-5659-ce9d-455b2009250d','14b89688-9b25-5214-d1cb-a3fb9683618b',\n'146c0d71-352e-4464-9a03-2e868aabe7b9',\n'55cd9036-36bb-480b-8ddc-afda3cb2eb8d',\n'f123e8f1-4350-4c9b-b269-04adfadda977',\n'14517e1a-3ff0-af98-408e-2bd6953c36a2',\n'ea2821fc-7d97-40a9-9f75-772f29178430',\n'14ce1214-b278-a7e4-1373-00cebd1bef7c',\n'13aa9735-aa50-4bdb-877c-0bb46804bd71',\n'14bcded7-0066-7c35-14d7-466cb3f09103',\n'1380b703-ce81-ff05-f115-39571d94dfcd',\n'9bead16f-1c73-4cda-b6c4-28cff46988db',\n'e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b',\n'a322993b-2c74-426f-bbb8-444db73d0d1b',\n'14271d6f-ba62-d045-549b-ab972ae1f70e',\n'13d21c63-b5ec-5912-8397-c3a5ddb27a97',\n'307ba931-689c-4b55-bb1d-6a382bad9222',\n'd70b68e2-8d77-4e0c-9c00-c292d6e0025e')",
            "queryName": "create sunduk.baguild.slowly_adds_delta_l_2",
            "queryStats": {
                "elapsedTime": "34.09s",
                "planningTime": "553.55ms",
                "analysisTime": "198.71ms",
                "queuedTime": "104.53us",
                "executionTime": "33.90s",
                "totalCpuTime": "39.12m",
                "rawInputDataSize": "22.58GB",
                "internalNetworkInputDataSize": "3.01kB",
                "physicalInputDataSize": "22.58GB",
                "processedInputDataSize": "22.58GB",
                "rawInputPositions": "955463175",
                "internalNetworkInputPositions": "49",
                "physicalInputPositions": "955463175",
                "processedInputPositions": "955463175",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "23.12GB",
                "writtenPositions": "117881702",
                "peakTotalMemoryReservation": "6.48MB",
                "peakTaskTotalMemory": "2.51MB",
                "totalSplits": 486,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "33.34s",
                    "totalQueuedTime": "996.81us",
                    "totalScheduledTime": "1.43s",
                    "totalCpuTime": "36.51ms",
                    "totalBlockedTime": "2.66m",
                    "rawInputDataSize": "3.01kB",
                    "internalNetworkInputDataSize": "3.01kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "686B",
                    "rawInputPositions": "49",
                    "internalNetworkInputPositions": "49",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "49",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "16.92s",
                    "totalQueuedTime": "30.82m",
                    "totalScheduledTime": "49.47m",
                    "totalCpuTime": "39.11m",
                    "totalBlockedTime": "9.59m",
                    "rawInputDataSize": "22.58GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "22.58GB",
                    "processedInputDataSize": "22.58GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "686B",
                    "outputPositions": "49",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 481,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.8/5    elapsed: 00:02:40.992,  cpu: 00:00:00.036,  blocked: 00:02:39.600,  queue: 00:00:00.000,  scheduled: 00:00:01.430 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.421,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.1%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  318.9/481  elapsed: 01:29:56.425,  cpu: 00:39:06.600,  blocked: 00:09:35.400,  queue: 00:30:49.213,  scheduled: 00:49:28.200 (addInputWall: 00:10:18.642,  getOutputWall: 00:41:41.968,  finishWall: 00:01:48.604)  other: 00:00:03.611,  timeCost: 100.0%,  blocked: 10.7%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"6\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_adds_delta_l_2; tablePath=s3a://wix-bi-sunduk/baguild/94f3c825-73c8-454e-adcb-8aee0e31ce49; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [date_created, timestamp, 3], [event_type, varchar(5), 4], [initiator_name, varchar, 5], [instance_id, varchar, 6], [is_published, boolean, 7], [msid, varchar, 8], [uuid, varchar, 9], [was_demo, boolean, 10]], hash=592923165]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"210\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"176\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndate_created := date_created\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nuuid := uuid\\nwas_demo := was_demo\\n\",\n  \"children\" : [ {\n    \"id\" : \"209\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"175\",\n      \"name\" : \"ScanFilter\",\n      \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta', folderName='f48d4df5-706e-4162-869d-cfb4f8a72f30', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('1375baa8-8eca-5659-ce9d-455b2009250d' AS varchar), CAST('1380b703-ce81-ff05-f115-39571d94dfcd' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13aa9735-aa50-4bdb-877c-0bb46804bd71' AS varchar), CAST('13d21c63-b5ec-5912-8397-c3a5ddb27a97' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('14271d6f-ba62-d045-549b-ab972ae1f70e' AS varchar), CAST('14517e1a-3ff0-af98-408e-2bd6953c36a2' AS varchar), CAST('146c0d71-352e-4464-9a03-2e868aabe7b9' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14b89688-9b25-5214-d1cb-a3fb9683618b' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('14bcded7-0066-7c35-14d7-466cb3f09103' AS varchar), CAST('14ce1214-b278-a7e4-1373-00cebd1bef7c' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar), CAST('307ba931-689c-4b55-bb1d-6a382bad9222' AS varchar), CAST('55cd9036-36bb-480b-8ddc-afda3cb2eb8d' AS varchar), CAST('9bead16f-1c73-4cda-b6c4-28cff46988db' AS varchar), CAST('a322993b-2c74-426f-bbb8-444db73d0d1b' AS varchar), CAST('d70b68e2-8d77-4e0c-9c00-c292d6e0025e' AS varchar), CAST('e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b' AS varchar), CAST('ea2821fc-7d97-40a9-9f75-772f29178430' AS varchar), CAST('f123e8f1-4350-4c9b-b269-04adfadda977' AS varchar))))]\",\n      \"details\" : \"msid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n    :: [(<min>, 135c3d92-0fea-1f9d-2ba5-2a1dfb04297e), (135c3d92-0fea-1f9d-2ba5-2a1dfb04297e, 1375baa8-8eca-5659-ce9d-455b2009250d), (1375baa8-8eca-5659-ce9d-455b2009250d, 1380b703-ce81-ff05-f115-39571d94dfcd), (1380b703-ce81-ff05-f115-39571d94dfcd, 139ef4fa-c108-8f9a-c7be-d5f492a2c939), (139ef4fa-c108-8f9a-c7be-d5f492a2c939, 13aa9735-aa50-4bdb-877c-0bb46804bd71), (13aa9735-aa50-4bdb-877c-0bb46804bd71, 13d21c63-b5ec-5912-8397-c3a5ddb27a97), (13d21c63-b5ec-5912-8397-c3a5ddb27a97, 13ee94c1-b635-8505-3391-97919052c16f), (13ee94c1-b635-8505-3391-97919052c16f, 141fbfae-511e-6817-c9f0-48993a7547d1), (141fbfae-511e-6817-c9f0-48993a7547d1, 14271d6f-ba62-d045-549b-ab972ae1f70e), (14271d6f-ba62-d045-549b-ab972ae1f70e, 14517e1a-3ff0-af98-408e-2bd6953c36a2), (14517e1a-3ff0-af98-408e-2bd6953c36a2, 146c0d71-352e-4464-9a03-2e868aabe7b9), (146c0d71-352e-4464-9a03-2e868aabe7b9, 1480c568-5cbd-9392-5604-1148f5faffa0), (1480c568-5cbd-9392-5604-1148f5faffa0, 14b89688-9b25-5214-d1cb-a3fb9683618b), (14b89688-9b25-5214-d1cb-a3fb9683618b, 14bca956-e09f-f4d6-14d7-466cb3f09103), (14bca956-e09f-f4d6-14d7-466cb3f09103, 14bcded7-0066-7c35-14d7-466cb3f09103), (14bcded7-0066-7c35-14d7-466cb3f09103, 14ce1214-b278-a7e4-1373-00cebd1bef7c), (14ce1214-b278-a7e4-1373-00cebd1bef7c, 150ae7ee-c74a-eecd-d3d7-2112895b988a), (150ae7ee-c74a-eecd-d3d7-2112895b988a, 307ba931-689c-4b55-bb1d-6a382bad9222), (307ba931-689c-4b55-bb1d-6a382bad9222, 55cd9036-36bb-480b-8ddc-afda3cb2eb8d), (55cd9036-36bb-480b-8ddc-afda3cb2eb8d, 9bead16f-1c73-4cda-b6c4-28cff46988db), (9bead16f-1c73-4cda-b6c4-28cff46988db, a322993b-2c74-426f-bbb8-444db73d0d1b), (a322993b-2c74-426f-bbb8-444db73d0d1b, d70b68e2-8d77-4e0c-9c00-c292d6e0025e), (d70b68e2-8d77-4e0c-9c00-c292d6e0025e, e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b), (e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b, ea2821fc-7d97-40a9-9f75-772f29178430), (ea2821fc-7d97-40a9-9f75-772f29178430, f123e8f1-4350-4c9b-b269-04adfadda977), (f123e8f1-4350-4c9b-b269-04adfadda977, <max>)]\\n\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": []
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015603_09195_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_1_f\nAS\n\n    SELECT  base.uuid\n            , base.msid\n            , base.app_id\n            , base.instance_id\n            , base.date_created AS open_date\n            , base.was_demo\n            , base.initiator_name\n            , base.action_type\n            , base.event_type\n            , base.is_published\n            , min (case when base.date_created<next_event_msid.date_created AND base.instance_id<>next_event_msid.instance_id\n                        then next_event_msid.date_created end) AS diff_instance_date\n            , min_by (next_event_msid.action_type,  case    when base.date_created<next_event_msid.date_created AND base.instance_id<>next_event_msid.instance_id\n                                                            then next_event_msid.date_created end) AS diff_instance_reason\n\n    FROM        sunduk.baguild.slowly_adds_delta_f                                base\n    LEFT JOIN   sunduk.baguild.slowly_adds_delta_f                               next_event_msid         ON  base.app_id=next_event_msid.app_id\n                                                                                                            AND base.msid=next_event_msid.msid\n    GROUP by 1,2,3,4,5,6,7,8,9,10",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_1_f",
            "queryStats": {
                "elapsedTime": "2.41m",
                "planningTime": "892.90ms",
                "analysisTime": "258.74ms",
                "queuedTime": "131.49us",
                "executionTime": "2.41m",
                "totalCpuTime": "1.64h",
                "rawInputDataSize": "36.04GB",
                "internalNetworkInputDataSize": "132.22GB",
                "physicalInputDataSize": "36.04GB",
                "processedInputDataSize": "36.04GB",
                "rawInputPositions": "794703144",
                "internalNetworkInputPositions": "794703160",
                "physicalInputPositions": "794703144",
                "processedInputPositions": "794703144",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "80.32GB",
                "writtenPositions": "397351572",
                "peakTotalMemoryReservation": "186.13GB",
                "peakTaskTotalMemory": "11.69GB",
                "totalSplits": 655,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta_f"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.39m",
                    "totalQueuedTime": "1.21ms",
                    "totalScheduledTime": "824.38ms",
                    "totalCpuTime": "42.77ms",
                    "totalBlockedTime": "11.89m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "2.08m",
                    "totalQueuedTime": "893.86ms",
                    "totalScheduledTime": "1.08h",
                    "totalCpuTime": "57.72m",
                    "totalBlockedTime": "4.05h",
                    "rawInputDataSize": "132.22GB",
                    "internalNetworkInputDataSize": "132.22GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "138.40GB",
                    "rawInputPositions": "794703144",
                    "internalNetworkInputPositions": "794703144",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "794703144",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "41.14s",
                    "totalQueuedTime": "33.98m",
                    "totalScheduledTime": "29.30m",
                    "totalCpuTime": "24.57m",
                    "totalBlockedTime": "1.25h",
                    "rawInputDataSize": "19.26GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "19.26GB",
                    "processedInputDataSize": "19.26GB",
                    "rawInputPositions": "397351572",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "397351572",
                    "processedInputPositions": "397351572",
                    "outputDataSize": "81.78GB",
                    "outputPositions": "397351572",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 189,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "16.91s",
                    "totalQueuedTime": "7.13m",
                    "totalScheduledTime": "20.88m",
                    "totalCpuTime": "15.94m",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "16.78GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "16.78GB",
                    "processedInputDataSize": "16.78GB",
                    "rawInputPositions": "397351572",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "397351572",
                    "processedInputPositions": "397351572",
                    "outputDataSize": "56.65GB",
                    "outputPositions": "397351572",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 189,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.slowly_adds_delta_f scanned 2 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:11:54.532,  cpu: 00:00:00.042,  blocked: 00:11:53.400,  queue: 00:00:00.001,  scheduled: 00:00:00.824 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.822,  finishWall: 00:00:00.000)  other: 00:00:00.306,  timeCost: 0.0%,  blocked: 99.8%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  150.5/272  elapsed: 05:13:42.582,  cpu: 00:57:43.200,  blocked: 04:03:00.000,  queue: 00:00:00.893,  scheduled: 01:04:48.000 (addInputWall: 00:36:21.847,  getOutputWall: 00:24:16.231,  finishWall: 00:04:19.217)  other: 00:05:53.688,  timeCost: 56.4%,  blocked: 77.5%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  202.1/189  elapsed: 02:18:31.900,  cpu: 00:24:34.200,  blocked: 01:15:00.000,  queue: 00:33:59.076,  scheduled: 00:29:18.000 (addInputWall: 00:13:01.800,  getOutputWall: 00:20:58.800,  finishWall: 00:00:01.580)  other: 00:00:14.823,  timeCost: 25.5%,  blocked: 54.1%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   99.4/189  elapsed: 00:28:01.539,  cpu: 00:15:56.400,  blocked: 00:00:00.000,  queue: 00:07:07.899,  scheduled: 00:20:52.800 (addInputWall: 00:09:40.200,  getOutputWall: 00:15:28.800,  finishWall: 00:00:01.580)  other: 00:00:00.840,  timeCost: 18.2%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "WARN",
                    "message": "High avg CPU usage 56.88%, the most consuming operator ScanFilterAndProjectOperator (39.54%)"
                },
                {
                    "source": {
                        "stageId": "3",
                        "taskId": "3"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(1.54GB)/P50(248.23MB) = 6.4 times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"13\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_1_f; tablePath=s3a://wix-bi-sunduk/baguild/9a76bf3f-c884-4aeb-9eee-84a3dbdd9d60; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [open_date, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(16), 8], [event_type, varchar(5), 9], [is_published, boolean, 10], [diff_instance_date, timestamp, 11], [diff_instance_reason, varchar(16), 12]], hash=1323357824]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"376\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"312\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid\\nmsid := msid\\napp_id := app_id\\ninstance_id := instance_id\\nopen_date := date_created\\nwas_demo := was_demo\\ninitiator_name := initiator_name\\naction_type := action_type\\nevent_type := event_type\\nis_published := is_published\\ndiff_instance_date := min\\ndiff_instance_reason := min_by\\n\",\n  \"children\" : [ {\n    \"id\" : \"375\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"449\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"8\",\n        \"name\" : \"Aggregate(FINAL)[uuid, msid, app_id, instance_id, date_created, was_demo, initiator_name, action_type, event_type, is_published][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_83\\\")\\nmin_by := min_by(\\\"min_by_84\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"396\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"uuid\\\", \\\"msid\\\", \\\"app_id\\\", \\\"instance_id\\\", \\\"date_created\\\", \\\"was_demo\\\", \\\"initiator_name\\\", \\\"action_type\\\", \\\"event_type\\\", \\\"is_published\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"394\",\n            \"name\" : \"Aggregate(PARTIAL)[uuid, msid, app_id, instance_id, date_created, was_demo, initiator_name, action_type, event_type, is_published][$hashvalue_90]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_by_84 := min_by(\\\"action_type_0\\\", \\\"expr_25\\\")\\nmin_83 := min(\\\"expr_25\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"6\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_25 := (CASE WHEN ((\\\"date_created\\\" < \\\"date_created_2\\\") AND (\\\"instance_id\\\" <> \\\"instance_id_5\\\")) THEN \\\"date_created_2\\\" END)\\n$hashvalue_90 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"action_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"event_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"msid\\\" = \\\"msid_7\\\")][$hashvalue_85, $hashvalue_87]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"310\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"373\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_87] (\\\"app_id_1\\\", \\\"msid_7\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"311\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"447\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta_f', folderName='ca5812ae-2ac4-4a73-8f40-035256ba4f35', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_86 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nmsid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"448\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta_f', folderName='ca5812ae-2ac4-4a73-8f40-035256ba4f35', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_89 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_7\\\"), 0))\\naction_type_0 := [action_type, varchar(16), 0]\\ndate_created_2 := [date_created, timestamp, 2]\\ninstance_id_5 := [instance_id, varchar, 5]\\napp_id_1 := [app_id, varchar, 1]\\nmsid_7 := [msid, varchar, 7]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_015827_09310_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_1_l_1\nAS\n\n    SELECT  base.uuid\n            , base.msid\n            , base.app_id\n            , base.instance_id\n            , base.date_created AS open_date\n            , base.was_demo\n            , base.initiator_name\n            , base.action_type\n            , base.event_type\n            , base.is_published\n            , min (case when base.date_created<next_event_msid.date_created AND base.instance_id<>next_event_msid.instance_id\n                        then next_event_msid.date_created end) AS diff_instance_date\n            , min_by (next_event_msid.action_type,  case    when base.date_created<next_event_msid.date_created AND base.instance_id<>next_event_msid.instance_id\n                                                            then next_event_msid.date_created end) AS diff_instance_reason\n\n    FROM        sunduk.baguild.slowly_adds_delta_l_1                                base\n    LEFT JOIN   sunduk.baguild.slowly_adds_delta_l_1                               next_event_msid         ON  base.app_id=next_event_msid.app_id\n                                                                                                            AND base.msid=next_event_msid.msid\n    GROUP by 1,2,3,4,5,6,7,8,9,10",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_1_l_1",
            "queryStats": {
                "elapsedTime": "2.44m",
                "planningTime": "841.52ms",
                "analysisTime": "278.75ms",
                "queuedTime": "127.16us",
                "executionTime": "2.44m",
                "totalCpuTime": "1.63h",
                "rawInputDataSize": "46.91GB",
                "internalNetworkInputDataSize": "146.40GB",
                "physicalInputDataSize": "46.91GB",
                "processedInputDataSize": "46.91GB",
                "rawInputPositions": "880459802",
                "internalNetworkInputPositions": "880459818",
                "physicalInputPositions": "880459802",
                "processedInputPositions": "880459802",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "88.81GB",
                "writtenPositions": "440229901",
                "peakTotalMemoryReservation": "216.51GB",
                "peakTaskTotalMemory": "13.56GB",
                "totalSplits": 707,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta_l_1"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.43m",
                    "totalQueuedTime": "937.15us",
                    "totalScheduledTime": "1.69s",
                    "totalCpuTime": "43.28ms",
                    "totalBlockedTime": "11.99m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "2.19m",
                    "totalQueuedTime": "293.60ms",
                    "totalScheduledTime": "1.06h",
                    "totalCpuTime": "58.11m",
                    "totalBlockedTime": "4.32h",
                    "rawInputDataSize": "146.40GB",
                    "internalNetworkInputDataSize": "146.40GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "153.27GB",
                    "rawInputPositions": "880459802",
                    "internalNetworkInputPositions": "880459802",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "880459802",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "38.02s",
                    "totalQueuedTime": "46.59m",
                    "totalScheduledTime": "30.16m",
                    "totalCpuTime": "24.38m",
                    "totalBlockedTime": "58.50m",
                    "rawInputDataSize": "26.09GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "26.09GB",
                    "processedInputDataSize": "26.09GB",
                    "rawInputPositions": "440229901",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "440229901",
                    "processedInputPositions": "440229901",
                    "outputDataSize": "90.48GB",
                    "outputPositions": "440229901",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 215,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "11.92s",
                    "totalQueuedTime": "8.34m",
                    "totalScheduledTime": "21.57m",
                    "totalCpuTime": "15.04m",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "20.82GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "20.82GB",
                    "processedInputDataSize": "20.82GB",
                    "rawInputPositions": "440229901",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "440229901",
                    "processedInputPositions": "440229901",
                    "outputDataSize": "62.75GB",
                    "outputPositions": "440229901",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 215,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.slowly_adds_delta_l_1 scanned 2 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:12:00.968,  cpu: 00:00:00.043,  blocked: 00:11:59.400,  queue: 00:00:00.000,  scheduled: 00:00:01.690 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.690,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.8%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  148.0/272  elapsed: 05:24:11.030,  cpu: 00:58:06.600,  blocked: 04:19:12.000,  queue: 00:00:00.293,  scheduled: 01:03:36.000 (addInputWall: 00:37:35.076,  getOutputWall: 00:22:11.491,  finishWall: 00:03:37.326)  other: 00:01:22.737,  timeCost: 55.1%,  blocked: 80.0%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  213.5/215  elapsed: 02:15:16.150,  cpu: 00:24:22.800,  blocked: 00:58:30.000,  queue: 00:46:35.251,  scheduled: 00:30:09.600 (addInputWall: 00:13:51.600,  getOutputWall: 00:22:18.600,  finishWall: 00:00:01.850)  other: 00:00:01.299,  timeCost: 26.1%,  blocked: 43.2%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  150.5/215  elapsed: 00:29:54.496,  cpu: 00:15:02.400,  blocked: 00:00:00.000,  queue: 00:08:20.264,  scheduled: 00:21:34.200 (addInputWall: 00:11:18.600,  getOutputWall: 00:17:04.200,  finishWall: 00:00:01.420)  other: 00:00:00.032,  timeCost: 18.7%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "WARN",
                    "message": "High avg CPU usage 50.29%, the most consuming operator ScanFilterAndProjectOperator (35.48%)"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"13\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_1_l_1; tablePath=s3a://wix-bi-sunduk/baguild/3edb2e20-cac4-4360-8dc7-0cd4e89e9538; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [open_date, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(16), 8], [event_type, varchar(5), 9], [is_published, boolean, 10], [diff_instance_date, timestamp, 11], [diff_instance_reason, varchar(16), 12]], hash=823022342]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"376\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"312\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid\\nmsid := msid\\napp_id := app_id\\ninstance_id := instance_id\\nopen_date := date_created\\nwas_demo := was_demo\\ninitiator_name := initiator_name\\naction_type := action_type\\nevent_type := event_type\\nis_published := is_published\\ndiff_instance_date := min\\ndiff_instance_reason := min_by\\n\",\n  \"children\" : [ {\n    \"id\" : \"375\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"449\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"8\",\n        \"name\" : \"Aggregate(FINAL)[uuid, msid, app_id, instance_id, date_created, was_demo, initiator_name, action_type, event_type, is_published][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_83\\\")\\nmin_by := min_by(\\\"min_by_84\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"396\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"uuid\\\", \\\"msid\\\", \\\"app_id\\\", \\\"instance_id\\\", \\\"date_created\\\", \\\"was_demo\\\", \\\"initiator_name\\\", \\\"action_type\\\", \\\"event_type\\\", \\\"is_published\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"394\",\n            \"name\" : \"Aggregate(PARTIAL)[uuid, msid, app_id, instance_id, date_created, was_demo, initiator_name, action_type, event_type, is_published][$hashvalue_90]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_by_84 := min_by(\\\"action_type_0\\\", \\\"expr_25\\\")\\nmin_83 := min(\\\"expr_25\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"6\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_25 := (CASE WHEN ((\\\"date_created\\\" < \\\"date_created_2\\\") AND (\\\"instance_id\\\" <> \\\"instance_id_5\\\")) THEN \\\"date_created_2\\\" END)\\n$hashvalue_90 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"action_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"event_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"msid\\\" = \\\"msid_7\\\")][$hashvalue_85, $hashvalue_87]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"310\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"373\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_87] (\\\"app_id_1\\\", \\\"msid_7\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"311\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"447\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta_l_1', folderName='4b10cc82-524b-466d-b854-56a1ef7e4c5e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_86 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nmsid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"448\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta_l_1', folderName='4b10cc82-524b-466d-b854-56a1ef7e4c5e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_89 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_7\\\"), 0))\\naction_type_0 := [action_type, varchar(16), 0]\\ndate_created_2 := [date_created, timestamp, 2]\\ninstance_id_5 := [instance_id, varchar, 5]\\napp_id_1 := [app_id, varchar, 1]\\nmsid_7 := [msid, varchar, 7]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_020054_09547_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_1_l_2\nAS\n\n    SELECT  base.uuid\n            , base.msid\n            , base.app_id\n            , base.instance_id\n            , base.date_created AS open_date\n            , base.was_demo\n            , base.initiator_name\n            , base.action_type\n            , base.event_type\n            , base.is_published\n            , min (case when base.date_created<next_event_msid.date_created AND base.instance_id<>next_event_msid.instance_id\n                        then next_event_msid.date_created end) AS diff_instance_date\n            , min_by (next_event_msid.action_type,  case    when base.date_created<next_event_msid.date_created AND base.instance_id<>next_event_msid.instance_id\n                                                            then next_event_msid.date_created end) AS diff_instance_reason\n\n    FROM        sunduk.baguild.slowly_adds_delta_l_2                                base\n    LEFT JOIN   sunduk.baguild.slowly_adds_delta_l_2                               next_event_msid         ON  base.app_id=next_event_msid.app_id\n                                                                                                            AND base.msid=next_event_msid.msid\n    GROUP by 1,2,3,4,5,6,7,8,9,10",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_1_l_2",
            "queryStats": {
                "elapsedTime": "1.71m",
                "planningTime": "876.82ms",
                "analysisTime": "266.95ms",
                "queuedTime": "162.52us",
                "executionTime": "1.70m",
                "totalCpuTime": "28.78m",
                "rawInputDataSize": "15.43GB",
                "internalNetworkInputDataSize": "39.04GB",
                "physicalInputDataSize": "15.43GB",
                "processedInputDataSize": "15.43GB",
                "rawInputPositions": "235763404",
                "internalNetworkInputPositions": "235763420",
                "physicalInputPositions": "235763404",
                "processedInputPositions": "235763404",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "23.68GB",
                "writtenPositions": "117881702",
                "peakTotalMemoryReservation": "56.92GB",
                "peakTaskTotalMemory": "3.61GB",
                "totalSplits": 429,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta_l_2"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.69m",
                    "totalQueuedTime": "1.25ms",
                    "totalScheduledTime": "1.27s",
                    "totalCpuTime": "42.77ms",
                    "totalBlockedTime": "8.34m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "56.73s",
                    "totalQueuedTime": "312.20ms",
                    "totalScheduledTime": "20.04m",
                    "totalCpuTime": "17.35m",
                    "totalBlockedTime": "1.71h",
                    "rawInputDataSize": "39.04GB",
                    "internalNetworkInputDataSize": "39.04GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "40.95GB",
                    "rawInputPositions": "235763404",
                    "internalNetworkInputPositions": "235763404",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "235763404",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "16.33s",
                    "totalQueuedTime": "1.10m",
                    "totalScheduledTime": "8.71m",
                    "totalCpuTime": "7.08m",
                    "totalBlockedTime": "6.29m",
                    "rawInputDataSize": "9.69GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "9.69GB",
                    "processedInputDataSize": "9.69GB",
                    "rawInputPositions": "117881702",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "117881702",
                    "processedInputPositions": "117881702",
                    "outputDataSize": "24.10GB",
                    "outputPositions": "117881702",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 76,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "312.00ms",
                    "totalQueuedTime": "3.28s",
                    "totalScheduledTime": "5.92m",
                    "totalCpuTime": "4.35m",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "5.74GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "5.74GB",
                    "processedInputDataSize": "5.74GB",
                    "rawInputPositions": "117881702",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "117881702",
                    "processedInputPositions": "117881702",
                    "outputDataSize": "16.81GB",
                    "outputPositions": "117881702",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 76,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.slowly_adds_delta_l_2 scanned 2 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:08:21.910,  cpu: 00:00:00.042,  blocked: 00:08:20.400,  queue: 00:00:00.001,  scheduled: 00:00:01.270 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.272,  finishWall: 00:00:00.000)  other: 00:00:00.239,  timeCost: 0.1%,  blocked: 99.7%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  158.6/272  elapsed: 02:29:58.154,  cpu: 00:17:21.000,  blocked: 01:42:36.000,  queue: 00:00:00.312,  scheduled: 00:20:02.400 (addInputWall: 00:11:20.745,  getOutputWall: 00:06:47.991,  finishWall: 00:01:51.208)  other: 00:27:19.442,  timeCost: 57.8%,  blocked: 68.4%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2   59.2/76   elapsed: 00:16:05.992,  cpu: 00:07:04.800,  blocked: 00:06:17.400,  queue: 00:01:06.029,  scheduled: 00:08:42.600 (addInputWall: 00:04:48.600,  getOutputWall: 00:06:24.600,  finishWall: 00:00:00.664)  other: 00:00:00.000,  timeCost: 25.1%,  blocked: 39.1%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.1"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "12"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(2.36GB)/P50(30.02MB) = 80.5 times"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3 1148.9/76   elapsed: 00:05:58.459,  cpu: 00:04:20.999,  blocked: 00:00:00.000,  queue: 00:00:03.283,  scheduled: 00:05:55.200 (addInputWall: 00:02:49.800,  getOutputWall: 00:04:34.800,  finishWall: 00:00:00.519)  other: 00:00:00.000,  timeCost: 17.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "taskId": "0"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(1.42GB)/P50(0B) = Infinity times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"13\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_1_l_2; tablePath=s3a://wix-bi-sunduk/baguild/f30a9e84-0301-44af-aec5-e4e0a6836a40; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [open_date, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [action_type, varchar(16), 8], [event_type, varchar(5), 9], [is_published, boolean, 10], [diff_instance_date, timestamp, 11], [diff_instance_reason, varchar(16), 12]], hash=-1362966093]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"376\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"312\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid\\nmsid := msid\\napp_id := app_id\\ninstance_id := instance_id\\nopen_date := date_created\\nwas_demo := was_demo\\ninitiator_name := initiator_name\\naction_type := action_type\\nevent_type := event_type\\nis_published := is_published\\ndiff_instance_date := min\\ndiff_instance_reason := min_by\\n\",\n  \"children\" : [ {\n    \"id\" : \"375\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"449\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"8\",\n        \"name\" : \"Aggregate(FINAL)[uuid, msid, app_id, instance_id, date_created, was_demo, initiator_name, action_type, event_type, is_published][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_83\\\")\\nmin_by := min_by(\\\"min_by_84\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"396\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"uuid\\\", \\\"msid\\\", \\\"app_id\\\", \\\"instance_id\\\", \\\"date_created\\\", \\\"was_demo\\\", \\\"initiator_name\\\", \\\"action_type\\\", \\\"event_type\\\", \\\"is_published\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"394\",\n            \"name\" : \"Aggregate(PARTIAL)[uuid, msid, app_id, instance_id, date_created, was_demo, initiator_name, action_type, event_type, is_published][$hashvalue_90]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_by_84 := min_by(\\\"action_type_0\\\", \\\"expr_25\\\")\\nmin_83 := min(\\\"expr_25\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"6\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_25 := (CASE WHEN ((\\\"date_created\\\" < \\\"date_created_2\\\") AND (\\\"instance_id\\\" <> \\\"instance_id_5\\\")) THEN \\\"date_created_2\\\" END)\\n$hashvalue_90 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"date_created\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"action_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"event_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"msid\\\" = \\\"msid_7\\\")][$hashvalue_85, $hashvalue_87]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"310\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"373\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_87] (\\\"app_id_1\\\", \\\"msid_7\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"311\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"447\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta_l_2', folderName='94f3c825-73c8-454e-adcb-8aee0e31ce49', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_86 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nmsid := [msid, varchar, 7]\\ninstance_id := [instance_id, varchar, 5]\\nevent_type := [event_type, varchar(5), 3]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 9]\\nis_published := [is_published, boolean, 6]\\ndate_created := [date_created, timestamp, 2]\\ninitiator_name := [initiator_name, varchar, 4]\\nuuid := [uuid, varchar, 8]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"448\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta_l_2', folderName='94f3c825-73c8-454e-adcb-8aee0e31ce49', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_89 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_7\\\"), 0))\\naction_type_0 := [action_type, varchar(16), 0]\\ndate_created_2 := [date_created, timestamp, 2]\\ninstance_id_5 := [instance_id, varchar, 5]\\napp_id_1 := [app_id, varchar, 1]\\nmsid_7 := [msid, varchar, 7]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_020237_09859_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_1\nAS\nselect * from sunduk.baguild.slowly_log_raw_delta_1_f\nunion all\nselect * from sunduk.baguild.slowly_log_raw_delta_1_l_1\nunion all\nselect * from sunduk.baguild.slowly_log_raw_delta_1_l_2",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_1",
            "queryStats": {
                "elapsedTime": "7.75m",
                "planningTime": "1.31s",
                "analysisTime": "381.59ms",
                "queuedTime": "2.91ms",
                "executionTime": "7.75m",
                "totalCpuTime": "1.30h",
                "rawInputDataSize": "41.10GB",
                "internalNetworkInputDataSize": "183.30GB",
                "physicalInputDataSize": "41.10GB",
                "processedInputDataSize": "192.74GB",
                "rawInputPositions": "955463175",
                "internalNetworkInputPositions": "955463191",
                "physicalInputPositions": "955463175",
                "processedInputPositions": "955463175",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "192.83GB",
                "writtenPositions": "955463175",
                "peakTotalMemoryReservation": "6.03GB",
                "peakTaskTotalMemory": "215.42MB",
                "totalSplits": 517,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_log_raw_delta_1_f",
                    "sunduk.baguild.slowly_log_raw_delta_1_l_1",
                    "sunduk.baguild.slowly_log_raw_delta_1_l_2"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "7.72m",
                    "totalQueuedTime": "1.31ms",
                    "totalScheduledTime": "1.16s",
                    "totalCpuTime": "61.68ms",
                    "totalBlockedTime": "38.53m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "6.87m",
                    "totalQueuedTime": "19.60s",
                    "totalScheduledTime": "42.15m",
                    "totalCpuTime": "35.33m",
                    "totalBlockedTime": "3.19h",
                    "rawInputDataSize": "183.30GB",
                    "internalNetworkInputDataSize": "183.30GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "192.83GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "955463175",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 80,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "6.30m",
                    "totalQueuedTime": "2.78h",
                    "totalScheduledTime": "24.01m",
                    "totalCpuTime": "17.56m",
                    "totalBlockedTime": "10.00h",
                    "rawInputDataSize": "14.52GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "14.52GB",
                    "processedInputDataSize": "80.31GB",
                    "rawInputPositions": "397351572",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "397351572",
                    "processedInputPositions": "397351572",
                    "outputDataSize": "80.31GB",
                    "outputPositions": "397351572",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 176,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "6.30m",
                    "totalQueuedTime": "3.62h",
                    "totalScheduledTime": "26.62m",
                    "totalCpuTime": "19.63m",
                    "totalBlockedTime": "10.59h",
                    "rawInputDataSize": "25.84GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "25.84GB",
                    "processedInputDataSize": "88.77GB",
                    "rawInputPositions": "440229901",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "440229901",
                    "processedInputPositions": "440229901",
                    "outputDataSize": "88.77GB",
                    "outputPositions": "440229901",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 192,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "6.29m",
                    "totalQueuedTime": "16.04s",
                    "totalScheduledTime": "6.76m",
                    "totalCpuTime": "5.23m",
                    "totalBlockedTime": "2.55h",
                    "rawInputDataSize": "760.54MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "760.54MB",
                    "processedInputDataSize": "23.66GB",
                    "rawInputPositions": "117881702",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "117881702",
                    "processedInputPositions": "117881702",
                    "outputDataSize": "23.66GB",
                    "outputPositions": "117881702",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 64,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:38:32.740,  cpu: 00:00:00.061,  blocked: 00:38:31.800,  queue: 00:00:00.001,  scheduled: 00:00:01.160 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.160,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 100.0%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   77.0/80   elapsed: 08:49:25.126,  cpu: 00:35:19.800,  blocked: 03:11:24.000,  queue: 00:00:19.599,  scheduled: 00:42:09.000 (addInputWall: 00:35:03.001,  getOutputWall: 00:00:30.960,  finishWall: 00:06:31.800)  other: 04:55:32.527,  timeCost: 42.3%,  blocked: 36.2%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "taskId": "9"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(26.24GB)/P50(10.38GB) = 2.5 times"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  150.2/176  elapsed: 15:45:44.332,  cpu: 00:17:33.600,  blocked: 10:00:00.000,  queue: 02:46:43.859,  scheduled: 00:24:00.600 (addInputWall: 00:05:21.600,  getOutputWall: 00:22:44.400,  finishWall: 00:00:00.001)  other: 02:34:59.872,  timeCost: 24.1%,  blocked: 63.4%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  167.4/192  elapsed: 17:35:31.180,  cpu: 00:19:37.800,  blocked: 10:35:24.000,  queue: 03:37:21.322,  scheduled: 00:26:37.200 (addInputWall: 00:09:03.000,  getOutputWall: 00:25:11.400,  finishWall: 00:00:00.001)  other: 02:56:08.658,  timeCost: 26.7%,  blocked: 60.2%"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4   30.7/64   elapsed: 03:12:59.474,  cpu: 00:05:13.800,  blocked: 02:33:00.000,  queue: 00:00:16.042,  scheduled: 00:06:45.600 (addInputWall: 00:00:36.400,  getOutputWall: 00:06:23.400,  finishWall: 00:00:00.000)  other: 00:32:57.832,  timeCost: 6.8%,  blocked: 79.3%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "taskId": "21"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(630MB)/P50(0B) = Infinity times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"13\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_1; tablePath=s3a://wix-bi-sunduk/baguild/021270f4-fbee-48c3-a6e8-7c36522ba71e; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [diff_instance_date, timestamp, 3], [diff_instance_reason, varchar(16), 4], [event_type, varchar(5), 5], [initiator_name, varchar, 6], [instance_id, varchar, 7], [is_published, boolean, 8], [msid, varchar, 9], [open_date, timestamp, 10], [uuid, varchar, 11], [was_demo, boolean, 12]], hash=1355172961]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"319\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"275\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := expr_107\\napp_id := expr_108\\ndiff_instance_date := expr_109\\ndiff_instance_reason := expr_110\\nevent_type := expr_111\\ninitiator_name := expr_112\\ninstance_id := expr_113\\nis_published := expr_114\\nmsid := expr_115\\nopen_date := expr_116\\nuuid := expr_117\\nwas_demo := expr_118\\n\",\n  \"children\" : [ {\n    \"id\" : \"318\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"274\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[2,3,4]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"2\", \"3\", \"4\" ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"0\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_1_f', folderName='9a76bf3f-c884-4aeb-9eee-84a3dbdd9d60', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"open_date := [open_date, timestamp, 9]\\nmsid := [msid, varchar, 8]\\ninstance_id := [instance_id, varchar, 6]\\nevent_type := [event_type, varchar(5), 4]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 11]\\nis_published := [is_published, boolean, 7]\\ninitiator_name := [initiator_name, varchar, 5]\\ndiff_instance_date := [diff_instance_date, timestamp, 2]\\nuuid := [uuid, varchar, 10]\\ndiff_instance_reason := [diff_instance_reason, varchar(16), 3]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"3\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_1_l_1', folderName='3edb2e20-cac4-4360-8dc7-0cd4e89e9538', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"event_type_27 := [event_type, varchar(5), 4]\\nuuid_33 := [uuid, varchar, 10]\\ninitiator_name_28 := [initiator_name, varchar, 5]\\nis_published_30 := [is_published, boolean, 7]\\nopen_date_32 := [open_date, timestamp, 9]\\napp_id_24 := [app_id, varchar, 1]\\nmsid_31 := [msid, varchar, 8]\\ndiff_instance_reason_26 := [diff_instance_reason, varchar(16), 3]\\naction_type_23 := [action_type, varchar(16), 0]\\nwas_demo_34 := [was_demo, boolean, 11]\\ninstance_id_29 := [instance_id, varchar, 6]\\ndiff_instance_date_25 := [diff_instance_date, timestamp, 2]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_1_l_2', folderName='f30a9e84-0301-44af-aec5-e4e0a6836a40', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"is_published_78 := [is_published, boolean, 7]\\ninstance_id_77 := [instance_id, varchar, 6]\\naction_type_71 := [action_type, varchar(16), 0]\\ndiff_instance_date_73 := [diff_instance_date, timestamp, 2]\\nopen_date_80 := [open_date, timestamp, 9]\\ninitiator_name_76 := [initiator_name, varchar, 5]\\nuuid_81 := [uuid, varchar, 10]\\nmsid_79 := [msid, varchar, 8]\\nevent_type_75 := [event_type, varchar(5), 4]\\nwas_demo_82 := [was_demo, boolean, 11]\\ndiff_instance_reason_74 := [diff_instance_reason, varchar(16), 3]\\napp_id_72 := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_021112_10832_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_2_short_1 \nAS\n\nSELECT  base.app_id\n        , base.instance_id\n        , base.open_date\n        , base.uuid\n            , min (case when base.open_date<next_event_instance.date_created AND base.msid<>next_event_instance.msid\n                        then next_event_instance.date_created end) AS diff_msid_date\n            , min_by (next_event_instance.action_type,  case    when base.open_date<next_event_instance.date_created AND base.msid<>next_event_instance.msid\n                                                            then next_event_instance.date_created end) AS diff_msid_reason\n            , min (case when base.open_date<next_event_instance.date_created AND base.msid=next_event_instance.msid AND base.uuid<>next_event_instance.uuid\n                        then next_event_instance.date_created end) AS diff_uuid_date\n            , min_by (next_event_instance.action_type,  case    when base.open_date<next_event_instance.date_created AND base.msid=next_event_instance.msid AND base.uuid<>next_event_instance.uuid\n                                                                then next_event_instance.date_created end) AS diff_uuid_reason\n    FROM        sunduk.baguild.slowly_log_raw_delta_1           base\n    LEFT JOIN   sunduk.baguild.slowly_adds_delta                next_event_instance     ON  base.app_id=next_event_instance.app_id \n                                                                                            AND base.instance_id=next_event_instance.instance_id\n    where base.app_id in ('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e'\n                          ,'139ef4fa-c108-8f9a-c7be-d5f492a2c939'\n                          ,'141fbfae-511e-6817-c9f0-48993a7547d1'\n                          ,'1480c568-5cbd-9392-5604-1148f5faffa0'\n                          ,'13ee94c1-b635-8505-3391-97919052c16f'\n                          ,'14bca956-e09f-f4d6-14d7-466cb3f09103'\n                          ,'150ae7ee-c74a-eecd-d3d7-2112895b988a')\n        GROUP by 1,2,3,4",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_2_short_1",
            "queryStats": {
                "elapsedTime": "5.48m",
                "planningTime": "1.12s",
                "analysisTime": "285.45ms",
                "queuedTime": "12.79s",
                "executionTime": "5.27m",
                "totalCpuTime": "1.70h",
                "rawInputDataSize": "71.38GB",
                "internalNetworkInputDataSize": "124.48GB",
                "physicalInputDataSize": "71.38GB",
                "processedInputDataSize": "71.38GB",
                "rawInputPositions": "1910926350",
                "internalNetworkInputPositions": "736043010",
                "physicalInputPositions": "1910926350",
                "processedInputPositions": "1910926350",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "49.28GB",
                "writtenPositions": "368021497",
                "peakTotalMemoryReservation": "164.71GB",
                "peakTaskTotalMemory": "10.33GB",
                "totalSplits": 1134,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta",
                    "sunduk.baguild.slowly_log_raw_delta_1"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "5.25m",
                    "totalQueuedTime": "1.35ms",
                    "totalScheduledTime": "832.63ms",
                    "totalCpuTime": "24.84ms",
                    "totalBlockedTime": "26.18m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "4.85m",
                    "totalQueuedTime": "16.57m",
                    "totalScheduledTime": "42.28m",
                    "totalCpuTime": "38.97m",
                    "totalBlockedTime": "12.79h",
                    "rawInputDataSize": "124.48GB",
                    "internalNetworkInputDataSize": "124.48GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "128.94GB",
                    "rawInputPositions": "736042994",
                    "internalNetworkInputPositions": "736042994",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "736042994",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "4.42m",
                    "totalQueuedTime": "14.81h",
                    "totalScheduledTime": "46.63m",
                    "totalCpuTime": "31.07m",
                    "totalBlockedTime": "5.59h",
                    "rawInputDataSize": "34.66GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "34.66GB",
                    "processedInputDataSize": "34.66GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "62.41GB",
                    "outputPositions": "368021497",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 425,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "1.08m",
                    "totalQueuedTime": "3.15h",
                    "totalScheduledTime": "49.16m",
                    "totalCpuTime": "32.09m",
                    "totalBlockedTime": "47.85m",
                    "rawInputDataSize": "36.72GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "36.72GB",
                    "processedInputDataSize": "36.72GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "66.52GB",
                    "outputPositions": "368021497",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 432,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:26:11.376,  cpu: 00:00:00.024,  blocked: 00:26:10.800,  queue: 00:00:00.001,  scheduled: 00:00:00.832 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.831,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 100.0%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  213.9/272  elapsed: 17:17:11.941,  cpu: 00:38:58.200,  blocked: 12:47:24.000,  queue: 00:16:34.094,  scheduled: 00:42:16.800 (addInputWall: 00:19:45.079,  getOutputWall: 00:19:21.791,  finishWall: 00:03:06.171)  other: 03:30:57.046,  timeCost: 30.6%,  blocked: 74.0%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  328.2/425  elapsed: 24:11:26.817,  cpu: 00:31:04.200,  blocked: 05:35:24.000,  queue: 14:48:40.111,  scheduled: 00:46:37.800 (addInputWall: 00:12:57.600,  getOutputWall: 00:42:32.400,  finishWall: 00:00:02.950)  other: 03:00:44.906,  timeCost: 33.8%,  blocked: 23.1%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  299.9/432  elapsed: 05:23:10.237,  cpu: 00:32:05.400,  blocked: 00:47:51.000,  queue: 03:09:01.691,  scheduled: 00:49:09.600 (addInputWall: 00:13:36.600,  getOutputWall: 00:45:09.000,  finishWall: 00:00:02.940)  other: 00:37:07.945,  timeCost: 35.6%,  blocked: 14.8%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"16\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"14\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_2_short_1; tablePath=s3a://wix-bi-sunduk/baguild/1cd9c1b3-8605-4fb8-9a05-bf796a556314; columnHandles=[[app_id, varchar, 1], [instance_id, varchar, 2], [open_date, timestamp, 3], [uuid, varchar, 4], [diff_msid_date, timestamp, 5], [diff_msid_reason, varchar(16), 6], [diff_uuid_date, timestamp, 7], [diff_uuid_reason, varchar(16), 8]], hash=1230343989]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"483\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"403\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\ninstance_id := instance_id\\nopen_date := open_date\\nuuid := uuid\\ndiff_msid_date := min\\ndiff_msid_reason := min_by\\ndiff_uuid_date := min_25\\ndiff_uuid_reason := min_by_26\\n\",\n  \"children\" : [ {\n    \"id\" : \"482\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"564\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"9\",\n        \"name\" : \"Aggregate(FINAL)[app_id, instance_id, open_date, uuid][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_59\\\")\\nmin_by_26 := min_by(\\\"min_by_62\\\")\\nmin_25 := min(\\\"min_61\\\")\\nmin_by := min_by(\\\"min_by_60\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"505\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"app_id\\\", \\\"instance_id\\\", \\\"open_date\\\", \\\"uuid\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"503\",\n            \"name\" : \"Aggregate(PARTIAL)[app_id, instance_id, open_date, uuid][$hashvalue_68]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_by_60 := min_by(\\\"action_type_0\\\", \\\"expr_18\\\")\\nmin_by_62 := min_by(\\\"action_type_0\\\", \\\"expr_21\\\")\\nmin_61 := min(\\\"expr_21\\\")\\nmin_59 := min(\\\"expr_18\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"7\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_18 := (CASE WHEN ((\\\"open_date\\\" < \\\"date_created\\\") AND (\\\"msid\\\" <> \\\"msid_6\\\")) THEN \\\"date_created\\\" END)\\nexpr_21 := (CASE WHEN (((\\\"open_date\\\" < \\\"date_created\\\") AND (\\\"msid\\\" = \\\"msid_6\\\")) AND (\\\"uuid\\\" <> \\\"uuid_7\\\")) THEN \\\"date_created\\\" END)\\n$hashvalue_68 := combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"instance_id\\\" = \\\"instance_id_4\\\")][$hashvalue_63, $hashvalue_65]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"401\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"480\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_65] (\\\"app_id_1\\\", \\\"instance_id_4\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"402\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"562\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_1', folderName='021270f4-fbee-48c3-a6e8-7c36522ba71e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar)))]\",\n  \"details\" : \"$hashvalue_64 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0))\\nopen_date := [open_date, timestamp, 9]\\nmsid := [msid, varchar, 8]\\ninstance_id := [instance_id, varchar, 6]\\nuuid := [uuid, varchar, 10]\\napp_id := [app_id, varchar, 1]\\n    :: [[135c3d92-0fea-1f9d-2ba5-2a1dfb04297e], [139ef4fa-c108-8f9a-c7be-d5f492a2c939], [13ee94c1-b635-8505-3391-97919052c16f], [141fbfae-511e-6817-c9f0-48993a7547d1], [1480c568-5cbd-9392-5604-1148f5faffa0], [14bca956-e09f-f4d6-14d7-466cb3f09103], [150ae7ee-c74a-eecd-d3d7-2112895b988a]]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"563\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta', folderName='f48d4df5-706e-4162-869d-cfb4f8a72f30', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id_1\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar)))]\",\n  \"details\" : \"$hashvalue_67 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_4\\\"), 0))\\naction_type_0 := [action_type, varchar(16), 0]\\ndate_created := [date_created, timestamp, 2]\\ninstance_id_4 := [instance_id, varchar, 5]\\nuuid_7 := [uuid, varchar, 8]\\napp_id_1 := [app_id, varchar, 1]\\n    :: [[135c3d92-0fea-1f9d-2ba5-2a1dfb04297e], [139ef4fa-c108-8f9a-c7be-d5f492a2c939], [13ee94c1-b635-8505-3391-97919052c16f], [141fbfae-511e-6817-c9f0-48993a7547d1], [1480c568-5cbd-9392-5604-1148f5faffa0], [14bca956-e09f-f4d6-14d7-466cb3f09103], [150ae7ee-c74a-eecd-d3d7-2112895b988a]]\\nmsid_6 := [msid, varchar, 7]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_021641_11436_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_2_short_2 \nAS \n\nSELECT  base.app_id\n        , base.instance_id\n        , base.open_date\n        , base.uuid\n            , min (case when base.open_date<next_event_instance.date_created AND base.msid<>next_event_instance.msid\n                        then next_event_instance.date_created end) AS diff_msid_date\n            , min_by (next_event_instance.action_type,  case    when base.open_date<next_event_instance.date_created AND base.msid<>next_event_instance.msid\n                                                            then next_event_instance.date_created end) AS diff_msid_reason\n            , min (case when base.open_date<next_event_instance.date_created AND base.msid=next_event_instance.msid AND base.uuid<>next_event_instance.uuid\n                        then next_event_instance.date_created end) AS diff_uuid_date\n            , min_by (next_event_instance.action_type,  case    when base.open_date<next_event_instance.date_created AND base.msid=next_event_instance.msid AND base.uuid<>next_event_instance.uuid\n                                                                then next_event_instance.date_created end) AS diff_uuid_reason\n    FROM        sunduk.baguild.slowly_log_raw_delta_1           base\n    LEFT JOIN   sunduk.baguild.slowly_adds_delta                next_event_instance     ON  base.app_id=next_event_instance.app_id \n                                                                                            AND base.instance_id=next_event_instance.instance_id\n    where base.app_id in ('14b89688-9b25-5214-d1cb-a3fb9683618b',\n'146c0d71-352e-4464-9a03-2e868aabe7b9',\n'55cd9036-36bb-480b-8ddc-afda3cb2eb8d',\n'f123e8f1-4350-4c9b-b269-04adfadda977',\n'14517e1a-3ff0-af98-408e-2bd6953c36a2',\n'ea2821fc-7d97-40a9-9f75-772f29178430',\n'14ce1214-b278-a7e4-1373-00cebd1bef7c',\n'13aa9735-aa50-4bdb-877c-0bb46804bd71',\n'14bcded7-0066-7c35-14d7-466cb3f09103',\n'1380b703-ce81-ff05-f115-39571d94dfcd',\n'9bead16f-1c73-4cda-b6c4-28cff46988db',\n'e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b',\n'a322993b-2c74-426f-bbb8-444db73d0d1b',\n'14271d6f-ba62-d045-549b-ab972ae1f70e',\n'13d21c63-b5ec-5912-8397-c3a5ddb27a97',\n'307ba931-689c-4b55-bb1d-6a382bad9222',\n'd70b68e2-8d77-4e0c-9c00-c292d6e0025e')\n        GROUP by 1,2,3,4",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_2_short_2",
            "queryStats": {
                "elapsedTime": "2.21m",
                "planningTime": "1.08s",
                "analysisTime": "289.36ms",
                "queuedTime": "127.97us",
                "executionTime": "2.20m",
                "totalCpuTime": "2.02h",
                "rawInputDataSize": "130GB",
                "internalNetworkInputDataSize": "148.96GB",
                "physicalInputDataSize": "130GB",
                "processedInputDataSize": "130GB",
                "rawInputPositions": "1910926350",
                "internalNetworkInputPositions": "880459818",
                "physicalInputPositions": "1910926350",
                "processedInputPositions": "1910926350",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "59.20GB",
                "writtenPositions": "440229901",
                "peakTotalMemoryReservation": "204.87GB",
                "peakTaskTotalMemory": "12.90GB",
                "totalSplits": 1134,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta",
                    "sunduk.baguild.slowly_log_raw_delta_1"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.18m",
                    "totalQueuedTime": "1.05ms",
                    "totalScheduledTime": "717.41ms",
                    "totalCpuTime": "34.74ms",
                    "totalBlockedTime": "10.86m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "1.92m",
                    "totalQueuedTime": "17.85s",
                    "totalScheduledTime": "58.46m",
                    "totalCpuTime": "52.56m",
                    "totalBlockedTime": "4.11h",
                    "rawInputDataSize": "148.96GB",
                    "internalNetworkInputDataSize": "148.96GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "154.24GB",
                    "rawInputPositions": "880459802",
                    "internalNetworkInputPositions": "880459802",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "880459802",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "1.29m",
                    "totalQueuedTime": "2.79h",
                    "totalScheduledTime": "49.51m",
                    "totalCpuTime": "34.29m",
                    "totalBlockedTime": "1.76h",
                    "rawInputDataSize": "51.99GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "51.99GB",
                    "processedInputDataSize": "51.99GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "74.61GB",
                    "outputPositions": "440229901",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 425,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "26.81s",
                    "totalQueuedTime": "49.72m",
                    "totalScheduledTime": "54.19m",
                    "totalCpuTime": "34.51m",
                    "totalBlockedTime": "525.77ms",
                    "rawInputDataSize": "78.01GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "78.01GB",
                    "processedInputDataSize": "78.01GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "79.58GB",
                    "outputPositions": "440229901",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 432,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:10:52.226,  cpu: 00:00:00.034,  blocked: 00:10:51.600,  queue: 00:00:00.001,  scheduled: 00:00:00.717 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.715,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  174.1/272  elapsed: 05:34:21.227,  cpu: 00:52:33.600,  blocked: 04:06:36.000,  queue: 00:00:17.852,  scheduled: 00:58:27.600 (addInputWall: 00:27:22.587,  getOutputWall: 00:27:17.074,  finishWall: 00:03:38.675)  other: 00:28:59.774,  timeCost: 36.0%,  blocked: 73.8%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  250.9/425  elapsed: 05:24:03.790,  cpu: 00:34:17.400,  blocked: 01:45:36.000,  queue: 02:47:06.067,  scheduled: 00:49:30.600 (addInputWall: 00:21:50.400,  getOutputWall: 00:44:00.000,  finishWall: 00:00:02.940)  other: 00:01:51.122,  timeCost: 30.5%,  blocked: 32.6%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  234.9/432  elapsed: 01:44:55.771,  cpu: 00:34:30.599,  blocked: 00:00:00.525,  queue: 00:49:43.194,  scheduled: 00:54:11.400 (addInputWall: 00:29:42.600,  getOutputWall: 00:49:07.200,  finishWall: 00:00:03.090)  other: 00:01:00.651,  timeCost: 33.4%,  blocked: 0.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"16\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"14\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_2_short_2; tablePath=s3a://wix-bi-sunduk/baguild/7d95a1ee-3bbe-4884-b8b4-cb99f4a25545; columnHandles=[[app_id, varchar, 1], [instance_id, varchar, 2], [open_date, timestamp, 3], [uuid, varchar, 4], [diff_msid_date, timestamp, 5], [diff_msid_reason, varchar(16), 6], [diff_uuid_date, timestamp, 7], [diff_uuid_reason, varchar(16), 8]], hash=-1475675865]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"483\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"403\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\ninstance_id := instance_id\\nopen_date := open_date\\nuuid := uuid\\ndiff_msid_date := min\\ndiff_msid_reason := min_by\\ndiff_uuid_date := min_25\\ndiff_uuid_reason := min_by_26\\n\",\n  \"children\" : [ {\n    \"id\" : \"482\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"564\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"9\",\n        \"name\" : \"Aggregate(FINAL)[app_id, instance_id, open_date, uuid][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_59\\\")\\nmin_by_26 := min_by(\\\"min_by_62\\\")\\nmin_25 := min(\\\"min_61\\\")\\nmin_by := min_by(\\\"min_by_60\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"505\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"app_id\\\", \\\"instance_id\\\", \\\"open_date\\\", \\\"uuid\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"503\",\n            \"name\" : \"Aggregate(PARTIAL)[app_id, instance_id, open_date, uuid][$hashvalue_68]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_by_60 := min_by(\\\"action_type_0\\\", \\\"expr_18\\\")\\nmin_by_62 := min_by(\\\"action_type_0\\\", \\\"expr_21\\\")\\nmin_61 := min(\\\"expr_21\\\")\\nmin_59 := min(\\\"expr_18\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"7\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_18 := (CASE WHEN ((\\\"open_date\\\" < \\\"date_created\\\") AND (\\\"msid\\\" <> \\\"msid_6\\\")) THEN \\\"date_created\\\" END)\\nexpr_21 := (CASE WHEN (((\\\"open_date\\\" < \\\"date_created\\\") AND (\\\"msid\\\" = \\\"msid_6\\\")) AND (\\\"uuid\\\" <> \\\"uuid_7\\\")) THEN \\\"date_created\\\" END)\\n$hashvalue_68 := combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"instance_id\\\" = \\\"instance_id_4\\\")][$hashvalue_63, $hashvalue_65]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"401\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"480\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_65] (\\\"app_id_1\\\", \\\"instance_id_4\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"402\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"562\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_1', folderName='021270f4-fbee-48c3-a6e8-7c36522ba71e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id\\\" IN (CAST('1380b703-ce81-ff05-f115-39571d94dfcd' AS varchar), CAST('13aa9735-aa50-4bdb-877c-0bb46804bd71' AS varchar), CAST('13d21c63-b5ec-5912-8397-c3a5ddb27a97' AS varchar), CAST('14271d6f-ba62-d045-549b-ab972ae1f70e' AS varchar), CAST('14517e1a-3ff0-af98-408e-2bd6953c36a2' AS varchar), CAST('146c0d71-352e-4464-9a03-2e868aabe7b9' AS varchar), CAST('14b89688-9b25-5214-d1cb-a3fb9683618b' AS varchar), CAST('14bcded7-0066-7c35-14d7-466cb3f09103' AS varchar), CAST('14ce1214-b278-a7e4-1373-00cebd1bef7c' AS varchar), CAST('307ba931-689c-4b55-bb1d-6a382bad9222' AS varchar), CAST('55cd9036-36bb-480b-8ddc-afda3cb2eb8d' AS varchar), CAST('9bead16f-1c73-4cda-b6c4-28cff46988db' AS varchar), CAST('a322993b-2c74-426f-bbb8-444db73d0d1b' AS varchar), CAST('d70b68e2-8d77-4e0c-9c00-c292d6e0025e' AS varchar), CAST('e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b' AS varchar), CAST('ea2821fc-7d97-40a9-9f75-772f29178430' AS varchar), CAST('f123e8f1-4350-4c9b-b269-04adfadda977' AS varchar)))]\",\n  \"details\" : \"$hashvalue_64 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0))\\nopen_date := [open_date, timestamp, 9]\\nmsid := [msid, varchar, 8]\\ninstance_id := [instance_id, varchar, 6]\\nuuid := [uuid, varchar, 10]\\napp_id := [app_id, varchar, 1]\\n    :: [[1380b703-ce81-ff05-f115-39571d94dfcd], [13aa9735-aa50-4bdb-877c-0bb46804bd71], [13d21c63-b5ec-5912-8397-c3a5ddb27a97], [14271d6f-ba62-d045-549b-ab972ae1f70e], [14517e1a-3ff0-af98-408e-2bd6953c36a2], [146c0d71-352e-4464-9a03-2e868aabe7b9], [14b89688-9b25-5214-d1cb-a3fb9683618b], [14bcded7-0066-7c35-14d7-466cb3f09103], [14ce1214-b278-a7e4-1373-00cebd1bef7c], [307ba931-689c-4b55-bb1d-6a382bad9222], [55cd9036-36bb-480b-8ddc-afda3cb2eb8d], [9bead16f-1c73-4cda-b6c4-28cff46988db], [a322993b-2c74-426f-bbb8-444db73d0d1b], [d70b68e2-8d77-4e0c-9c00-c292d6e0025e], [e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b], [ea2821fc-7d97-40a9-9f75-772f29178430], [f123e8f1-4350-4c9b-b269-04adfadda977]]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"563\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta', folderName='f48d4df5-706e-4162-869d-cfb4f8a72f30', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id_1\\\" IN (CAST('1380b703-ce81-ff05-f115-39571d94dfcd' AS varchar), CAST('13aa9735-aa50-4bdb-877c-0bb46804bd71' AS varchar), CAST('13d21c63-b5ec-5912-8397-c3a5ddb27a97' AS varchar), CAST('14271d6f-ba62-d045-549b-ab972ae1f70e' AS varchar), CAST('14517e1a-3ff0-af98-408e-2bd6953c36a2' AS varchar), CAST('146c0d71-352e-4464-9a03-2e868aabe7b9' AS varchar), CAST('14b89688-9b25-5214-d1cb-a3fb9683618b' AS varchar), CAST('14bcded7-0066-7c35-14d7-466cb3f09103' AS varchar), CAST('14ce1214-b278-a7e4-1373-00cebd1bef7c' AS varchar), CAST('307ba931-689c-4b55-bb1d-6a382bad9222' AS varchar), CAST('55cd9036-36bb-480b-8ddc-afda3cb2eb8d' AS varchar), CAST('9bead16f-1c73-4cda-b6c4-28cff46988db' AS varchar), CAST('a322993b-2c74-426f-bbb8-444db73d0d1b' AS varchar), CAST('d70b68e2-8d77-4e0c-9c00-c292d6e0025e' AS varchar), CAST('e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b' AS varchar), CAST('ea2821fc-7d97-40a9-9f75-772f29178430' AS varchar), CAST('f123e8f1-4350-4c9b-b269-04adfadda977' AS varchar)))]\",\n  \"details\" : \"$hashvalue_67 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_4\\\"), 0))\\naction_type_0 := [action_type, varchar(16), 0]\\ndate_created := [date_created, timestamp, 2]\\ninstance_id_4 := [instance_id, varchar, 5]\\nuuid_7 := [uuid, varchar, 8]\\napp_id_1 := [app_id, varchar, 1]\\n    :: [[1380b703-ce81-ff05-f115-39571d94dfcd], [13aa9735-aa50-4bdb-877c-0bb46804bd71], [13d21c63-b5ec-5912-8397-c3a5ddb27a97], [14271d6f-ba62-d045-549b-ab972ae1f70e], [14517e1a-3ff0-af98-408e-2bd6953c36a2], [146c0d71-352e-4464-9a03-2e868aabe7b9], [14b89688-9b25-5214-d1cb-a3fb9683618b], [14bcded7-0066-7c35-14d7-466cb3f09103], [14ce1214-b278-a7e4-1373-00cebd1bef7c], [307ba931-689c-4b55-bb1d-6a382bad9222], [55cd9036-36bb-480b-8ddc-afda3cb2eb8d], [9bead16f-1c73-4cda-b6c4-28cff46988db], [a322993b-2c74-426f-bbb8-444db73d0d1b], [d70b68e2-8d77-4e0c-9c00-c292d6e0025e], [e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b], [ea2821fc-7d97-40a9-9f75-772f29178430], [f123e8f1-4350-4c9b-b269-04adfadda977]]\\nmsid_6 := [msid, varchar, 7]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_021853_11699_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_2_short_3 \nAS \n\nSELECT  base.app_id\n        , base.instance_id\n        , base.open_date\n        , base.uuid\n            , min (case when base.open_date<next_event_instance.date_created AND base.msid<>next_event_instance.msid\n                        then next_event_instance.date_created end) AS diff_msid_date\n            , min_by (next_event_instance.action_type,  case    when base.open_date<next_event_instance.date_created AND base.msid<>next_event_instance.msid\n                                                            then next_event_instance.date_created end) AS diff_msid_reason\n            , min (case when base.open_date<next_event_instance.date_created AND base.msid=next_event_instance.msid AND base.uuid<>next_event_instance.uuid\n                        then next_event_instance.date_created end) AS diff_uuid_date\n            , min_by (next_event_instance.action_type,  case    when base.open_date<next_event_instance.date_created AND base.msid=next_event_instance.msid AND base.uuid<>next_event_instance.uuid\n                                                                then next_event_instance.date_created end) AS diff_uuid_reason\n    FROM        sunduk.baguild.slowly_log_raw_delta_1           base\n    LEFT JOIN   sunduk.baguild.slowly_adds_delta                next_event_instance     ON  base.app_id=next_event_instance.app_id \n                                                                                            AND base.instance_id=next_event_instance.instance_id\n    where base.app_id not in ('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e', '139ef4fa-c108-8f9a-c7be-d5f492a2c939', '141fbfae-511e-6817-c9f0-48993a7547d1'\n                , '1480c568-5cbd-9392-5604-1148f5faffa0', '13ee94c1-b635-8505-3391-97919052c16f', '14bca956-e09f-f4d6-14d7-466cb3f09103'\n                , '150ae7ee-c74a-eecd-d3d7-2112895b988a', '1375baa8-8eca-5659-ce9d-455b2009250d','14b89688-9b25-5214-d1cb-a3fb9683618b',\n'146c0d71-352e-4464-9a03-2e868aabe7b9',\n'55cd9036-36bb-480b-8ddc-afda3cb2eb8d',\n'f123e8f1-4350-4c9b-b269-04adfadda977',\n'14517e1a-3ff0-af98-408e-2bd6953c36a2',\n'ea2821fc-7d97-40a9-9f75-772f29178430',\n'14ce1214-b278-a7e4-1373-00cebd1bef7c',\n'13aa9735-aa50-4bdb-877c-0bb46804bd71',\n'14bcded7-0066-7c35-14d7-466cb3f09103',\n'1380b703-ce81-ff05-f115-39571d94dfcd',\n'9bead16f-1c73-4cda-b6c4-28cff46988db',\n'e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b',\n'a322993b-2c74-426f-bbb8-444db73d0d1b',\n'14271d6f-ba62-d045-549b-ab972ae1f70e',\n'13d21c63-b5ec-5912-8397-c3a5ddb27a97',\n'307ba931-689c-4b55-bb1d-6a382bad9222',\n'd70b68e2-8d77-4e0c-9c00-c292d6e0025e')\n        GROUP by 1,2,3,4",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_2_short_3",
            "queryStats": {
                "elapsedTime": "2.00m",
                "planningTime": "1.59s",
                "analysisTime": "274.52ms",
                "queuedTime": "1.93ms",
                "executionTime": "1.99m",
                "totalCpuTime": "1.24h",
                "rawInputDataSize": "177.23GB",
                "internalNetworkInputDataSize": "39.84GB",
                "physicalInputDataSize": "177.23GB",
                "processedInputDataSize": "177.23GB",
                "rawInputPositions": "1910926350",
                "internalNetworkInputPositions": "235763420",
                "physicalInputPositions": "1910926350",
                "processedInputPositions": "1910926350",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "15.89GB",
                "writtenPositions": "117881702",
                "peakTotalMemoryReservation": "54.80GB",
                "peakTaskTotalMemory": "3.43GB",
                "totalSplits": 1134,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_adds_delta",
                    "sunduk.baguild.slowly_log_raw_delta_1"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.97m",
                    "totalQueuedTime": "1.05ms",
                    "totalScheduledTime": "740.67ms",
                    "totalCpuTime": "26.95ms",
                    "totalBlockedTime": "9.77m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "1.18m",
                    "totalQueuedTime": "246.23ms",
                    "totalScheduledTime": "16.31m",
                    "totalCpuTime": "13.79m",
                    "totalBlockedTime": "3.60h",
                    "rawInputDataSize": "39.84GB",
                    "internalNetworkInputDataSize": "39.84GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "41.28GB",
                    "rawInputPositions": "235763404",
                    "internalNetworkInputPositions": "235763404",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "235763404",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "50.49s",
                    "totalQueuedTime": "2.44h",
                    "totalScheduledTime": "42.40m",
                    "totalCpuTime": "31.17m",
                    "totalBlockedTime": "1.13h",
                    "rawInputDataSize": "99.28GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "99.28GB",
                    "processedInputDataSize": "99.28GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "19.98GB",
                    "outputPositions": "117881702",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 425,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "21.31s",
                    "totalQueuedTime": "41.63m",
                    "totalScheduledTime": "42.96m",
                    "totalCpuTime": "29.52m",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "77.95GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "77.95GB",
                    "processedInputDataSize": "77.95GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "21.31GB",
                    "outputPositions": "117881702",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 432,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:09:47.145,  cpu: 00:00:00.026,  blocked: 00:09:46.200,  queue: 00:00:00.001,  scheduled: 00:00:00.740 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.739,  finishWall: 00:00:00.000)  other: 00:00:00.203,  timeCost: 0.0%,  blocked: 99.8%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  212.1/272  elapsed: 04:09:46.356,  cpu: 00:13:47.400,  blocked: 03:36:00.000,  queue: 00:00:00.246,  scheduled: 00:16:18.599 (addInputWall: 00:07:03.992,  getOutputWall: 00:07:22.020,  finishWall: 00:01:50.508)  other: 00:17:27.510,  timeCost: 16.0%,  blocked: 86.5%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  305.3/425  elapsed: 04:16:52.347,  cpu: 00:31:10.200,  blocked: 01:07:47.999,  queue: 02:26:20.076,  scheduled: 00:42:24.000 (addInputWall: 00:26:48.600,  getOutputWall: 00:40:54.000,  finishWall: 00:00:02.050)  other: 00:00:20.270,  timeCost: 41.7%,  blocked: 26.4%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  257.7/432  elapsed: 01:31:31.139,  cpu: 00:29:31.200,  blocked: 00:00:00.000,  queue: 00:41:37.505,  scheduled: 00:42:57.600 (addInputWall: 00:23:12.000,  getOutputWall: 00:41:26.400,  finishWall: 00:00:02.610)  other: 00:06:56.034,  timeCost: 42.2%,  blocked: 0.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"16\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"14\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_2_short_3; tablePath=s3a://wix-bi-sunduk/baguild/d93e74d9-7869-4296-b213-3a784d1d4426; columnHandles=[[app_id, varchar, 1], [instance_id, varchar, 2], [open_date, timestamp, 3], [uuid, varchar, 4], [diff_msid_date, timestamp, 5], [diff_msid_reason, varchar(16), 6], [diff_uuid_date, timestamp, 7], [diff_uuid_reason, varchar(16), 8]], hash=273171890]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"483\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"403\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\ninstance_id := instance_id\\nopen_date := open_date\\nuuid := uuid\\ndiff_msid_date := min\\ndiff_msid_reason := min_by\\ndiff_uuid_date := min_25\\ndiff_uuid_reason := min_by_26\\n\",\n  \"children\" : [ {\n    \"id\" : \"482\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"564\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"9\",\n        \"name\" : \"Aggregate(FINAL)[app_id, instance_id, open_date, uuid][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_59\\\")\\nmin_by_26 := min_by(\\\"min_by_62\\\")\\nmin_25 := min(\\\"min_61\\\")\\nmin_by := min_by(\\\"min_by_60\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"505\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"app_id\\\", \\\"instance_id\\\", \\\"open_date\\\", \\\"uuid\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"503\",\n            \"name\" : \"Aggregate(PARTIAL)[app_id, instance_id, open_date, uuid][$hashvalue_68]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_by_60 := min_by(\\\"action_type_0\\\", \\\"expr_18\\\")\\nmin_by_62 := min_by(\\\"action_type_0\\\", \\\"expr_21\\\")\\nmin_61 := min(\\\"expr_21\\\")\\nmin_59 := min(\\\"expr_18\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"7\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_18 := (CASE WHEN ((\\\"open_date\\\" < \\\"date_created\\\") AND (\\\"msid\\\" <> \\\"msid_6\\\")) THEN \\\"date_created\\\" END)\\nexpr_21 := (CASE WHEN (((\\\"open_date\\\" < \\\"date_created\\\") AND (\\\"msid\\\" = \\\"msid_6\\\")) AND (\\\"uuid\\\" <> \\\"uuid_7\\\")) THEN \\\"date_created\\\" END)\\n$hashvalue_68 := combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"instance_id\\\" = \\\"instance_id_4\\\")][$hashvalue_63, $hashvalue_65]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"401\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"480\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_65] (\\\"app_id_1\\\", \\\"instance_id_4\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"402\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"562\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_1', folderName='021270f4-fbee-48c3-a6e8-7c36522ba71e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('1375baa8-8eca-5659-ce9d-455b2009250d' AS varchar), CAST('1380b703-ce81-ff05-f115-39571d94dfcd' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13aa9735-aa50-4bdb-877c-0bb46804bd71' AS varchar), CAST('13d21c63-b5ec-5912-8397-c3a5ddb27a97' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('14271d6f-ba62-d045-549b-ab972ae1f70e' AS varchar), CAST('14517e1a-3ff0-af98-408e-2bd6953c36a2' AS varchar), CAST('146c0d71-352e-4464-9a03-2e868aabe7b9' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14b89688-9b25-5214-d1cb-a3fb9683618b' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('14bcded7-0066-7c35-14d7-466cb3f09103' AS varchar), CAST('14ce1214-b278-a7e4-1373-00cebd1bef7c' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar), CAST('307ba931-689c-4b55-bb1d-6a382bad9222' AS varchar), CAST('55cd9036-36bb-480b-8ddc-afda3cb2eb8d' AS varchar), CAST('9bead16f-1c73-4cda-b6c4-28cff46988db' AS varchar), CAST('a322993b-2c74-426f-bbb8-444db73d0d1b' AS varchar), CAST('d70b68e2-8d77-4e0c-9c00-c292d6e0025e' AS varchar), CAST('e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b' AS varchar), CAST('ea2821fc-7d97-40a9-9f75-772f29178430' AS varchar), CAST('f123e8f1-4350-4c9b-b269-04adfadda977' AS varchar))))]\",\n  \"details\" : \"$hashvalue_64 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0))\\nopen_date := [open_date, timestamp, 9]\\nmsid := [msid, varchar, 8]\\ninstance_id := [instance_id, varchar, 6]\\nuuid := [uuid, varchar, 10]\\napp_id := [app_id, varchar, 1]\\n    :: [(<min>, 135c3d92-0fea-1f9d-2ba5-2a1dfb04297e), (135c3d92-0fea-1f9d-2ba5-2a1dfb04297e, 1375baa8-8eca-5659-ce9d-455b2009250d), (1375baa8-8eca-5659-ce9d-455b2009250d, 1380b703-ce81-ff05-f115-39571d94dfcd), (1380b703-ce81-ff05-f115-39571d94dfcd, 139ef4fa-c108-8f9a-c7be-d5f492a2c939), (139ef4fa-c108-8f9a-c7be-d5f492a2c939, 13aa9735-aa50-4bdb-877c-0bb46804bd71), (13aa9735-aa50-4bdb-877c-0bb46804bd71, 13d21c63-b5ec-5912-8397-c3a5ddb27a97), (13d21c63-b5ec-5912-8397-c3a5ddb27a97, 13ee94c1-b635-8505-3391-97919052c16f), (13ee94c1-b635-8505-3391-97919052c16f, 141fbfae-511e-6817-c9f0-48993a7547d1), (141fbfae-511e-6817-c9f0-48993a7547d1, 14271d6f-ba62-d045-549b-ab972ae1f70e), (14271d6f-ba62-d045-549b-ab972ae1f70e, 14517e1a-3ff0-af98-408e-2bd6953c36a2), (14517e1a-3ff0-af98-408e-2bd6953c36a2, 146c0d71-352e-4464-9a03-2e868aabe7b9), (146c0d71-352e-4464-9a03-2e868aabe7b9, 1480c568-5cbd-9392-5604-1148f5faffa0), (1480c568-5cbd-9392-5604-1148f5faffa0, 14b89688-9b25-5214-d1cb-a3fb9683618b), (14b89688-9b25-5214-d1cb-a3fb9683618b, 14bca956-e09f-f4d6-14d7-466cb3f09103), (14bca956-e09f-f4d6-14d7-466cb3f09103, 14bcded7-0066-7c35-14d7-466cb3f09103), (14bcded7-0066-7c35-14d7-466cb3f09103, 14ce1214-b278-a7e4-1373-00cebd1bef7c), (14ce1214-b278-a7e4-1373-00cebd1bef7c, 150ae7ee-c74a-eecd-d3d7-2112895b988a), (150ae7ee-c74a-eecd-d3d7-2112895b988a, 307ba931-689c-4b55-bb1d-6a382bad9222), (307ba931-689c-4b55-bb1d-6a382bad9222, 55cd9036-36bb-480b-8ddc-afda3cb2eb8d), (55cd9036-36bb-480b-8ddc-afda3cb2eb8d, 9bead16f-1c73-4cda-b6c4-28cff46988db), (9bead16f-1c73-4cda-b6c4-28cff46988db, a322993b-2c74-426f-bbb8-444db73d0d1b), (a322993b-2c74-426f-bbb8-444db73d0d1b, d70b68e2-8d77-4e0c-9c00-c292d6e0025e), (d70b68e2-8d77-4e0c-9c00-c292d6e0025e, e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b), (e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b, ea2821fc-7d97-40a9-9f75-772f29178430), (ea2821fc-7d97-40a9-9f75-772f29178430, f123e8f1-4350-4c9b-b269-04adfadda977), (f123e8f1-4350-4c9b-b269-04adfadda977, <max>)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"563\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_adds_delta', folderName='f48d4df5-706e-4162-869d-cfb4f8a72f30', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"app_id_1\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('1375baa8-8eca-5659-ce9d-455b2009250d' AS varchar), CAST('1380b703-ce81-ff05-f115-39571d94dfcd' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13aa9735-aa50-4bdb-877c-0bb46804bd71' AS varchar), CAST('13d21c63-b5ec-5912-8397-c3a5ddb27a97' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('14271d6f-ba62-d045-549b-ab972ae1f70e' AS varchar), CAST('14517e1a-3ff0-af98-408e-2bd6953c36a2' AS varchar), CAST('146c0d71-352e-4464-9a03-2e868aabe7b9' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14b89688-9b25-5214-d1cb-a3fb9683618b' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('14bcded7-0066-7c35-14d7-466cb3f09103' AS varchar), CAST('14ce1214-b278-a7e4-1373-00cebd1bef7c' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar), CAST('307ba931-689c-4b55-bb1d-6a382bad9222' AS varchar), CAST('55cd9036-36bb-480b-8ddc-afda3cb2eb8d' AS varchar), CAST('9bead16f-1c73-4cda-b6c4-28cff46988db' AS varchar), CAST('a322993b-2c74-426f-bbb8-444db73d0d1b' AS varchar), CAST('d70b68e2-8d77-4e0c-9c00-c292d6e0025e' AS varchar), CAST('e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b' AS varchar), CAST('ea2821fc-7d97-40a9-9f75-772f29178430' AS varchar), CAST('f123e8f1-4350-4c9b-b269-04adfadda977' AS varchar))))]\",\n  \"details\" : \"$hashvalue_67 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_4\\\"), 0))\\naction_type_0 := [action_type, varchar(16), 0]\\ndate_created := [date_created, timestamp, 2]\\ninstance_id_4 := [instance_id, varchar, 5]\\nuuid_7 := [uuid, varchar, 8]\\napp_id_1 := [app_id, varchar, 1]\\n    :: [(<min>, 135c3d92-0fea-1f9d-2ba5-2a1dfb04297e), (135c3d92-0fea-1f9d-2ba5-2a1dfb04297e, 1375baa8-8eca-5659-ce9d-455b2009250d), (1375baa8-8eca-5659-ce9d-455b2009250d, 1380b703-ce81-ff05-f115-39571d94dfcd), (1380b703-ce81-ff05-f115-39571d94dfcd, 139ef4fa-c108-8f9a-c7be-d5f492a2c939), (139ef4fa-c108-8f9a-c7be-d5f492a2c939, 13aa9735-aa50-4bdb-877c-0bb46804bd71), (13aa9735-aa50-4bdb-877c-0bb46804bd71, 13d21c63-b5ec-5912-8397-c3a5ddb27a97), (13d21c63-b5ec-5912-8397-c3a5ddb27a97, 13ee94c1-b635-8505-3391-97919052c16f), (13ee94c1-b635-8505-3391-97919052c16f, 141fbfae-511e-6817-c9f0-48993a7547d1), (141fbfae-511e-6817-c9f0-48993a7547d1, 14271d6f-ba62-d045-549b-ab972ae1f70e), (14271d6f-ba62-d045-549b-ab972ae1f70e, 14517e1a-3ff0-af98-408e-2bd6953c36a2), (14517e1a-3ff0-af98-408e-2bd6953c36a2, 146c0d71-352e-4464-9a03-2e868aabe7b9), (146c0d71-352e-4464-9a03-2e868aabe7b9, 1480c568-5cbd-9392-5604-1148f5faffa0), (1480c568-5cbd-9392-5604-1148f5faffa0, 14b89688-9b25-5214-d1cb-a3fb9683618b), (14b89688-9b25-5214-d1cb-a3fb9683618b, 14bca956-e09f-f4d6-14d7-466cb3f09103), (14bca956-e09f-f4d6-14d7-466cb3f09103, 14bcded7-0066-7c35-14d7-466cb3f09103), (14bcded7-0066-7c35-14d7-466cb3f09103, 14ce1214-b278-a7e4-1373-00cebd1bef7c), (14ce1214-b278-a7e4-1373-00cebd1bef7c, 150ae7ee-c74a-eecd-d3d7-2112895b988a), (150ae7ee-c74a-eecd-d3d7-2112895b988a, 307ba931-689c-4b55-bb1d-6a382bad9222), (307ba931-689c-4b55-bb1d-6a382bad9222, 55cd9036-36bb-480b-8ddc-afda3cb2eb8d), (55cd9036-36bb-480b-8ddc-afda3cb2eb8d, 9bead16f-1c73-4cda-b6c4-28cff46988db), (9bead16f-1c73-4cda-b6c4-28cff46988db, a322993b-2c74-426f-bbb8-444db73d0d1b), (a322993b-2c74-426f-bbb8-444db73d0d1b, d70b68e2-8d77-4e0c-9c00-c292d6e0025e), (d70b68e2-8d77-4e0c-9c00-c292d6e0025e, e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b), (e3118e0a-b1c1-4e1d-b67d-ddf0cb92309b, ea2821fc-7d97-40a9-9f75-772f29178430), (ea2821fc-7d97-40a9-9f75-772f29178430, f123e8f1-4350-4c9b-b269-04adfadda977), (f123e8f1-4350-4c9b-b269-04adfadda977, <max>)]\\nmsid_6 := [msid, varchar, 7]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_022053_11844_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_2_short\nAS\nselect * from sunduk.baguild.slowly_log_raw_delta_2_short_1\nunion all \nselect * from sunduk.baguild.slowly_log_raw_delta_2_short_2\nunion all\nselect * from sunduk.baguild.slowly_log_raw_delta_2_short_3",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_2_short",
            "queryStats": {
                "elapsedTime": "1.59m",
                "planningTime": "1.23s",
                "analysisTime": "426.70ms",
                "queuedTime": "3.07ms",
                "executionTime": "1.58m",
                "totalCpuTime": "43.74m",
                "rawInputDataSize": "6.58GB",
                "internalNetworkInputDataSize": "117.58GB",
                "physicalInputDataSize": "6.58GB",
                "processedInputDataSize": "124.40GB",
                "rawInputPositions": "926133100",
                "internalNetworkInputPositions": "926133116",
                "physicalInputPositions": "926133100",
                "processedInputPositions": "926133100",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "124.41GB",
                "writtenPositions": "926133100",
                "peakTotalMemoryReservation": "4.48GB",
                "peakTaskTotalMemory": "86.07MB",
                "totalSplits": 389,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_log_raw_delta_2_short_1",
                    "sunduk.baguild.slowly_log_raw_delta_2_short_2",
                    "sunduk.baguild.slowly_log_raw_delta_2_short_3"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.56m",
                    "totalQueuedTime": "3.61ms",
                    "totalScheduledTime": "828.01ms",
                    "totalCpuTime": "40.25ms",
                    "totalBlockedTime": "7.72m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "1.39m",
                    "totalQueuedTime": "48.52ms",
                    "totalScheduledTime": "22.86m",
                    "totalCpuTime": "17.83m",
                    "totalBlockedTime": "1.20h",
                    "rawInputDataSize": "117.58GB",
                    "internalNetworkInputDataSize": "117.58GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "124.41GB",
                    "rawInputPositions": "926133100",
                    "internalNetworkInputPositions": "926133100",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "926133100",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 80,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "1.00m",
                    "totalQueuedTime": "12.91m",
                    "totalScheduledTime": "15.93m",
                    "totalCpuTime": "10.31m",
                    "totalBlockedTime": "1.16h",
                    "rawInputDataSize": "1.24GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "1.24GB",
                    "processedInputDataSize": "49.29GB",
                    "rawInputPositions": "368021497",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "368021497",
                    "processedInputPositions": "368021497",
                    "outputDataSize": "49.29GB",
                    "outputPositions": "368021497",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 112,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "1.12m",
                    "totalQueuedTime": "20.06m",
                    "totalScheduledTime": "18.58m",
                    "totalCpuTime": "12.16m",
                    "totalBlockedTime": "1.36h",
                    "rawInputDataSize": "5.33GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "5.33GB",
                    "processedInputDataSize": "59.21GB",
                    "rawInputPositions": "440229901",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "440229901",
                    "processedInputPositions": "440229901",
                    "outputDataSize": "59.21GB",
                    "outputPositions": "440229901",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 144,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "1.04m",
                    "totalQueuedTime": "7.30ms",
                    "totalScheduledTime": "4.80m",
                    "totalCpuTime": "3.44m",
                    "totalBlockedTime": "13.98m",
                    "rawInputDataSize": "0B",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "15.90GB",
                    "rawInputPositions": "117881702",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "117881702",
                    "processedInputPositions": "117881702",
                    "outputDataSize": "15.90GB",
                    "outputPositions": "117881702",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 48,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:07:44.023,  cpu: 00:00:00.040,  blocked: 00:07:43.200,  queue: 00:00:00.003,  scheduled: 00:00:00.828 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.826,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.8%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   68.8/80   elapsed: 01:35:22.364,  cpu: 00:17:49.800,  blocked: 01:12:00.000,  queue: 00:00:00.048,  scheduled: 00:22:51.600 (addInputWall: 00:17:37.960,  getOutputWall: 00:00:19.531,  finishWall: 00:04:51.001)  other: 00:00:30.715,  timeCost: 36.8%,  blocked: 75.5%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2   98.3/112  elapsed: 01:38:20.309,  cpu: 00:10:18.600,  blocked: 01:09:35.999,  queue: 00:12:54.314,  scheduled: 00:15:55.800 (addInputWall: 00:01:11.910,  getOutputWall: 00:15:06.000,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 25.6%,  blocked: 70.8%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "20"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(382.40MB)/P50(0B) = Infinity times"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  106.9/144  elapsed: 02:00:10.949,  cpu: 00:12:09.600,  blocked: 01:21:36.000,  queue: 00:20:03.821,  scheduled: 00:18:34.800 (addInputWall: 00:02:33.710,  getOutputWall: 00:17:35.400,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 29.9%,  blocked: 67.9%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "taskId": "8"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(762.10MB)/P50(0B) = Infinity times"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4   18.0/48   elapsed: 00:18:47.604,  cpu: 00:03:26.400,  blocked: 00:13:58.800,  queue: 00:00:00.007,  scheduled: 00:04:48.000 (addInputWall: 00:00:16.580,  getOutputWall: 00:04:31.200,  finishWall: 00:00:00.000)  other: 00:00:00.797,  timeCost: 7.7%,  blocked: 74.4%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.6"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"13\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_2_short; tablePath=s3a://wix-bi-sunduk/baguild/5caf847c-8b95-4df8-8096-43833e66449a; columnHandles=[[app_id, varchar, 1], [diff_msid_date, timestamp, 2], [diff_msid_reason, varchar(16), 3], [diff_uuid_date, timestamp, 4], [diff_uuid_reason, varchar(16), 5], [instance_id, varchar, 6], [open_date, timestamp, 7], [uuid, varchar, 8]], hash=1700169316]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"319\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"275\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := expr_71\\ndiff_msid_date := expr_72\\ndiff_msid_reason := expr_73\\ndiff_uuid_date := expr_74\\ndiff_uuid_reason := expr_75\\ninstance_id := expr_76\\nopen_date := expr_77\\nuuid := expr_78\\n\",\n  \"children\" : [ {\n    \"id\" : \"318\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"274\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[2,3,4]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"2\", \"3\", \"4\" ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"0\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_2_short_1', folderName='1cd9c1b3-8605-4fb8-9a05-bf796a556314', columns='[[app_id,varchar,false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [instance_id,varchar,false], [open_date,timestamp,false], [uuid,varchar,false]]'}]\",\n  \"details\" : \"open_date := [open_date, timestamp, 6]\\ninstance_id := [instance_id, varchar, 5]\\ndiff_uuid_reason := [diff_uuid_reason, varchar(16), 4]\\ndiff_msid_reason := [diff_msid_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 7]\\ndiff_uuid_date := [diff_uuid_date, timestamp, 3]\\ndiff_msid_date := [diff_msid_date, timestamp, 1]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"3\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_2_short_2', folderName='7d95a1ee-3bbe-4884-b8b4-cb99f4a25545', columns='[[app_id,varchar,false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [instance_id,varchar,false], [open_date,timestamp,false], [uuid,varchar,false]]'}]\",\n  \"details\" : \"diff_uuid_reason_19 := [diff_uuid_reason, varchar(16), 4]\\nuuid_22 := [uuid, varchar, 7]\\ninstance_id_20 := [instance_id, varchar, 5]\\napp_id_15 := [app_id, varchar, 0]\\nopen_date_21 := [open_date, timestamp, 6]\\ndiff_msid_reason_17 := [diff_msid_reason, varchar(16), 2]\\ndiff_msid_date_16 := [diff_msid_date, timestamp, 1]\\ndiff_uuid_date_18 := [diff_uuid_date, timestamp, 3]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"7\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_2_short_3', folderName='d93e74d9-7869-4296-b213-3a784d1d4426', columns='[[app_id,varchar,false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [instance_id,varchar,false], [open_date,timestamp,false], [uuid,varchar,false]]'}]\",\n  \"details\" : \"diff_uuid_date_50 := [diff_uuid_date, timestamp, 3]\\ndiff_uuid_reason_51 := [diff_uuid_reason, varchar(16), 4]\\nuuid_54 := [uuid, varchar, 7]\\nopen_date_53 := [open_date, timestamp, 6]\\napp_id_47 := [app_id, varchar, 0]\\ndiff_msid_reason_49 := [diff_msid_reason, varchar(16), 2]\\ndiff_msid_date_48 := [diff_msid_date, timestamp, 1]\\ninstance_id_52 := [instance_id, varchar, 5]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_022228_12055_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_2 \nAS\n\nSELECT  base.*\n        , diff_msid_date\n        , diff_msid_reason\n        , diff_uuid_date\n        , diff_uuid_reason\n    FROM        sunduk.baguild.slowly_log_raw_delta_1           base\n    LEFT JOIN   sunduk.baguild.slowly_log_raw_delta_2_short     short   ON  base.app_id=short.app_id \n                                                                        AND base.instance_id=short.instance_id\n                                                                        AND base.open_date=short.open_date\n                                                                        AND base.uuid=short.uuid",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_2",
            "queryStats": {
                "elapsedTime": "4.36m",
                "planningTime": "980.98ms",
                "analysisTime": "279.49ms",
                "queuedTime": "310.39us",
                "executionTime": "4.35m",
                "totalCpuTime": "2.53h",
                "rawInputDataSize": "76.53GB",
                "internalNetworkInputDataSize": "314.92GB",
                "physicalInputDataSize": "76.53GB",
                "processedInputDataSize": "76.53GB",
                "rawInputPositions": "1881596275",
                "internalNetworkInputPositions": "1881596291",
                "physicalInputPositions": "1881596275",
                "processedInputPositions": "1881596275",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "202.73GB",
                "writtenPositions": "955463175",
                "peakTotalMemoryReservation": "150.87GB",
                "peakTaskTotalMemory": "9.31GB",
                "totalSplits": 930,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_log_raw_delta_1",
                    "sunduk.baguild.slowly_log_raw_delta_2_short"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "4.34m",
                    "totalQueuedTime": "1.11ms",
                    "totalScheduledTime": "1.14s",
                    "totalCpuTime": "71.28ms",
                    "totalBlockedTime": "21.59m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "4.19m",
                    "totalQueuedTime": "80.15ms",
                    "totalScheduledTime": "1.14h",
                    "totalCpuTime": "1.02h",
                    "totalBlockedTime": "8.00h",
                    "rawInputDataSize": "314.92GB",
                    "internalNetworkInputDataSize": "314.92GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "332.97GB",
                    "rawInputPositions": "1881596275",
                    "internalNetworkInputPositions": "1881596275",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "1881596275",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 208,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "3.38m",
                    "totalQueuedTime": "9.04h",
                    "totalScheduledTime": "1.11h",
                    "totalCpuTime": "56.72m",
                    "totalBlockedTime": "7.36h",
                    "rawInputDataSize": "51.18GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "51.18GB",
                    "processedInputDataSize": "51.18GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "200.81GB",
                    "outputPositions": "955463175",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 425,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "15.03s",
                    "totalQueuedTime": "24.21m",
                    "totalScheduledTime": "40.20m",
                    "totalCpuTime": "34.06m",
                    "totalBlockedTime": "585.56ms",
                    "rawInputDataSize": "25.34GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "25.34GB",
                    "processedInputDataSize": "25.34GB",
                    "rawInputPositions": "926133100",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "926133100",
                    "processedInputPositions": "926133100",
                    "outputDataSize": "132.11GB",
                    "outputPositions": "926133100",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 292,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:21:36.519,  cpu: 00:00:00.071,  blocked: 00:21:35.400,  queue: 00:00:00.001,  scheduled: 00:00:01.140 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.130,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  139.9/208  elapsed: 09:45:32.627,  cpu: 01:01:12.000,  blocked: 08:00:00.000,  queue: 00:00:00.080,  scheduled: 01:08:23.999 (addInputWall: 00:40:21.942,  getOutputWall: 00:19:21.980,  finishWall: 00:08:17.402)  other: 00:37:08.547,  timeCost: 39.0%,  blocked: 82.0%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  316.3/425  elapsed: 17:49:43.626,  cpu: 00:56:43.200,  blocked: 07:21:36.000,  queue: 09:02:37.599,  scheduled: 01:06:36.000 (addInputWall: 00:30:48.600,  getOutputWall: 00:47:37.800,  finishWall: 00:00:02.360)  other: 00:18:54.027,  timeCost: 38.0%,  blocked: 41.3%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  257.2/292  elapsed: 01:04:25.594,  cpu: 00:34:03.600,  blocked: 00:00:00.585,  queue: 00:24:12.630,  scheduled: 00:40:12.000 (addInputWall: 00:18:13.800,  getOutputWall: 00:28:05.400,  finishWall: 00:00:02.850)  other: 00:00:00.378,  timeCost: 22.9%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "WARN",
                    "message": "High avg CPU usage 52.87%, the most consuming operator ScanFilterAndProjectOperator (35.05%)"
                },
                {
                    "source": {
                        "stageId": "3",
                        "taskId": "38"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(2.24GB)/P50(410.17MB) = 5.6 times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"12\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"10\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_2; tablePath=s3a://wix-bi-sunduk/baguild/7f1a6b7f-77c3-4597-988b-fbc9eec42b7e; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [diff_instance_date, timestamp, 3], [diff_instance_reason, varchar(16), 4], [event_type, varchar(5), 5], [initiator_name, varchar, 6], [instance_id, varchar, 7], [is_published, boolean, 8], [msid, varchar, 9], [open_date, timestamp, 10], [uuid, varchar, 11], [was_demo, boolean, 12], [diff_msid_date, timestamp, 13], [diff_msid_reason, varchar(16), 14], [diff_uuid_date, timestamp, 15], [diff_uuid_reason, varchar(16), 16]], hash=-551765009]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"283\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"232\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"11\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndiff_instance_date := diff_instance_date\\ndiff_instance_reason := diff_instance_reason\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nuuid := uuid\\nwas_demo := was_demo\\ndiff_msid_date := diff_msid_date\\ndiff_msid_reason := diff_msid_reason\\ndiff_uuid_date := diff_uuid_date\\ndiff_uuid_reason := diff_uuid_reason\\n\",\n  \"children\" : [ {\n    \"id\" : \"282\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"4\",\n      \"name\" : \"LeftJoin\",\n      \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_0\\\") AND (\\\"instance_id\\\" = \\\"instance_id_1\\\") AND (\\\"open_date\\\" = \\\"open_date_2\\\") AND (\\\"uuid\\\" = \\\"uuid_3\\\")][$hashvalue, $hashvalue_76]\",\n      \"details\" : \"Distribution: PARTITIONED\\n\",\n      \"children\" : [ {\n        \"id\" : \"230\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[2]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"2\" ]\n      }, {\n        \"id\" : \"281\",\n        \"name\" : \"LocalExchange\",\n        \"identifier\" : \"[HASH][$hashvalue_76] (\\\"app_id_0\\\", \\\"instance_id_1\\\", \\\"open_date_2\\\", \\\"uuid_3\\\")\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"231\",\n          \"name\" : \"RemoteSource\",\n          \"identifier\" : \"[3]\",\n          \"details\" : \"\",\n          \"children\" : [ ],\n          \"remoteSources\" : [ \"3\" ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"328\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_1', folderName='021270f4-fbee-48c3-a6e8-7c36522ba71e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_75 := combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0))\\nopen_date := [open_date, timestamp, 9]\\nmsid := [msid, varchar, 8]\\ninstance_id := [instance_id, varchar, 6]\\nevent_type := [event_type, varchar(5), 4]\\naction_type := [action_type, varchar(16), 0]\\nwas_demo := [was_demo, boolean, 11]\\nis_published := [is_published, boolean, 7]\\ninitiator_name := [initiator_name, varchar, 5]\\ndiff_instance_date := [diff_instance_date, timestamp, 2]\\nuuid := [uuid, varchar, 10]\\ndiff_instance_reason := [diff_instance_reason, varchar(16), 3]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"329\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_2_short', folderName='5caf847c-8b95-4df8-8096-43833e66449a', columns='[[app_id,varchar,false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [instance_id,varchar,false], [open_date,timestamp,false], [uuid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_78 := combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_0\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date_2\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid_3\\\"), 0))\\ninstance_id_1 := [instance_id, varchar, 5]\\ndiff_uuid_reason := [diff_uuid_reason, varchar(16), 4]\\nuuid_3 := [uuid, varchar, 7]\\nopen_date_2 := [open_date, timestamp, 6]\\ndiff_msid_reason := [diff_msid_reason, varchar(16), 2]\\napp_id_0 := [app_id, varchar, 0]\\ndiff_uuid_date := [diff_uuid_date, timestamp, 3]\\ndiff_msid_date := [diff_msid_date, timestamp, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_022650_12484_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_apps_part1 -- 194052035 --2do: to optimize this part even more for faster run \nAS\n\n    SELECT  base.*\n            , min (case when base.open_date<revokes.date_created then revokes.date_created end) as app_revoke_date\n            , min (case when base.open_date<delete_site.date_created then delete_site.date_created end) as site_delete_date\n            , min (case when base.open_date<transfer_site.date_created then transfer_site.date_created end) as site_transfer_date\n\n    FROM        sunduk.baguild.slowly_log_raw_delta_2           base\n    LEFT JOIN   prod.verticals.slowly_revokes_delta             revokes                 ON  base.app_id=revokes.app_id\n                                                                                            AND base.instance_id=revokes.instance_id\n    LEFT JOIN   prod.verticals.slowly_delete_site_delta         delete_site             ON  base.msid=delete_site.msid\n    LEFT JOIN   prod.verticals.slowly_transfer_site_new_delta   transfer_site           ON  base.msid=transfer_site.origin_msid AND transfer_site.date_created >= date (timestamp '2020-07-02 01:00:56') and transfer_site.date_created < date (timestamp '2020-07-03 00:56:28')\n    WHERE base.app_id in    ( '135c3d92-0fea-1f9d-2ba5-2a1dfb04297e'\n                            ,'139ef4fa-c108-8f9a-c7be-d5f492a2c939'\n                            ,'141fbfae-511e-6817-c9f0-48993a7547d1'\n                            ,'1480c568-5cbd-9392-5604-1148f5faffa0'\n                            ,'13ee94c1-b635-8505-3391-97919052c16f'\n                            ,'14bca956-e09f-f4d6-14d7-466cb3f09103'\n                            ,'150ae7ee-c74a-eecd-d3d7-2112895b988a'\n                            )\n    GROUP by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_apps_part1",
            "queryStats": {
                "elapsedTime": "2.12m",
                "planningTime": "1.51s",
                "analysisTime": "451.89ms",
                "queuedTime": "149.70us",
                "executionTime": "2.12m",
                "totalCpuTime": "1.99h",
                "rawInputDataSize": "80.65GB",
                "internalNetworkInputDataSize": "152.65GB",
                "physicalInputDataSize": "80.65GB",
                "processedInputDataSize": "80.65GB",
                "rawInputPositions": "955633877",
                "internalNetworkInputPositions": "736083707",
                "physicalInputPositions": "955633877",
                "processedInputPositions": "955633877",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "81.07GB",
                "writtenPositions": "368021497",
                "peakTotalMemoryReservation": "131.98GB",
                "peakTaskTotalMemory": "8.26GB",
                "totalSplits": 1118,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "prod.verticals.slowly_delete_site_delta",
                    "prod.verticals.slowly_revokes_delta",
                    "prod.verticals.slowly_transfer_site_new_delta",
                    "sunduk.baguild.slowly_log_raw_delta_2"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "2.09m",
                    "totalQueuedTime": "996.96us",
                    "totalScheduledTime": "1.33s",
                    "totalCpuTime": "48.10ms",
                    "totalBlockedTime": "10.34m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "2.01m",
                    "totalQueuedTime": "317.20ms",
                    "totalScheduledTime": "1.10h",
                    "totalCpuTime": "1.00h",
                    "totalBlockedTime": "3.54h",
                    "rawInputDataSize": "76.33GB",
                    "internalNetworkInputDataSize": "76.33GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "81.98GB",
                    "rawInputPositions": "368049768",
                    "internalNetworkInputPositions": "368049768",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "368049768",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 400,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "45.71s",
                    "totalQueuedTime": "84.37ms",
                    "totalScheduledTime": "16.77m",
                    "totalCpuTime": "15.30m",
                    "totalBlockedTime": "1.35h",
                    "rawInputDataSize": "76.32GB",
                    "internalNetworkInputDataSize": "76.32GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "81.28GB",
                    "rawInputPositions": "368033923",
                    "internalNetworkInputPositions": "368033923",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "368033923",
                    "outputDataSize": "81.99GB",
                    "outputPositions": "368022827",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 192,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "20.12s",
                    "totalQueuedTime": "1.34h",
                    "totalScheduledTime": "49.28m",
                    "totalCpuTime": "43.86m",
                    "totalBlockedTime": "14.33m",
                    "rawInputDataSize": "80.65GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "80.65GB",
                    "processedInputDataSize": "80.65GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "81.31GB",
                    "outputPositions": "368021497",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 432,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "211.00ms",
                    "totalQueuedTime": "11.38ms",
                    "totalScheduledTime": "6.72s",
                    "totalCpuTime": "674.90ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "248.78kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "248.78kB",
                    "processedInputDataSize": "248.78kB",
                    "rawInputPositions": "143751",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "143751",
                    "processedInputPositions": "143751",
                    "outputDataSize": "1.19MB",
                    "outputPositions": "12426",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 40,
                    "spilledDataSize": "0B"
                },
                "5": {
                    "stageDuration": "122.00ms",
                    "totalQueuedTime": "53.96ms",
                    "totalScheduledTime": "4.00s",
                    "totalCpuTime": "422.81ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "86.35kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "86.35kB",
                    "processedInputDataSize": "86.35kB",
                    "rawInputPositions": "25116",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "25116",
                    "processedInputPositions": "25116",
                    "outputDataSize": "1.41MB",
                    "outputPositions": "25116",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 33,
                    "spilledDataSize": "0B"
                },
                "6": {
                    "stageDuration": "237.00ms",
                    "totalQueuedTime": "5.50ms",
                    "totalScheduledTime": "1.46s",
                    "totalCpuTime": "188.29ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "0B",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "0B",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1835",
                    "processedInputPositions": "1835",
                    "outputDataSize": "105.15kB",
                    "outputPositions": "1825",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:10:21.770,  cpu: 00:00:00.048,  blocked: 00:10:20.400,  queue: 00:00:00.000,  scheduled: 00:00:01.330 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.321,  finishWall: 00:00:00.000)  other: 00:00:00.039,  timeCost: 0.0%,  blocked: 99.8%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  139.4/400  elapsed: 04:40:32.014,  cpu: 01:00:00.000,  blocked: 03:32:24.000,  queue: 00:00:00.317,  scheduled: 01:06:00.000 (addInputWall: 00:36:27.929,  getOutputWall: 00:26:58.171,  finishWall: 00:02:26.005)  other: 00:02:07.697,  timeCost: 49.9%,  blocked: 75.7%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "4",
                        "operatorId": "2"
                    },
                    "level": "WARN",
                    "message": "LeftJoin by non-uniq column(s), multiplier 14653.1"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  128.8/192  elapsed: 01:38:06.237,  cpu: 00:15:18.000,  blocked: 01:21:00.000,  queue: 00:00:00.084,  scheduled: 00:16:46.200 (addInputWall: 00:11:37.488,  getOutputWall: 00:05:05.512,  finishWall: 00:00:00.890)  other: 00:00:19.953,  timeCost: 12.7%,  blocked: 82.6%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  430.1/432  elapsed: 02:24:15.939,  cpu: 00:43:51.600,  blocked: 00:14:19.800,  queue: 01:20:36.720,  scheduled: 00:49:16.800 (addInputWall: 00:23:27.600,  getOutputWall: 00:40:29.400,  finishWall: 00:00:03.150)  other: 00:00:02.619,  timeCost: 37.3%,  blocked: 9.9%"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4   31.9/40   elapsed: 00:00:06.727,  cpu: 00:00:00.674,  blocked: 00:00:00.000,  queue: 00:00:00.011,  scheduled: 00:00:06.720 (addInputWall: 00:00:00.186,  getOutputWall: 00:00:06.710,  finishWall: 00:00:00.004)  other: 00:00:00.000,  timeCost: 0.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.2"
                },
                {
                    "source": {
                        "stageId": "4",
                        "taskId": "8"
                    },
                    "level": "INFO",
                    "message": "Long tail task detected: Max/P90=2.3"
                },
                {
                    "source": {
                        "stageId": "5"
                    },
                    "level": "INFO",
                    "message": "stage.5   33.2/33   elapsed: 00:00:04.051,  cpu: 00:00:00.422,  blocked: 00:00:00.000,  queue: 00:00:00.053,  scheduled: 00:00:04.000 (addInputWall: 00:00:00.074,  getOutputWall: 00:00:03.970,  finishWall: 00:00:00.021)  other: 00:00:00.000,  timeCost: 0.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "6"
                    },
                    "level": "INFO",
                    "message": "stage.6    6.2/16   elapsed: 00:00:01.464,  cpu: 00:00:00.188,  blocked: 00:00:00.000,  queue: 00:00:00.005,  scheduled: 00:00:01.460 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.450,  finishWall: 00:00:00.008)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 0.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"27\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"25\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_apps_part1; tablePath=s3a://wix-bi-sunduk/baguild/64f9ea8b-64e8-4d2e-b6e6-3fab42cec3df; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [diff_instance_date, timestamp, 3], [diff_instance_reason, varchar(16), 4], [diff_msid_date, timestamp, 5], [diff_msid_reason, varchar(16), 6], [diff_uuid_date, timestamp, 7], [diff_uuid_reason, varchar(16), 8], [event_type, varchar(5), 9], [initiator_name, varchar, 10], [instance_id, varchar, 11], [is_published, boolean, 12], [msid, varchar, 13], [open_date, timestamp, 14], [uuid, varchar, 15], [was_demo, boolean, 16], [app_revoke_date, timestamp, 17], [site_delete_date, timestamp, 18], [site_transfer_date, timestamp, 19]], hash=797992395]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"786\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"654\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"26\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndiff_instance_date := diff_instance_date\\ndiff_instance_reason := diff_instance_reason\\ndiff_msid_date := diff_msid_date\\ndiff_msid_reason := diff_msid_reason\\ndiff_uuid_date := diff_uuid_date\\ndiff_uuid_reason := diff_uuid_reason\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nuuid := uuid\\nwas_demo := was_demo\\napp_revoke_date := min\\nsite_delete_date := min_57\\nsite_transfer_date := min_58\\n\",\n  \"children\" : [ {\n    \"id\" : \"785\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"910\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"20\",\n        \"name\" : \"Aggregate(FINAL)[action_type, app_id, diff_instance_date, diff_instance_reason, diff_msid_date, diff_msid_reason, diff_uuid_date, diff_uuid_reason, event_type, initiator_name, instance_id, is_published, msid, open_date, uuid, was_demo][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_135\\\")\\nmin_57 := min(\\\"min_136\\\")\\nmin_58 := min(\\\"min_137\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"818\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"action_type\\\", \\\"app_id\\\", \\\"diff_instance_date\\\", \\\"diff_instance_reason\\\", \\\"diff_msid_date\\\", \\\"diff_msid_reason\\\", \\\"diff_uuid_date\\\", \\\"diff_uuid_reason\\\", \\\"event_type\\\", \\\"initiator_name\\\", \\\"instance_id\\\", \\\"is_published\\\", \\\"msid\\\", \\\"open_date\\\", \\\"uuid\\\", \\\"was_demo\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"816\",\n            \"name\" : \"Aggregate(PARTIAL)[action_type, app_id, diff_instance_date, diff_instance_reason, diff_msid_date, diff_msid_reason, diff_uuid_date, diff_uuid_reason, event_type, initiator_name, instance_id, is_published, msid, open_date, uuid, was_demo][$hashvalue_151]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_137 := min(\\\"expr_41\\\")\\nmin_135 := min(\\\"expr_39\\\")\\nmin_136 := min(\\\"expr_40\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"18\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_39 := (CASE WHEN (\\\"open_date\\\" < \\\"date_created\\\") THEN \\\"date_created\\\" END)\\nexpr_40 := (CASE WHEN (\\\"open_date\\\" < \\\"date_created_13\\\") THEN \\\"date_created_13\\\" END)\\nexpr_41 := (CASE WHEN (\\\"open_date\\\" < \\\"date_created_17\\\") THEN \\\"date_created_17\\\" END)\\n$hashvalue_151 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"action_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_instance_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_instance_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_msid_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_msid_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_uuid_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_uuid_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"event_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"16\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"msid\\\" = \\\"origin_msid\\\")][$hashvalue_138, $hashvalue_148]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"9\",\n                  \"name\" : \"LeftJoin\",\n                  \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_14\\\")][$hashvalue_138, $hashvalue_145]\",\n                  \"details\" : \"Distribution: PARTITIONED\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"650\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[2]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"2\" ]\n                  }, {\n                    \"id\" : \"782\",\n                    \"name\" : \"LocalExchange\",\n                    \"identifier\" : \"[HASH][$hashvalue_145] (\\\"msid_14\\\")\",\n                    \"details\" : \"\",\n                    \"children\" : [ {\n                      \"id\" : \"651\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[5]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"5\" ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                }, {\n                  \"id\" : \"783\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_148] (\\\"origin_msid\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"653\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[6]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"6\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"907\",\n  \"name\" : \"Project\",\n  \"identifier\" : \"[]\",\n  \"details\" : \"$hashvalue_144 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\n\",\n  \"children\" : [ {\n    \"id\" : \"4\",\n    \"name\" : \"LeftJoin\",\n    \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"instance_id\\\" = \\\"instance_id_4\\\")][$hashvalue_139, $hashvalue_141]\",\n    \"details\" : \"Distribution: PARTITIONED\\n\",\n    \"children\" : [ {\n      \"id\" : \"648\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[3]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"3\" ]\n    }, {\n      \"id\" : \"781\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[HASH][$hashvalue_141] (\\\"app_id_1\\\", \\\"instance_id_4\\\")\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"649\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[4]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"4\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": [
                                    {
                                        "stageId": "3",
                                        "plan": "{\n  \"id\" : \"905\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_2', folderName='7f1a6b7f-77c3-4597-988b-fbc9eec42b7e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar)))]\",\n  \"details\" : \"$hashvalue_140 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0))\\nopen_date := [open_date, timestamp, 13]\\ndiff_uuid_reason := [diff_uuid_reason, varchar(16), 7]\\naction_type := [action_type, varchar(16), 0]\\nis_published := [is_published, boolean, 11]\\ndiff_instance_date := [diff_instance_date, timestamp, 2]\\nuuid := [uuid, varchar, 14]\\ndiff_uuid_date := [diff_uuid_date, timestamp, 6]\\nmsid := [msid, varchar, 12]\\ninstance_id := [instance_id, varchar, 10]\\nevent_type := [event_type, varchar(5), 8]\\nwas_demo := [was_demo, boolean, 15]\\ninitiator_name := [initiator_name, varchar, 9]\\ndiff_msid_reason := [diff_msid_reason, varchar(16), 5]\\ndiff_msid_date := [diff_msid_date, timestamp, 4]\\ndiff_instance_reason := [diff_instance_reason, varchar(16), 3]\\napp_id := [app_id, varchar, 1]\\n    :: [[135c3d92-0fea-1f9d-2ba5-2a1dfb04297e], [139ef4fa-c108-8f9a-c7be-d5f492a2c939], [13ee94c1-b635-8505-3391-97919052c16f], [141fbfae-511e-6817-c9f0-48993a7547d1], [1480c568-5cbd-9392-5604-1148f5faffa0], [14bca956-e09f-f4d6-14d7-466cb3f09103], [150ae7ee-c74a-eecd-d3d7-2112895b988a]]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                        "subStages": []
                                    },
                                    {
                                        "stageId": "4",
                                        "plan": "{\n  \"id\" : \"906\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_revokes_delta', folderName='4f10f360-ac09-4b9e-bd79-152398442ee7', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id_1\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar)))]\",\n  \"details\" : \"$hashvalue_143 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_4\\\"), 0))\\ndate_created := [date_created, timestamp, 2]\\ninstance_id_4 := [instance_id, varchar, 5]\\napp_id_1 := [app_id, varchar, 1]\\n    :: [[135c3d92-0fea-1f9d-2ba5-2a1dfb04297e], [139ef4fa-c108-8f9a-c7be-d5f492a2c939], [13ee94c1-b635-8505-3391-97919052c16f], [141fbfae-511e-6817-c9f0-48993a7547d1], [1480c568-5cbd-9392-5604-1148f5faffa0], [14bca956-e09f-f4d6-14d7-466cb3f09103], [150ae7ee-c74a-eecd-d3d7-2112895b988a]]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                        "subStages": []
                                    }
                                ]
                            },
                            {
                                "stageId": "5",
                                "plan": "{\n  \"id\" : \"908\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_delete_site_delta', folderName='e7fe6106-26b0-47bf-9f27-41d869c30bac', columns='[[action_type,varchar(11),false], [date_created,timestamp,false], [msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_147 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_14\\\"), 0))\\nmsid_14 := [msid, varchar, 2]\\ndate_created_13 := [date_created, timestamp, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "6",
                                "plan": "{\n  \"id\" : \"909\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_transfer_site_new_delta', folderName='5f32479c-ba39-454f-852b-f2c35732f970', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}, filterPredicate = ((\\\"date_created_17\\\" >= \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593648000000)) AND (\\\"date_created_17\\\" < \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593734400000)))]\",\n  \"details\" : \"$hashvalue_150 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"origin_msid\\\"), 0))\\norigin_msid := [origin_msid, varchar, 5]\\ndate_created_17 := [date_created, timestamp, 0]\\n    :: [[2020-07-02 00:00:00.000, 2020-07-03 00:00:00.000)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_022857_12690_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_raw_delta_apps_part2 -- 194052035 --2do: to optimize this part even more for faster run \nAS\n\n    SELECT  base.*\n            , min (case when base.open_date<revokes.date_created then revokes.date_created end) as app_revoke_date\n            , min (case when base.open_date<delete_site.date_created then delete_site.date_created end) as site_delete_date\n            , min (case when base.open_date<transfer_site.date_created then transfer_site.date_created end) as site_transfer_date\n\n    FROM        sunduk.baguild.slowly_log_raw_delta_2           base\n    LEFT JOIN   prod.verticals.slowly_revokes_delta             revokes                 ON  base.app_id=revokes.app_id\n                                                                                            AND base.instance_id=revokes.instance_id\n    LEFT JOIN   prod.verticals.slowly_delete_site_delta         delete_site             ON  base.msid=delete_site.msid\n    LEFT JOIN   prod.verticals.slowly_transfer_site_new_delta   transfer_site           ON  base.msid=transfer_site.origin_msid AND transfer_site.date_created >= date (timestamp '2020-07-02 01:00:56') and transfer_site.date_created < date (timestamp '2020-07-03 00:56:28')\n    WHERE base.app_id not in  ( '135c3d92-0fea-1f9d-2ba5-2a1dfb04297e'\n                              ,'139ef4fa-c108-8f9a-c7be-d5f492a2c939'\n                              ,'141fbfae-511e-6817-c9f0-48993a7547d1'\n                              ,'1480c568-5cbd-9392-5604-1148f5faffa0'\n                              ,'13ee94c1-b635-8505-3391-97919052c16f'\n                              ,'14bca956-e09f-f4d6-14d7-466cb3f09103'\n                              ,'150ae7ee-c74a-eecd-d3d7-2112895b988a'\n                              )\n    GROUP by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16",
            "queryName": "create sunduk.baguild.slowly_log_raw_delta_apps_part2",
            "queryStats": {
                "elapsedTime": "4.65m",
                "planningTime": "1.54s",
                "analysisTime": "431.22ms",
                "queuedTime": "2.83ms",
                "executionTime": "4.64m",
                "totalCpuTime": "2.60h",
                "rawInputDataSize": "69.73GB",
                "internalNetworkInputDataSize": "243.05GB",
                "physicalInputDataSize": "69.73GB",
                "processedInputDataSize": "69.73GB",
                "rawInputPositions": "955633877",
                "internalNetworkInputPositions": "1175072639",
                "physicalInputPositions": "955633877",
                "processedInputPositions": "955633877",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "132.31GB",
                "writtenPositions": "587441678",
                "peakTotalMemoryReservation": "214.05GB",
                "peakTaskTotalMemory": "13.39GB",
                "totalSplits": 1118,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "prod.verticals.slowly_delete_site_delta",
                    "prod.verticals.slowly_revokes_delta",
                    "prod.verticals.slowly_transfer_site_new_delta",
                    "sunduk.baguild.slowly_log_raw_delta_2"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "4.62m",
                    "totalQueuedTime": "1.02ms",
                    "totalScheduledTime": "794.94ms",
                    "totalCpuTime": "59.48ms",
                    "totalBlockedTime": "23.01m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "3.86m",
                    "totalQueuedTime": "15.21s",
                    "totalScheduledTime": "1.56h",
                    "totalCpuTime": "1.45h",
                    "totalBlockedTime": "7.05h",
                    "rawInputDataSize": "121.56GB",
                    "internalNetworkInputDataSize": "121.56GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "132.99GB",
                    "rawInputPositions": "587499620",
                    "internalNetworkInputPositions": "587499620",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "587499620",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 400,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "1.84m",
                    "totalQueuedTime": "6.34s",
                    "totalScheduledTime": "22.11m",
                    "totalCpuTime": "20.79m",
                    "totalBlockedTime": "2.97h",
                    "rawInputDataSize": "121.49GB",
                    "internalNetworkInputDataSize": "121.49GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "129.74GB",
                    "rawInputPositions": "587573003",
                    "internalNetworkInputPositions": "587573003",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "587573003",
                    "outputDataSize": "132.97GB",
                    "outputPositions": "587472679",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 192,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "1.79m",
                    "totalQueuedTime": "5.42h",
                    "totalScheduledTime": "59.92m",
                    "totalCpuTime": "48.58m",
                    "totalBlockedTime": "2.17h",
                    "rawInputDataSize": "69.61GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "69.61GB",
                    "processedInputDataSize": "69.61GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955463175",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "129.70GB",
                    "outputPositions": "587441678",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 432,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "520.00ms",
                    "totalQueuedTime": "310.86ms",
                    "totalScheduledTime": "6.94s",
                    "totalCpuTime": "974.46ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "126.27MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "126.27MB",
                    "processedInputDataSize": "126.27MB",
                    "rawInputPositions": "143751",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "143751",
                    "processedInputPositions": "143751",
                    "outputDataSize": "12.52MB",
                    "outputPositions": "131325",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 40,
                    "spilledDataSize": "0B"
                },
                "5": {
                    "stageDuration": "691.00ms",
                    "totalQueuedTime": "1.05s",
                    "totalScheduledTime": "4.11s",
                    "totalCpuTime": "471.03ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "325.32kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "325.32kB",
                    "processedInputDataSize": "325.32kB",
                    "rawInputPositions": "25116",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "25116",
                    "processedInputPositions": "25116",
                    "outputDataSize": "1.41MB",
                    "outputPositions": "25116",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 33,
                    "spilledDataSize": "0B"
                },
                "6": {
                    "stageDuration": "704.00ms",
                    "totalQueuedTime": "6.05ms",
                    "totalScheduledTime": "1.98s",
                    "totalCpuTime": "226.63ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "17.91kB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "17.91kB",
                    "processedInputDataSize": "17.91kB",
                    "rawInputPositions": "1835",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1835",
                    "processedInputPositions": "1835",
                    "outputDataSize": "105.14kB",
                    "outputPositions": "1825",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:23:01.326,  cpu: 00:00:00.059,  blocked: 00:23:00.600,  queue: 00:00:00.001,  scheduled: 00:00:00.794 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.793,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  169.4/400  elapsed: 10:54:04.310,  cpu: 01:27:00.000,  blocked: 07:03:00.000,  queue: 00:00:15.209,  scheduled: 01:33:36.000 (addInputWall: 00:52:59.211,  getOutputWall: 00:36:51.825,  finishWall: 00:03:43.829)  other: 02:17:13.100,  timeCost: 53.2%,  blocked: 64.7%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=5.3"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "2"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=6.9"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "4",
                        "operatorId": "2"
                    },
                    "level": "WARN",
                    "message": "LeftJoin by non-uniq column(s), multiplier 23390.7"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  129.3/192  elapsed: 03:57:42.741,  cpu: 00:20:47.400,  blocked: 02:58:12.000,  queue: 00:00:06.339,  scheduled: 00:22:06.600 (addInputWall: 00:15:13.474,  getOutputWall: 00:06:49.829,  finishWall: 00:00:00.902)  other: 00:37:17.801,  timeCost: 12.6%,  blocked: 75.0%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=6.7"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  319.7/432  elapsed: 09:32:53.933,  cpu: 00:48:34.800,  blocked: 02:10:12.000,  queue: 05:25:08.449,  scheduled: 00:59:55.200 (addInputWall: 00:29:01.800,  getOutputWall: 00:47:02.400,  finishWall: 00:00:03.340)  other: 00:57:38.283,  timeCost: 34.1%,  blocked: 22.7%"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4   13.9/40   elapsed: 00:00:07.253,  cpu: 00:00:00.974,  blocked: 00:00:00.000,  queue: 00:00:00.310,  scheduled: 00:00:06.940 (addInputWall: 00:00:01.756,  getOutputWall: 00:00:06.850,  finishWall: 00:00:00.051)  other: 00:00:00.002,  timeCost: 0.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 90.1 of data dropped"
                },
                {
                    "source": {
                        "stageId": "4",
                        "taskId": "19"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(125.95MB)/P50(0B) = Infinity times"
                },
                {
                    "source": {
                        "stageId": "5"
                    },
                    "level": "INFO",
                    "message": "stage.5    7.5/33   elapsed: 00:00:05.153,  cpu: 00:00:00.471,  blocked: 00:00:00.000,  queue: 00:00:01.046,  scheduled: 00:00:04.110 (addInputWall: 00:00:00.277,  getOutputWall: 00:00:04.080,  finishWall: 00:00:00.026)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "5",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=6.1"
                },
                {
                    "source": {
                        "stageId": "6"
                    },
                    "level": "INFO",
                    "message": "stage.6    2.8/16   elapsed: 00:00:01.988,  cpu: 00:00:00.226,  blocked: 00:00:00.000,  queue: 00:00:00.006,  scheduled: 00:00:01.980 (addInputWall: 00:00:00.019,  getOutputWall: 00:00:01.970,  finishWall: 00:00:00.012)  other: 00:00:00.002,  timeCost: 0.0%,  blocked: 0.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"27\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"25\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_raw_delta_apps_part2; tablePath=s3a://wix-bi-sunduk/baguild/5615bb13-774d-4bee-9d6c-e5cbffc8263d; columnHandles=[[action_type, varchar(16), 1], [app_id, varchar, 2], [diff_instance_date, timestamp, 3], [diff_instance_reason, varchar(16), 4], [diff_msid_date, timestamp, 5], [diff_msid_reason, varchar(16), 6], [diff_uuid_date, timestamp, 7], [diff_uuid_reason, varchar(16), 8], [event_type, varchar(5), 9], [initiator_name, varchar, 10], [instance_id, varchar, 11], [is_published, boolean, 12], [msid, varchar, 13], [open_date, timestamp, 14], [uuid, varchar, 15], [was_demo, boolean, 16], [app_revoke_date, timestamp, 17], [site_delete_date, timestamp, 18], [site_transfer_date, timestamp, 19]], hash=-59256176]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"786\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"654\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"26\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_type := action_type\\napp_id := app_id\\ndiff_instance_date := diff_instance_date\\ndiff_instance_reason := diff_instance_reason\\ndiff_msid_date := diff_msid_date\\ndiff_msid_reason := diff_msid_reason\\ndiff_uuid_date := diff_uuid_date\\ndiff_uuid_reason := diff_uuid_reason\\nevent_type := event_type\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nuuid := uuid\\nwas_demo := was_demo\\napp_revoke_date := min\\nsite_delete_date := min_57\\nsite_transfer_date := min_58\\n\",\n  \"children\" : [ {\n    \"id\" : \"785\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"910\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"20\",\n        \"name\" : \"Aggregate(FINAL)[action_type, app_id, diff_instance_date, diff_instance_reason, diff_msid_date, diff_msid_reason, diff_uuid_date, diff_uuid_reason, event_type, initiator_name, instance_id, is_published, msid, open_date, uuid, was_demo][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_135\\\")\\nmin_57 := min(\\\"min_136\\\")\\nmin_58 := min(\\\"min_137\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"818\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"action_type\\\", \\\"app_id\\\", \\\"diff_instance_date\\\", \\\"diff_instance_reason\\\", \\\"diff_msid_date\\\", \\\"diff_msid_reason\\\", \\\"diff_uuid_date\\\", \\\"diff_uuid_reason\\\", \\\"event_type\\\", \\\"initiator_name\\\", \\\"instance_id\\\", \\\"is_published\\\", \\\"msid\\\", \\\"open_date\\\", \\\"uuid\\\", \\\"was_demo\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"816\",\n            \"name\" : \"Aggregate(PARTIAL)[action_type, app_id, diff_instance_date, diff_instance_reason, diff_msid_date, diff_msid_reason, diff_uuid_date, diff_uuid_reason, event_type, initiator_name, instance_id, is_published, msid, open_date, uuid, was_demo][$hashvalue_151]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_137 := min(\\\"expr_41\\\")\\nmin_135 := min(\\\"expr_39\\\")\\nmin_136 := min(\\\"expr_40\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"18\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_39 := (CASE WHEN (\\\"open_date\\\" < \\\"date_created\\\") THEN \\\"date_created\\\" END)\\nexpr_40 := (CASE WHEN (\\\"open_date\\\" < \\\"date_created_13\\\") THEN \\\"date_created_13\\\" END)\\nexpr_41 := (CASE WHEN (\\\"open_date\\\" < \\\"date_created_17\\\") THEN \\\"date_created_17\\\" END)\\n$hashvalue_151 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"action_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_instance_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_instance_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_msid_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_msid_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_uuid_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"diff_uuid_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"event_type\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"16\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"msid\\\" = \\\"origin_msid\\\")][$hashvalue_138, $hashvalue_148]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"9\",\n                  \"name\" : \"LeftJoin\",\n                  \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_14\\\")][$hashvalue_138, $hashvalue_145]\",\n                  \"details\" : \"Distribution: PARTITIONED\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"650\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[2]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"2\" ]\n                  }, {\n                    \"id\" : \"782\",\n                    \"name\" : \"LocalExchange\",\n                    \"identifier\" : \"[HASH][$hashvalue_145] (\\\"msid_14\\\")\",\n                    \"details\" : \"\",\n                    \"children\" : [ {\n                      \"id\" : \"651\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[5]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"5\" ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                }, {\n                  \"id\" : \"783\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_148] (\\\"origin_msid\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"653\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[6]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"6\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"907\",\n  \"name\" : \"Project\",\n  \"identifier\" : \"[]\",\n  \"details\" : \"$hashvalue_144 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\n\",\n  \"children\" : [ {\n    \"id\" : \"4\",\n    \"name\" : \"LeftJoin\",\n    \"identifier\" : \"[(\\\"app_id\\\" = \\\"app_id_1\\\") AND (\\\"instance_id\\\" = \\\"instance_id_4\\\")][$hashvalue_139, $hashvalue_141]\",\n    \"details\" : \"Distribution: PARTITIONED\\n\",\n    \"children\" : [ {\n      \"id\" : \"648\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[3]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"3\" ]\n    }, {\n      \"id\" : \"781\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[HASH][$hashvalue_141] (\\\"app_id_1\\\", \\\"instance_id_4\\\")\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"649\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[4]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"4\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": [
                                    {
                                        "stageId": "3",
                                        "plan": "{\n  \"id\" : \"905\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_2', folderName='7f1a6b7f-77c3-4597-988b-fbc9eec42b7e', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar))))]\",\n  \"details\" : \"$hashvalue_140 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0))\\nopen_date := [open_date, timestamp, 13]\\ndiff_uuid_reason := [diff_uuid_reason, varchar(16), 7]\\naction_type := [action_type, varchar(16), 0]\\nis_published := [is_published, boolean, 11]\\ndiff_instance_date := [diff_instance_date, timestamp, 2]\\nuuid := [uuid, varchar, 14]\\ndiff_uuid_date := [diff_uuid_date, timestamp, 6]\\nmsid := [msid, varchar, 12]\\ninstance_id := [instance_id, varchar, 10]\\nevent_type := [event_type, varchar(5), 8]\\nwas_demo := [was_demo, boolean, 15]\\ninitiator_name := [initiator_name, varchar, 9]\\ndiff_msid_reason := [diff_msid_reason, varchar(16), 5]\\ndiff_msid_date := [diff_msid_date, timestamp, 4]\\ndiff_instance_reason := [diff_instance_reason, varchar(16), 3]\\napp_id := [app_id, varchar, 1]\\n    :: [(<min>, 135c3d92-0fea-1f9d-2ba5-2a1dfb04297e), (135c3d92-0fea-1f9d-2ba5-2a1dfb04297e, 139ef4fa-c108-8f9a-c7be-d5f492a2c939), (139ef4fa-c108-8f9a-c7be-d5f492a2c939, 13ee94c1-b635-8505-3391-97919052c16f), (13ee94c1-b635-8505-3391-97919052c16f, 141fbfae-511e-6817-c9f0-48993a7547d1), (141fbfae-511e-6817-c9f0-48993a7547d1, 1480c568-5cbd-9392-5604-1148f5faffa0), (1480c568-5cbd-9392-5604-1148f5faffa0, 14bca956-e09f-f4d6-14d7-466cb3f09103), (14bca956-e09f-f4d6-14d7-466cb3f09103, 150ae7ee-c74a-eecd-d3d7-2112895b988a), (150ae7ee-c74a-eecd-d3d7-2112895b988a, <max>)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                        "subStages": []
                                    },
                                    {
                                        "stageId": "4",
                                        "plan": "{\n  \"id\" : \"906\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_revokes_delta', folderName='4f10f360-ac09-4b9e-bd79-152398442ee7', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [date_created,timestamp,false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"app_id_1\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar))))]\",\n  \"details\" : \"$hashvalue_143 := combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_1\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_4\\\"), 0))\\ndate_created := [date_created, timestamp, 2]\\ninstance_id_4 := [instance_id, varchar, 5]\\napp_id_1 := [app_id, varchar, 1]\\n    :: [(<min>, 135c3d92-0fea-1f9d-2ba5-2a1dfb04297e), (135c3d92-0fea-1f9d-2ba5-2a1dfb04297e, 139ef4fa-c108-8f9a-c7be-d5f492a2c939), (139ef4fa-c108-8f9a-c7be-d5f492a2c939, 13ee94c1-b635-8505-3391-97919052c16f), (13ee94c1-b635-8505-3391-97919052c16f, 141fbfae-511e-6817-c9f0-48993a7547d1), (141fbfae-511e-6817-c9f0-48993a7547d1, 1480c568-5cbd-9392-5604-1148f5faffa0), (1480c568-5cbd-9392-5604-1148f5faffa0, 14bca956-e09f-f4d6-14d7-466cb3f09103), (14bca956-e09f-f4d6-14d7-466cb3f09103, 150ae7ee-c74a-eecd-d3d7-2112895b988a), (150ae7ee-c74a-eecd-d3d7-2112895b988a, <max>)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                        "subStages": []
                                    }
                                ]
                            },
                            {
                                "stageId": "5",
                                "plan": "{\n  \"id\" : \"908\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_delete_site_delta', folderName='e7fe6106-26b0-47bf-9f27-41d869c30bac', columns='[[action_type,varchar(11),false], [date_created,timestamp,false], [msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_147 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_14\\\"), 0))\\nmsid_14 := [msid, varchar, 2]\\ndate_created_13 := [date_created, timestamp, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "6",
                                "plan": "{\n  \"id\" : \"909\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='slowly_transfer_site_new_delta', folderName='5f32479c-ba39-454f-852b-f2c35732f970', columns='[[date_created,timestamp,false], [is_published,boolean,false], [is_real_site,boolean,false], [last_publish_date,timestamp,false], [msid,varchar,false], [origin_msid,varchar,false], [origin_uuid,varchar,false], [transfer_type,varchar(11),false], [uuid,varchar,false]]'}, filterPredicate = ((\\\"date_created_17\\\" >= \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593648000000)) AND (\\\"date_created_17\\\" < \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(1593734400000)))]\",\n  \"details\" : \"$hashvalue_150 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"origin_msid\\\"), 0))\\norigin_msid := [origin_msid, varchar, 5]\\ndate_created_17 := [date_created, timestamp, 0]\\n    :: [[2020-07-02 00:00:00.000, 2020-07-03 00:00:00.000)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_023336_13034_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_log_final_delta -- 194012912\nAS\n    \nwith a AS (\n    SELECT  uuid\n            , msid\n            , app_id\n            , instance_id\n            , open_date\n            , was_demo\n            , initiator_name\n            , action_type AS open_reason\n            , event_type\n            , is_published\n            , least (   coalesce(diff_instance_date, date '2099-12-31')\n                        , coalesce(diff_msid_date, date '2099-12-31')\n                        , coalesce(diff_uuid_date, date '2099-12-31')\n                        , coalesce(app_revoke_date, date '2099-12-31')\n                        , coalesce(site_delete_date, date '2099-12-31')\n                        , coalesce(site_transfer_date, date '2099-12-31')\n                    ) as close_date\n            , case  when site_delete_date   =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'delete_site'\n                    when site_transfer_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'transfer_site'\n                    when app_revoke_date    =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'remove_app'\n                    when diff_msid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then diff_msid_reason\n                    when diff_instance_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then diff_instance_reason\n                    when diff_uuid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then diff_uuid_reason\n                    else null\n                    end AS close_reason\n            , case  when site_delete_date   =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'delete_site'\n                    when site_transfer_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'transfer_site'\n                    when app_revoke_date    =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'remove_app'\n                    when diff_msid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'diff_msid'\n                    when diff_instance_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'diff_instance'\n                    when diff_uuid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'diff_uuid'\n                    else null\n                    end AS close_type\n    FROM sunduk.baguild.slowly_log_raw_delta_apps_part1\nUNION ALL\n    SELECT  uuid\n            , msid\n            , app_id\n            , instance_id\n            , open_date\n            , was_demo\n            , initiator_name\n            , action_type AS open_reason\n            , event_type\n            , is_published\n            , least (   coalesce(diff_instance_date, date '2099-12-31')\n                        , coalesce(diff_msid_date, date '2099-12-31')\n                        , coalesce(diff_uuid_date, date '2099-12-31')\n                        , coalesce(app_revoke_date, date '2099-12-31')\n                        , coalesce(site_delete_date, date '2099-12-31')\n                        , coalesce(site_transfer_date, date '2099-12-31')\n                    ) as close_date\n            , case  when site_delete_date   =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'delete_site'\n                    when site_transfer_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'transfer_site'\n                    when app_revoke_date    =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'remove_app'\n                    when diff_msid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then diff_msid_reason\n                    when diff_instance_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then diff_instance_reason\n                    when diff_uuid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then diff_uuid_reason\n                    else null\n                    end AS close_reason\n            , case  when site_delete_date   =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'delete_site'\n                    when site_transfer_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'transfer_site'\n                    when app_revoke_date    =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'remove_app'\n                    when diff_msid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'diff_msid'\n                    when diff_instance_date =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'diff_instance'\n                    when diff_uuid_date     =least (coalesce(diff_instance_date, date '2099-12-31'), coalesce(diff_uuid_date, date '2099-12-31'), coalesce(diff_msid_date, date '2099-12-31'), coalesce(app_revoke_date, date '2099-12-31'), coalesce(site_delete_date, date '2099-12-31'), coalesce(site_transfer_date, date '2099-12-31'))\n                        then 'diff_uuid'\n                    else null\n                    end AS close_type\n    FROM sunduk.baguild.slowly_log_raw_delta_apps_part2\n    )\n    \n,b AS (\n    SELECT  *\n            , lag(close_date,1) over (partition by msid, app_id, instance_id order by open_date asc)  AS prev_close_date\n    FROM a\n    )\n    \n    SELECT  uuid\n            , msid\n            , app_id\n            , instance_id\n            , open_date\n            , was_demo\n            , initiator_name\n            , open_reason\n            , close_date\n            , case  when coalesce(close_reason, 'add_app') in ('add_app', 'remove_app', 'delete_site') then close_reason\n                    when close_reason like 'transfer%' then 'transfer_site'\n                    else 'unknown' end as close_reason\n            , is_published\n    FROM b\n    WHERE open_date>=coalesce(prev_close_date, open_date)",
            "queryName": "create sunduk.baguild.slowly_log_final_delta",
            "queryStats": {
                "elapsedTime": "21.88m",
                "planningTime": "1.01s",
                "analysisTime": "290.17ms",
                "queuedTime": "1.20ms",
                "executionTime": "21.87m",
                "totalCpuTime": "4.75h",
                "rawInputDataSize": "60.48GB",
                "internalNetworkInputDataSize": "197.60GB",
                "physicalInputDataSize": "60.48GB",
                "processedInputDataSize": "60.48GB",
                "rawInputPositions": "955463175",
                "internalNetworkInputPositions": "955463191",
                "physicalInputPositions": "955463175",
                "processedInputPositions": "955463175",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "192.80GB",
                "writtenPositions": "955459418",
                "peakTotalMemoryReservation": "211.67GB",
                "peakTaskTotalMemory": "13.23GB",
                "totalSplits": 661,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.slowly_log_raw_delta_apps_part1",
                    "sunduk.baguild.slowly_log_raw_delta_apps_part2"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "21.85m",
                    "totalQueuedTime": "1.04ms",
                    "totalScheduledTime": "891.71ms",
                    "totalCpuTime": "57.81ms",
                    "totalBlockedTime": "1.82h",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "5.93m",
                    "totalQueuedTime": "921.44ms",
                    "totalScheduledTime": "4.05h",
                    "totalCpuTime": "3.74h",
                    "totalBlockedTime": "4.07h",
                    "rawInputDataSize": "197.60GB",
                    "internalNetworkInputDataSize": "197.60GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "208.80GB",
                    "rawInputPositions": "955463175",
                    "internalNetworkInputPositions": "955463175",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "955463175",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 208,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "15.62s",
                    "totalQueuedTime": "8.41m",
                    "totalScheduledTime": "32.31m",
                    "totalCpuTime": "23.64m",
                    "totalBlockedTime": "59.29s",
                    "rawInputDataSize": "16.18GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "16.18GB",
                    "processedInputDataSize": "16.18GB",
                    "rawInputPositions": "368021497",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "368021497",
                    "processedInputPositions": "368021497",
                    "outputDataSize": "80.65GB",
                    "outputPositions": "368021497",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 176,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "26.89s",
                    "totalQueuedTime": "33.00m",
                    "totalScheduledTime": "44.93m",
                    "totalCpuTime": "36.83m",
                    "totalBlockedTime": "7.13m",
                    "rawInputDataSize": "44.29GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "44.29GB",
                    "processedInputDataSize": "44.29GB",
                    "rawInputPositions": "587441678",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "587441678",
                    "processedInputPositions": "587441678",
                    "outputDataSize": "128.24GB",
                    "outputPositions": "587441678",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 01:49:12.908,  cpu: 00:00:00.057,  blocked: 01:49:12.000,  queue: 00:00:00.001,  scheduled: 00:00:00.891 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.890,  finishWall: 00:00:00.000)  other: 00:00:00.015,  timeCost: 0.0%,  blocked: 100.0%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  181.2/208  elapsed: 17:53:40.762,  cpu: 03:44:24.000,  blocked: 04:04:12.000,  queue: 00:00:00.921,  scheduled: 04:03:00.000 (addInputWall: 00:45:27.472,  getOutputWall: 03:11:28.790,  finishWall: 00:05:37.160)  other: 09:46:27.841,  timeCost: 75.9%,  blocked: 22.7%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  173.0/176  elapsed: 00:45:01.825,  cpu: 00:23:38.400,  blocked: 00:00:59.290,  queue: 00:08:24.308,  scheduled: 00:32:18.600 (addInputWall: 00:12:07.200,  getOutputWall: 00:24:36.000,  finishWall: 00:00:01.500)  other: 00:03:19.626,  timeCost: 10.1%,  blocked: 2.2%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.9"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "WARN",
                    "message": "High avg CPU usage 52.50%, the most consuming operator ScanFilterAndProjectOperator (36.89%)"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail task detected: Max/P90=2.2"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "44"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(1.48GB)/P50(67.30MB) = 22.5 times"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  205.4/272  elapsed: 01:32:01.583,  cpu: 00:36:49.800,  blocked: 00:07:07.800,  queue: 00:32:59.711,  scheduled: 00:44:55.800 (addInputWall: 00:24:28.800,  getOutputWall: 00:33:07.199,  finishWall: 00:00:02.260)  other: 00:06:58.271,  timeCost: 14.0%,  blocked: 7.7%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"24\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"22\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_log_final_delta; tablePath=s3a://wix-bi-sunduk/baguild/740566f6-2137-442d-85ca-11ab3a83e978; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [open_date, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [open_reason, varchar(16), 8], [close_date, timestamp, 9], [close_reason, varchar(16), 10], [is_published, boolean, 11]], hash=-517325695]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"622\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"534\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"23\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid_69\\nmsid := msid_70\\napp_id := app_id_71\\ninstance_id := instance_id_72\\nopen_date := open_date_73\\nwas_demo := was_demo_74\\ninitiator_name := initiator_name_75\\nopen_reason := action_type_76\\nclose_date := least_79\\nclose_reason := expr_204\\nis_published := is_published_78\\n\",\n  \"children\" : [ {\n    \"id\" : \"621\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"18\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"expr_204 := (CASE WHEN (COALESCE(\\\"expr_80\\\", CAST('add_app' AS varchar(16))) IN (CAST('add_app' AS varchar(16)), CAST('remove_app' AS varchar(16)), CAST('delete_site' AS varchar(16)))) THEN \\\"expr_80\\\" WHEN like(\\\"expr_80\\\", \\\"$like_pattern\\\"('transfer%')) THEN CAST('transfer_site' AS varchar(16)) ELSE CAST('unknown' AS varchar(16)) END)\\n\",\n      \"children\" : [ {\n        \"id\" : \"12\",\n        \"name\" : \"FilterProject\",\n        \"identifier\" : \"[filterPredicate = (\\\"open_date_73\\\" >= COALESCE(\\\"lag\\\", \\\"open_date_73\\\"))]\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"688\",\n          \"name\" : \"Project\",\n          \"identifier\" : \"[]\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"11\",\n            \"name\" : \"Window\",\n            \"identifier\" : \"[partition by (msid_70, app_id_71, instance_id_72), order by (open_date_73 ASC_NULLS_LAST)][$hashvalue]\",\n            \"details\" : \"lag := lag(\\\"least_79\\\", \\\"expr_121\\\") RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\n\",\n            \"children\" : [ {\n              \"id\" : \"620\",\n              \"name\" : \"LocalExchange\",\n              \"identifier\" : \"[HASH][$hashvalue] (\\\"msid_70\\\", \\\"app_id_71\\\", \\\"instance_id_72\\\")\",\n              \"details\" : \"\",\n              \"children\" : [ {\n                \"id\" : \"532\",\n                \"name\" : \"RemoteSource\",\n                \"identifier\" : \"[2]\",\n                \"details\" : \"\",\n                \"children\" : [ ],\n                \"remoteSources\" : [ \"2\" ]\n              }, {\n                \"id\" : \"533\",\n                \"name\" : \"RemoteSource\",\n                \"identifier\" : \"[3]\",\n                \"details\" : \"\",\n                \"children\" : [ ],\n                \"remoteSources\" : [ \"3\" ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"297\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_apps_part1', folderName='64f9ea8b-64e8-4d2e-b6e6-3fab42cec3df', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [app_revoke_date,timestamp,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [site_delete_date,timestamp,false], [site_transfer_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"least_245 := least(COALESCE(\\\"diff_instance_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date\\\", \\\"$literal$\\\"(4102358400000)))\\nexpr_246 := BIGINT '1'\\nexpr_244 := (CASE WHEN (\\\"site_delete_date\\\" = least(COALESCE(\\\"diff_instance_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date\\\", \\\"$literal$\\\"(4102358400000)))) THEN CAST('delete_site' AS varchar(16)) WHEN (\\\"site_transfer_date\\\" = least(COALESCE(\\\"diff_instance_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date\\\", \\\"$literal$\\\"(4102358400000)))) THEN CAST('transfer_site' AS varchar(16)) WHEN (\\\"app_revoke_date\\\" = least(COALESCE(\\\"diff_instance_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date\\\", \\\"$literal$\\\"(4102358400000)))) THEN CAST('remove_app' AS varchar(16)) WHEN (\\\"diff_msid_date\\\" = least(COALESCE(\\\"diff_instance_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date\\\", \\\"$literal$\\\"(4102358400000)))) THEN \\\"diff_msid_reason\\\" WHEN (\\\"diff_instance_date\\\" = least(COALESCE(\\\"diff_instance_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date\\\", \\\"$literal$\\\"(4102358400000)))) THEN \\\"diff_instance_reason\\\" WHEN (\\\"diff_uuid_date\\\" = least(COALESCE(\\\"diff_instance_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date\\\", \\\"$literal$\\\"(4102358400000)))) THEN \\\"diff_uuid_reason\\\" END)\\n$hashvalue_264 := combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0))\\nopen_date := [open_date, timestamp, 14]\\ndiff_uuid_reason := [diff_uuid_reason, varchar(16), 8]\\naction_type := [action_type, varchar(16), 0]\\nis_published := [is_published, boolean, 12]\\ndiff_instance_date := [diff_instance_date, timestamp, 3]\\nuuid := [uuid, varchar, 17]\\ndiff_uuid_date := [diff_uuid_date, timestamp, 7]\\napp_revoke_date := [app_revoke_date, timestamp, 2]\\nsite_transfer_date := [site_transfer_date, timestamp, 16]\\nmsid := [msid, varchar, 13]\\ninstance_id := [instance_id, varchar, 11]\\nwas_demo := [was_demo, boolean, 18]\\nsite_delete_date := [site_delete_date, timestamp, 15]\\ninitiator_name := [initiator_name, varchar, 10]\\ndiff_msid_reason := [diff_msid_reason, varchar(16), 6]\\ndiff_msid_date := [diff_msid_date, timestamp, 5]\\ndiff_instance_reason := [diff_instance_reason, varchar(16), 4]\\napp_id := [app_id, varchar, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"298\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_raw_delta_apps_part2', folderName='5615bb13-774d-4bee-9d6c-e5cbffc8263d', columns='[[action_type,varchar(16),false], [app_id,varchar,false], [app_revoke_date,timestamp,false], [diff_instance_date,timestamp,false], [diff_instance_reason,varchar(16),false], [diff_msid_date,timestamp,false], [diff_msid_reason,varchar(16),false], [diff_uuid_date,timestamp,false], [diff_uuid_reason,varchar(16),false], [event_type,varchar(5),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [site_delete_date,timestamp,false], [site_transfer_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"least_257 := least(COALESCE(\\\"diff_instance_date_27\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date_29\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date_31\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date_26\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date_39\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date_40\\\", \\\"$literal$\\\"(4102358400000)))\\nexpr_258 := BIGINT '1'\\nexpr_256 := (CASE WHEN (\\\"site_delete_date_39\\\" = least(COALESCE(\\\"diff_instance_date_27\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date_31\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date_29\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date_26\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date_39\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date_40\\\", \\\"$literal$\\\"(4102358400000)))) THEN CAST('delete_site' AS varchar(16)) WHEN (\\\"site_transfer_date_40\\\" = least(COALESCE(\\\"diff_instance_date_27\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date_31\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date_29\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date_26\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date_39\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date_40\\\", \\\"$literal$\\\"(4102358400000)))) THEN CAST('transfer_site' AS varchar(16)) WHEN (\\\"app_revoke_date_26\\\" = least(COALESCE(\\\"diff_instance_date_27\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date_31\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date_29\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date_26\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date_39\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date_40\\\", \\\"$literal$\\\"(4102358400000)))) THEN CAST('remove_app' AS varchar(16)) WHEN (\\\"diff_msid_date_29\\\" = least(COALESCE(\\\"diff_instance_date_27\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date_31\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date_29\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date_26\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date_39\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date_40\\\", \\\"$literal$\\\"(4102358400000)))) THEN \\\"diff_msid_reason_30\\\" WHEN (\\\"diff_instance_date_27\\\" = least(COALESCE(\\\"diff_instance_date_27\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date_31\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date_29\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date_26\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date_39\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date_40\\\", \\\"$literal$\\\"(4102358400000)))) THEN \\\"diff_instance_reason_28\\\" WHEN (\\\"diff_uuid_date_31\\\" = least(COALESCE(\\\"diff_instance_date_27\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_uuid_date_31\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"diff_msid_date_29\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"app_revoke_date_26\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_delete_date_39\\\", \\\"$literal$\\\"(4102358400000)), COALESCE(\\\"site_transfer_date_40\\\", \\\"$literal$\\\"(4102358400000)))) THEN \\\"diff_uuid_reason_32\\\" END)\\n$hashvalue_266 := combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_37\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id_25\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id_35\\\"), 0))\\ndiff_msid_reason_30 := [diff_msid_reason, varchar(16), 6]\\ndiff_uuid_date_31 := [diff_uuid_date, timestamp, 7]\\napp_revoke_date_26 := [app_revoke_date, timestamp, 2]\\nwas_demo_42 := [was_demo, boolean, 18]\\naction_type_24 := [action_type, varchar(16), 0]\\nsite_transfer_date_40 := [site_transfer_date, timestamp, 16]\\nopen_date_38 := [open_date, timestamp, 14]\\ninitiator_name_34 := [initiator_name, varchar, 10]\\nsite_delete_date_39 := [site_delete_date, timestamp, 15]\\ndiff_instance_reason_28 := [diff_instance_reason, varchar(16), 4]\\ninstance_id_35 := [instance_id, varchar, 11]\\nuuid_41 := [uuid, varchar, 17]\\napp_id_25 := [app_id, varchar, 1]\\nmsid_37 := [msid, varchar, 13]\\ndiff_uuid_reason_32 := [diff_uuid_reason, varchar(16), 8]\\ndiff_instance_date_27 := [diff_instance_date, timestamp, 3]\\nis_published_36 := [is_published, boolean, 12]\\ndiff_msid_date_29 := [diff_msid_date, timestamp, 5]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_025529_14503_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  prod.verticals.unpublish_sites_delta --13898\nAS\n    SELECT msid\n    FROM sunduk.baguild.pavelk_unpublish_events_delta\n    WHERE   msid is not null\n    GROUP by 1",
            "queryName": "create prod.verticals.unpublish_sites_delta",
            "queryStats": {
                "elapsedTime": "2.89s",
                "planningTime": "714.68ms",
                "analysisTime": "194.76ms",
                "queuedTime": "152.54us",
                "executionTime": "2.70s",
                "totalCpuTime": "523.00ms",
                "rawInputDataSize": "137.07MB",
                "internalNetworkInputDataSize": "460.43kB",
                "physicalInputDataSize": "137.07MB",
                "processedInputDataSize": "137.07MB",
                "rawInputPositions": "9804",
                "internalNetworkInputPositions": "9434",
                "physicalInputPositions": "9804",
                "processedInputPositions": "9804",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "377kB",
                "writtenPositions": "9417",
                "peakTotalMemoryReservation": "165.31kB",
                "peakTaskTotalMemory": "21.56kB",
                "totalSplits": 172,
                "connectorSplits": "0",
                "numberOfWorkers": 49,
                "connectorTables": [
                    "sunduk.baguild.pavelk_unpublish_events_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.98s",
                    "totalQueuedTime": "1.63ms",
                    "totalScheduledTime": "801.18ms",
                    "totalCpuTime": "21.75ms",
                    "totalBlockedTime": "5.87s",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "988.00ms",
                    "totalQueuedTime": "122.34ms",
                    "totalScheduledTime": "2.28s",
                    "totalCpuTime": "157.66ms",
                    "totalBlockedTime": "2.00m",
                    "rawInputDataSize": "459.44kB",
                    "internalNetworkInputDataSize": "459.44kB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "459.85kB",
                    "rawInputPositions": "9418",
                    "internalNetworkInputPositions": "9418",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "9418",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 144,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "312.00ms",
                    "totalQueuedTime": "10.93ms",
                    "totalScheduledTime": "4.18s",
                    "totalCpuTime": "342.63ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "137.07MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "137.07MB",
                    "processedInputDataSize": "137.07MB",
                    "rawInputPositions": "9804",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "9804",
                    "processedInputPositions": "9804",
                    "outputDataSize": "459.84kB",
                    "outputPositions": "9418",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 23,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    3.4/5    elapsed: 00:00:06.675,  cpu: 00:00:00.021,  blocked: 00:00:05.870,  queue: 00:00:00.001,  scheduled: 00:00:00.801 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.799,  finishWall: 00:00:00.000)  other: 00:00:00.002,  timeCost: 11.0%,  blocked: 87.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  126.3/144  elapsed: 00:02:04.758,  cpu: 00:00:00.157,  blocked: 00:02:00.000,  queue: 00:00:00.122,  scheduled: 00:00:02.280 (addInputWall: 00:00:00.039,  getOutputWall: 00:00:00.043,  finishWall: 00:00:02.164)  other: 00:00:02.355,  timeCost: 31.4%,  blocked: 96.2%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2   13.5/23   elapsed: 00:00:04.196,  cpu: 00:00:00.342,  blocked: 00:00:00.000,  queue: 00:00:00.010,  scheduled: 00:00:04.180 (addInputWall: 00:00:04.275,  getOutputWall: 00:00:04.011,  finishWall: 00:00:00.166)  other: 00:00:00.005,  timeCost: 57.6%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.7"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 99.7 of data dropped"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "8"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(56.05MB)/P50(32.32kB) = 1775.8 times"
                },
                {
                    "source": {
                        "stageId": "2",
                        "taskId": "9"
                    },
                    "level": "INFO",
                    "message": "Long tail task detected: Max/P90=2.2"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"11\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"9\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[prod:connectorId=prod; schemaName=verticals; tableName=unpublish_sites_delta; tablePath=s3a://wix-bi-data-warehouse/dynamic/e6718c84-652e-486d-9cb9-609b0dcec3e5; columnHandles=[[msid, varchar, 1]], hash=999679114]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"277\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"230\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"10\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"msid := msid\\n\",\n  \"children\" : [ {\n    \"id\" : \"276\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"341\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"4\",\n        \"name\" : \"Aggregate(FINAL)[msid][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"293\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"msid\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"299\",\n            \"name\" : \"RemoteSource\",\n            \"identifier\" : \"[2]\",\n            \"details\" : \"\",\n            \"children\" : [ ],\n            \"remoteSources\" : [ \"2\" ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"297\",\n  \"name\" : \"Aggregate(PARTIAL)[msid][$hashvalue_5]\",\n  \"identifier\" : \"\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"340\",\n    \"name\" : \"ScanFilterProject\",\n    \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_unpublish_events_delta', folderName='6527a6af-fc0f-4f8c-b791-13a85c5540d7', columns='[[action_type,varchar(14),false], [date_created,timestamp,false], [msid,varchar,false]]'}, filterPredicate = (NOT (\\\"msid\\\" IS NULL))]\",\n    \"details\" : \"$hashvalue_5 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nmsid := [msid, varchar, 2]\\n    :: [(<min>, <max>)]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_025532_14507_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_temppp\nAS\n\n    SELECT a.*\n    FROM        sunduk.baguild.slowly_log_final_delta         a\n    where a.msid not in (select msid from prod.verticals.unpublish_sites_delta)\n    --LEFT JOIN   prod.verticals.unpublish_sites_delta    b ON  a.msid=b.msid\n    --WHERE b.msid is null",
            "queryName": "create sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_temppp",
            "queryStats": {
                "elapsedTime": "23.00m",
                "planningTime": "763.89ms",
                "analysisTime": "294.44ms",
                "queuedTime": "4.12ms",
                "executionTime": "23.00m",
                "totalCpuTime": "1.57h",
                "rawInputDataSize": "40.45GB",
                "internalNetworkInputDataSize": "190.49GB",
                "physicalInputDataSize": "40.45GB",
                "processedInputDataSize": "40.45GB",
                "rawInputPositions": "955468835",
                "internalNetworkInputPositions": "955469091",
                "physicalInputPositions": "955468835",
                "processedInputPositions": "955468835",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "192.74GB",
                "writtenPositions": "955265040",
                "peakTotalMemoryReservation": "2.38GB",
                "peakTaskTotalMemory": "308.33MB",
                "totalSplits": 565,
                "connectorSplits": "0",
                "numberOfWorkers": 48,
                "connectorTables": [
                    "prod.verticals.unpublish_sites_delta",
                    "sunduk.baguild.slowly_log_final_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "22.98m",
                    "totalQueuedTime": "968.18us",
                    "totalScheduledTime": "1.06s",
                    "totalCpuTime": "58.56ms",
                    "totalBlockedTime": "1.91h",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "22.97m",
                    "totalQueuedTime": "80.78ms",
                    "totalScheduledTime": "48.54m",
                    "totalCpuTime": "39.64m",
                    "totalBlockedTime": "11.35h",
                    "rawInputDataSize": "190.49GB",
                    "internalNetworkInputDataSize": "190.49GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "200.83GB",
                    "rawInputPositions": "955469075",
                    "internalNetworkInputPositions": "955469075",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "955469075",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 160,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "19.87m",
                    "totalQueuedTime": "16.48h",
                    "totalScheduledTime": "1.11h",
                    "totalCpuTime": "54.26m",
                    "totalBlockedTime": "13.79h",
                    "rawInputDataSize": "40.45GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "40.45GB",
                    "processedInputDataSize": "40.45GB",
                    "rawInputPositions": "955459418",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955459418",
                    "processedInputPositions": "955459418",
                    "outputDataSize": "200.84GB",
                    "outputPositions": "955459418",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 384,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "102.00ms",
                    "totalQueuedTime": "4.93ms",
                    "totalScheduledTime": "1.12s",
                    "totalCpuTime": "178.49ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "0B",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "0B",
                    "rawInputPositions": "9417",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "9417",
                    "processedInputPositions": "9417",
                    "outputDataSize": "471.53kB",
                    "outputPositions": "9657",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 01:54:50.690,  cpu: 00:00:00.058,  blocked: 01:54:36.000,  queue: 00:00:00.000,  scheduled: 00:00:01.060 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.050,  finishWall: 00:00:00.000)  other: 00:00:13.629,  timeCost: 0.0%,  blocked: 99.8%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   74.1/160  elapsed: 28:22:17.120,  cpu: 00:39:38.400,  blocked: 11:21:00.000,  queue: 00:00:00.080,  scheduled: 00:48:32.400 (addInputWall: 00:38:27.387,  getOutputWall: 00:03:07.456,  finishWall: 00:06:55.202)  other: 16:12:44.639,  timeCost: 42.1%,  blocked: 40.0%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  132.6/384  elapsed: 43:53:27.754,  cpu: 00:54:15.600,  blocked: 13:47:24.000,  queue: 16:28:46.680,  scheduled: 01:06:36.000 (addInputWall: 00:29:28.200,  getOutputWall: 00:47:37.800,  finishWall: 00:00:04.110)  other: 12:30:41.073,  timeCost: 57.8%,  blocked: 31.4%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   11.0/16   elapsed: 00:00:01.121,  cpu: 00:00:00.178,  blocked: 00:00:00.000,  queue: 00:00:00.004,  scheduled: 00:00:01.120 (addInputWall: 00:00:00.001,  getOutputWall: 00:00:01.100,  finishWall: 00:00:00.016)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 0.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"17\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"15\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_publish_temp_never_unpublish_sites_delta_temppp; tablePath=s3a://wix-bi-sunduk/baguild/05d360e1-f7d0-44cb-9f18-22c8752e30d8; columnHandles=[[app_id, varchar, 1], [close_date, timestamp, 2], [close_reason, varchar(16), 3], [initiator_name, varchar, 4], [instance_id, varchar, 5], [is_published, boolean, 6], [msid, varchar, 7], [open_date, timestamp, 8], [open_reason, varchar(16), 9], [uuid, varchar, 10], [was_demo, boolean, 11]], hash=-1546997319]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"393\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"329\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"16\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\nclose_date := close_date\\nclose_reason := close_reason\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nopen_reason := open_reason\\nuuid := uuid\\nwas_demo := was_demo\\n\",\n  \"children\" : [ {\n    \"id\" : \"392\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"11\",\n      \"name\" : \"FilterProject\",\n      \"identifier\" : \"[filterPredicate = (NOT \\\"expr_6\\\")]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"448\",\n        \"name\" : \"Project\",\n        \"identifier\" : \"[]\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"159\",\n          \"name\" : \"SemiJoin\",\n          \"identifier\" : \"[msid = msid_0][$hashvalue, $hashvalue_52]\",\n          \"details\" : \"Distribution: PARTITIONED\\n\",\n          \"children\" : [ {\n            \"id\" : \"327\",\n            \"name\" : \"RemoteSource\",\n            \"identifier\" : \"[2]\",\n            \"details\" : \"\",\n            \"children\" : [ ],\n            \"remoteSources\" : [ \"2\" ]\n          }, {\n            \"id\" : \"391\",\n            \"name\" : \"LocalExchange\",\n            \"identifier\" : \"[SINGLE] ()\",\n            \"details\" : \"\",\n            \"children\" : [ {\n              \"id\" : \"328\",\n              \"name\" : \"RemoteSource\",\n              \"identifier\" : \"[3]\",\n              \"details\" : \"\",\n              \"children\" : [ ],\n              \"remoteSources\" : [ \"3\" ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"446\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_final_delta', folderName='740566f6-2137-442d-85ca-11ab3a83e978', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_51 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 10]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"447\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='unpublish_sites_delta', folderName='e6718c84-652e-486d-9cb9-609b0dcec3e5', columns='[[msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_54 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_0\\\"), 0))\\nmsid_0 := [msid, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_031852_16022_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p1 \nAS\n\n    SELECT a.*, min(case when date_created >= open_date and date_created < close_date then date_created end) as publish_date\n    FROM        sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_temppp         a\n    LEFT JOIN   sunduk.baguild.pavelk_publish_events_delta    b ON  a.msid=b.msid\n    where a.app_id in ('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e', '139ef4fa-c108-8f9a-c7be-d5f492a2c939', '141fbfae-511e-6817-c9f0-48993a7547d1'\n                , '1480c568-5cbd-9392-5604-1148f5faffa0', '13ee94c1-b635-8505-3391-97919052c16f', '14bca956-e09f-f4d6-14d7-466cb3f09103'\n                , '150ae7ee-c74a-eecd-d3d7-2112895b988a', '1375baa8-8eca-5659-ce9d-455b2009250d')\n    GROUP by 1,2,3,4,5,6,7,8,9,10,11",
            "queryName": "create sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p1",
            "queryStats": {
                "elapsedTime": "10.21m",
                "planningTime": "782.13ms",
                "analysisTime": "262.85ms",
                "queuedTime": "18.04s",
                "executionTime": "9.91m",
                "totalCpuTime": "1.45h",
                "rawInputDataSize": "68.09GB",
                "internalNetworkInputDataSize": "79.37GB",
                "physicalInputDataSize": "68.09GB",
                "processedInputDataSize": "68.09GB",
                "rawInputPositions": "956501287",
                "internalNetworkInputPositions": "398527172",
                "physicalInputPositions": "956501287",
                "processedInputPositions": "956501287",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "83.60GB",
                "writtenPositions": "397290909",
                "peakTotalMemoryReservation": "117.72GB",
                "peakTaskTotalMemory": "7.37GB",
                "totalSplits": 689,
                "connectorSplits": "0",
                "numberOfWorkers": 44,
                "connectorTables": [
                    "sunduk.baguild.pavelk_publish_events_delta",
                    "sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_temppp"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "9.90m",
                    "totalQueuedTime": "943.34us",
                    "totalScheduledTime": "1.09s",
                    "totalCpuTime": "44.65ms",
                    "totalBlockedTime": "49.39m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "6.99m",
                    "totalQueuedTime": "9.24m",
                    "totalScheduledTime": "54.40m",
                    "totalCpuTime": "48.32m",
                    "totalBlockedTime": "11.10h",
                    "rawInputDataSize": "79.37GB",
                    "internalNetworkInputDataSize": "79.37GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "83.69GB",
                    "rawInputPositions": "398527156",
                    "internalNetworkInputPositions": "398527156",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "398527156",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "3.79m",
                    "totalQueuedTime": "7.43h",
                    "totalScheduledTime": "50.61m",
                    "totalCpuTime": "38.88m",
                    "totalBlockedTime": "2.86h",
                    "rawInputDataSize": "67.96GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "67.96GB",
                    "processedInputDataSize": "67.96GB",
                    "rawInputPositions": "955265040",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955265040",
                    "processedInputPositions": "955265040",
                    "outputDataSize": "83.59GB",
                    "outputPositions": "397290909",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 384,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "4.84s",
                    "totalQueuedTime": "1.01m",
                    "totalScheduledTime": "6.57s",
                    "totalCpuTime": "1.18s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "135.19MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "135.19MB",
                    "processedInputDataSize": "135.19MB",
                    "rawInputPositions": "1236247",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1236247",
                    "processedInputPositions": "1236247",
                    "outputDataSize": "69.56MB",
                    "outputPositions": "1236247",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 28,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:49:24.611,  cpu: 00:00:00.044,  blocked: 00:49:23.400,  queue: 00:00:00.000,  scheduled: 00:00:01.090 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.090,  finishWall: 00:00:00.000)  other: 00:00:00.120,  timeCost: 0.0%,  blocked: 100.0%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  143.9/272  elapsed: 16:45:03.851,  cpu: 00:48:19.200,  blocked: 11:06:00.000,  queue: 00:09:14.243,  scheduled: 00:54:24.000 (addInputWall: 00:34:49.409,  getOutputWall: 00:16:57.914,  finishWall: 00:02:36.584)  other: 04:35:25.607,  timeCost: 51.7%,  blocked: 66.3%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.2"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  204.7/384  elapsed: 12:55:27.171,  cpu: 00:38:52.800,  blocked: 02:51:36.000,  queue: 07:25:37.125,  scheduled: 00:50:36.600 (addInputWall: 00:23:36.600,  getOutputWall: 00:43:49.800,  finishWall: 00:00:00.225)  other: 01:47:37.446,  timeCost: 48.1%,  blocked: 22.1%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   13.9/28   elapsed: 00:01:07.121,  cpu: 00:00:01.180,  blocked: 00:00:00.000,  queue: 00:01:00.554,  scheduled: 00:00:06.570 (addInputWall: 00:00:18.459,  getOutputWall: 00:00:06.280,  finishWall: 00:00:00.064)  other: 00:00:00.000,  timeCost: 0.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.7"
                },
                {
                    "source": {
                        "stageId": "3",
                        "taskId": "20"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(123.67MB)/P50(529.85kB) = 239.0 times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"16\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"14\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_publish_temp_never_unpublish_sites_delta_p1; tablePath=s3a://wix-bi-sunduk/baguild/0ba6b5f0-c6b3-4fa1-a7bb-8587cd5e28d7; columnHandles=[[app_id, varchar, 1], [close_date, timestamp, 2], [close_reason, varchar(16), 3], [initiator_name, varchar, 4], [instance_id, varchar, 5], [is_published, boolean, 6], [msid, varchar, 7], [open_date, timestamp, 8], [open_reason, varchar(16), 9], [uuid, varchar, 10], [was_demo, boolean, 11], [publish_date, timestamp, 12]], hash=-365247356]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"440\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"368\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\nclose_date := close_date\\nclose_reason := close_reason\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nopen_reason := open_reason\\nuuid := uuid\\nwas_demo := was_demo\\npublish_date := min\\n\",\n  \"children\" : [ {\n    \"id\" : \"439\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"517\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"9\",\n        \"name\" : \"Aggregate(FINAL)[app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_72\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"461\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"app_id\\\", \\\"close_date\\\", \\\"close_reason\\\", \\\"initiator_name\\\", \\\"instance_id\\\", \\\"is_published\\\", \\\"msid\\\", \\\"open_date\\\", \\\"open_reason\\\", \\\"uuid\\\", \\\"was_demo\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"459\",\n            \"name\" : \"Aggregate(PARTIAL)[app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue_78]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_72 := min(\\\"expr_13\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"7\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_13 := (CASE WHEN ((\\\"date_created\\\" >= \\\"open_date\\\") AND (\\\"date_created\\\" < \\\"close_date\\\")) THEN \\\"date_created\\\" END)\\n$hashvalue_78 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_0\\\")][$hashvalue_73, $hashvalue_75]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"366\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"437\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_75] (\\\"msid_0\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"367\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"515\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_never_unpublish_sites_delta_temppp', folderName='05d360e1-f7d0-44cb-9f18-22c8752e30d8', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('1375baa8-8eca-5659-ce9d-455b2009250d' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar)))]\",\n  \"details\" : \"$hashvalue_74 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 10]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 9]\\napp_id := [app_id, varchar, 0]\\n    :: [[135c3d92-0fea-1f9d-2ba5-2a1dfb04297e], [1375baa8-8eca-5659-ce9d-455b2009250d], [139ef4fa-c108-8f9a-c7be-d5f492a2c939], [13ee94c1-b635-8505-3391-97919052c16f], [141fbfae-511e-6817-c9f0-48993a7547d1], [1480c568-5cbd-9392-5604-1148f5faffa0], [14bca956-e09f-f4d6-14d7-466cb3f09103], [150ae7ee-c74a-eecd-d3d7-2112895b988a]]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"516\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_publish_events_delta', folderName='de80ee25-3c6a-4104-91fa-f74a997b5d53', columns='[[action_type,varchar(12),false], [date_created,timestamp,false], [msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_77 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_0\\\"), 0))\\nmsid_0 := [msid, varchar, 2]\\ndate_created := [date_created, timestamp, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_032915_16945_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p2 \nAS\n    SELECT a.*, min(case when date_created >= open_date and date_created < close_date then date_created end) as publish_date\n    FROM        sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_temppp         a\n    LEFT JOIN   sunduk.baguild.pavelk_publish_events_delta    b ON  a.msid=b.msid\n    where a.app_id not in ('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e', '139ef4fa-c108-8f9a-c7be-d5f492a2c939', '141fbfae-511e-6817-c9f0-48993a7547d1'\n                , '1480c568-5cbd-9392-5604-1148f5faffa0', '13ee94c1-b635-8505-3391-97919052c16f', '14bca956-e09f-f4d6-14d7-466cb3f09103'\n                , '150ae7ee-c74a-eecd-d3d7-2112895b988a', '1375baa8-8eca-5659-ce9d-455b2009250d')\n    \n    GROUP by 1,2,3,4,5,6,7,8,9,10,11",
            "queryName": "create sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p2",
            "queryStats": {
                "elapsedTime": "6.31m",
                "planningTime": "799.27ms",
                "analysisTime": "283.98ms",
                "queuedTime": "1.45s",
                "executionTime": "6.28m",
                "totalCpuTime": "1.93h",
                "rawInputDataSize": "79.15GB",
                "internalNetworkInputDataSize": "111.22GB",
                "physicalInputDataSize": "79.15GB",
                "processedInputDataSize": "79.15GB",
                "rawInputPositions": "956501287",
                "internalNetworkInputPositions": "559210394",
                "physicalInputPositions": "956501287",
                "processedInputPositions": "956501287",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "117.15GB",
                "writtenPositions": "557974131",
                "peakTotalMemoryReservation": "170.69GB",
                "peakTaskTotalMemory": "10.68GB",
                "totalSplits": 689,
                "connectorSplits": "0",
                "numberOfWorkers": 44,
                "connectorTables": [
                    "sunduk.baguild.pavelk_publish_events_delta",
                    "sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_temppp"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "6.27m",
                    "totalQueuedTime": "1.23ms",
                    "totalScheduledTime": "1.04s",
                    "totalCpuTime": "65.22ms",
                    "totalBlockedTime": "31.26m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "5.27m",
                    "totalQueuedTime": "2.79m",
                    "totalScheduledTime": "1.32h",
                    "totalCpuTime": "1.19h",
                    "totalBlockedTime": "11.61h",
                    "rawInputDataSize": "111.22GB",
                    "internalNetworkInputDataSize": "111.22GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "117.24GB",
                    "rawInputPositions": "559210378",
                    "internalNetworkInputPositions": "559210378",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "559210378",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "2.84m",
                    "totalQueuedTime": "6.96h",
                    "totalScheduledTime": "55.73m",
                    "totalCpuTime": "44.18m",
                    "totalBlockedTime": "3.44h",
                    "rawInputDataSize": "79.03GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "79.03GB",
                    "processedInputDataSize": "79.03GB",
                    "rawInputPositions": "955265040",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955265040",
                    "processedInputPositions": "955265040",
                    "outputDataSize": "117.12GB",
                    "outputPositions": "557974131",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 384,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "1.72s",
                    "totalQueuedTime": "12.41s",
                    "totalScheduledTime": "6.35s",
                    "totalCpuTime": "1.26s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "129.62MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "129.62MB",
                    "processedInputDataSize": "129.62MB",
                    "rawInputPositions": "1236247",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1236247",
                    "processedInputPositions": "1236247",
                    "outputDataSize": "69.56MB",
                    "outputPositions": "1236247",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 28,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:31:16.923,  cpu: 00:00:00.065,  blocked: 00:31:15.600,  queue: 00:00:00.001,  scheduled: 00:00:01.040 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.040,  finishWall: 00:00:00.000)  other: 00:00:00.282,  timeCost: 0.0%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  174.4/272  elapsed: 15:18:10.003,  cpu: 01:11:24.000,  blocked: 11:36:36.000,  queue: 00:02:47.612,  scheduled: 01:19:12.000 (addInputWall: 00:49:42.525,  getOutputWall: 00:25:30.816,  finishWall: 00:03:46.751)  other: 02:19:34.391,  timeCost: 58.6%,  blocked: 75.9%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  262.3/384  elapsed: 12:23:35.919,  cpu: 00:44:10.800,  blocked: 03:26:24.000,  queue: 06:57:23.647,  scheduled: 00:55:43.800 (addInputWall: 00:29:28.200,  getOutputWall: 00:46:03.600,  finishWall: 00:00:00.141)  other: 01:04:04.471,  timeCost: 41.3%,  blocked: 27.8%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   10.9/28   elapsed: 00:00:18.765,  cpu: 00:00:01.260,  blocked: 00:00:00.000,  queue: 00:00:12.413,  scheduled: 00:00:06.350 (addInputWall: 00:00:02.410,  getOutputWall: 00:00:06.060,  finishWall: 00:00:00.068)  other: 00:00:00.001,  timeCost: 0.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.5"
                },
                {
                    "source": {
                        "stageId": "3",
                        "taskId": "16"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(124.04MB)/P50(0B) = Infinity times"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"16\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"14\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_publish_temp_never_unpublish_sites_delta_p2; tablePath=s3a://wix-bi-sunduk/baguild/b8569c96-d932-4571-b796-48c1b8cc798b; columnHandles=[[app_id, varchar, 1], [close_date, timestamp, 2], [close_reason, varchar(16), 3], [initiator_name, varchar, 4], [instance_id, varchar, 5], [is_published, boolean, 6], [msid, varchar, 7], [open_date, timestamp, 8], [open_reason, varchar(16), 9], [uuid, varchar, 10], [was_demo, boolean, 11], [publish_date, timestamp, 12]], hash=-2112216496]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"440\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"368\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\nclose_date := close_date\\nclose_reason := close_reason\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nopen_reason := open_reason\\nuuid := uuid\\nwas_demo := was_demo\\npublish_date := min\\n\",\n  \"children\" : [ {\n    \"id\" : \"439\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"517\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"9\",\n        \"name\" : \"Aggregate(FINAL)[app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"min := min(\\\"min_72\\\")\\n\",\n        \"children\" : [ {\n          \"id\" : \"461\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"app_id\\\", \\\"close_date\\\", \\\"close_reason\\\", \\\"initiator_name\\\", \\\"instance_id\\\", \\\"is_published\\\", \\\"msid\\\", \\\"open_date\\\", \\\"open_reason\\\", \\\"uuid\\\", \\\"was_demo\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"459\",\n            \"name\" : \"Aggregate(PARTIAL)[app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue_78]\",\n            \"identifier\" : \"\",\n            \"details\" : \"min_72 := min(\\\"expr_13\\\")\\n\",\n            \"children\" : [ {\n              \"id\" : \"7\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"expr_13 := (CASE WHEN ((\\\"date_created\\\" >= \\\"open_date\\\") AND (\\\"date_created\\\" < \\\"close_date\\\")) THEN \\\"date_created\\\" END)\\n$hashvalue_78 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"4\",\n                \"name\" : \"LeftJoin\",\n                \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_0\\\")][$hashvalue_73, $hashvalue_75]\",\n                \"details\" : \"Distribution: PARTITIONED\\n\",\n                \"children\" : [ {\n                  \"id\" : \"366\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                }, {\n                  \"id\" : \"437\",\n                  \"name\" : \"LocalExchange\",\n                  \"identifier\" : \"[HASH][$hashvalue_75] (\\\"msid_0\\\")\",\n                  \"details\" : \"\",\n                  \"children\" : [ {\n                    \"id\" : \"367\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[3]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"3\" ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"515\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_never_unpublish_sites_delta_temppp', folderName='05d360e1-f7d0-44cb-9f18-22c8752e30d8', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"app_id\\\" IN (CAST('135c3d92-0fea-1f9d-2ba5-2a1dfb04297e' AS varchar), CAST('1375baa8-8eca-5659-ce9d-455b2009250d' AS varchar), CAST('139ef4fa-c108-8f9a-c7be-d5f492a2c939' AS varchar), CAST('13ee94c1-b635-8505-3391-97919052c16f' AS varchar), CAST('141fbfae-511e-6817-c9f0-48993a7547d1' AS varchar), CAST('1480c568-5cbd-9392-5604-1148f5faffa0' AS varchar), CAST('14bca956-e09f-f4d6-14d7-466cb3f09103' AS varchar), CAST('150ae7ee-c74a-eecd-d3d7-2112895b988a' AS varchar))))]\",\n  \"details\" : \"$hashvalue_74 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 10]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 9]\\napp_id := [app_id, varchar, 0]\\n    :: [(<min>, 135c3d92-0fea-1f9d-2ba5-2a1dfb04297e), (135c3d92-0fea-1f9d-2ba5-2a1dfb04297e, 1375baa8-8eca-5659-ce9d-455b2009250d), (1375baa8-8eca-5659-ce9d-455b2009250d, 139ef4fa-c108-8f9a-c7be-d5f492a2c939), (139ef4fa-c108-8f9a-c7be-d5f492a2c939, 13ee94c1-b635-8505-3391-97919052c16f), (13ee94c1-b635-8505-3391-97919052c16f, 141fbfae-511e-6817-c9f0-48993a7547d1), (141fbfae-511e-6817-c9f0-48993a7547d1, 1480c568-5cbd-9392-5604-1148f5faffa0), (1480c568-5cbd-9392-5604-1148f5faffa0, 14bca956-e09f-f4d6-14d7-466cb3f09103), (14bca956-e09f-f4d6-14d7-466cb3f09103, 150ae7ee-c74a-eecd-d3d7-2112895b988a), (150ae7ee-c74a-eecd-d3d7-2112895b988a, <max>)]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"516\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_publish_events_delta', folderName='de80ee25-3c6a-4104-91fa-f74a997b5d53', columns='[[action_type,varchar(12),false], [date_created,timestamp,false], [msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_77 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_0\\\"), 0))\\nmsid_0 := [msid, varchar, 2]\\ndate_created := [date_created, timestamp, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_033533_17567_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta\nas \nselect * from sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p2\nunion all \nselect * from sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p1",
            "queryName": "create sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta",
            "queryStats": {
                "elapsedTime": "9.08m",
                "planningTime": "1.37s",
                "analysisTime": "621.11ms",
                "queuedTime": "113.37ms",
                "executionTime": "9.07m",
                "totalCpuTime": "1.30h",
                "rawInputDataSize": "59.77GB",
                "internalNetworkInputDataSize": "183.47GB",
                "physicalInputDataSize": "59.77GB",
                "processedInputDataSize": "200.60GB",
                "rawInputPositions": "955265040",
                "internalNetworkInputPositions": "955265056",
                "physicalInputPositions": "955265040",
                "processedInputPositions": "955265040",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "200.78GB",
                "writtenPositions": "955265040",
                "peakTotalMemoryReservation": "5.72GB",
                "peakTaskTotalMemory": "808.08MB",
                "totalSplits": 501,
                "connectorSplits": "0",
                "numberOfWorkers": 36,
                "connectorTables": [
                    "sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p1",
                    "sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta_p2"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "9.05m",
                    "totalQueuedTime": "1.33ms",
                    "totalScheduledTime": "998.28ms",
                    "totalCpuTime": "64.15ms",
                    "totalBlockedTime": "45.17m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "8.06m",
                    "totalQueuedTime": "11.22m",
                    "totalScheduledTime": "43.71m",
                    "totalCpuTime": "35.74m",
                    "totalBlockedTime": "3.81h",
                    "rawInputDataSize": "183.47GB",
                    "internalNetworkInputDataSize": "183.47GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "200.78GB",
                    "rawInputPositions": "955265040",
                    "internalNetworkInputPositions": "955265040",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "955265040",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 80,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "7.78m",
                    "totalQueuedTime": "11.83h",
                    "totalScheduledTime": "30.64m",
                    "totalCpuTime": "24.82m",
                    "totalBlockedTime": "8.34h",
                    "rawInputDataSize": "31.19GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "31.19GB",
                    "processedInputDataSize": "117.07GB",
                    "rawInputPositions": "557974131",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "557974131",
                    "processedInputPositions": "557974131",
                    "outputDataSize": "117.07GB",
                    "outputPositions": "557974131",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 240,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "7.73m",
                    "totalQueuedTime": "6.44h",
                    "totalScheduledTime": "22.10m",
                    "totalCpuTime": "17.27m",
                    "totalBlockedTime": "7.37h",
                    "rawInputDataSize": "28.57GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "28.57GB",
                    "processedInputDataSize": "83.53GB",
                    "rawInputPositions": "397290909",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "397290909",
                    "processedInputPositions": "397290909",
                    "outputDataSize": "83.53GB",
                    "outputPositions": "397290909",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 176,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:45:10.983,  cpu: 00:00:00.064,  blocked: 00:45:10.200,  queue: 00:00:00.001,  scheduled: 00:00:00.998 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.996,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 100.0%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   79.3/80   elapsed: 10:39:02.621,  cpu: 00:35:44.400,  blocked: 03:48:36.000,  queue: 00:11:12.954,  scheduled: 00:43:42.600 (addInputWall: 00:35:24.131,  getOutputWall: 00:00:45.190,  finishWall: 00:07:28.200)  other: 05:55:31.067,  timeCost: 45.3%,  blocked: 35.8%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "taskId": "4"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(26.58GB)/P50(9.59GB) = 2.8 times"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  191.9/240  elapsed: 24:52:51.741,  cpu: 00:24:49.200,  blocked: 08:20:24.000,  queue: 11:50:03.837,  scheduled: 00:30:38.400 (addInputWall: 00:09:24.000,  getOutputWall: 00:28:43.800,  finishWall: 00:00:00.001)  other: 04:11:45.503,  timeCost: 31.8%,  blocked: 33.5%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3  143.2/176  elapsed: 18:27:14.225,  cpu: 00:17:16.200,  blocked: 07:22:12.000,  queue: 06:26:22.544,  scheduled: 00:22:06.000 (addInputWall: 00:08:28.200,  getOutputWall: 00:20:45.600,  finishWall: 00:00:00.001)  other: 04:16:33.680,  timeCost: 22.9%,  blocked: 39.9%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"11\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"9\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_publish_temp_never_unpublish_sites_delta; tablePath=s3a://wix-bi-sunduk/baguild/6ad64e4b-b694-4077-bbe0-ae8f82f8f12e; columnHandles=[[app_id, varchar, 1], [close_date, timestamp, 2], [close_reason, varchar(16), 3], [initiator_name, varchar, 4], [instance_id, varchar, 5], [is_published, boolean, 6], [msid, varchar, 7], [open_date, timestamp, 8], [open_reason, varchar(16), 9], [publish_date, timestamp, 10], [uuid, varchar, 11], [was_demo, boolean, 12]], hash=1058758066]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"257\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"219\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"10\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := expr_59\\nclose_date := expr_60\\nclose_reason := expr_61\\ninitiator_name := expr_62\\ninstance_id := expr_63\\nis_published := expr_64\\nmsid := expr_65\\nopen_date := expr_66\\nopen_reason := expr_67\\npublish_date := expr_68\\nuuid := expr_69\\nwas_demo := expr_70\\n\",\n  \"children\" : [ {\n    \"id\" : \"256\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"218\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[2,3]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"2\", \"3\" ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"0\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_never_unpublish_sites_delta_p2', folderName='b8569c96-d932-4571-b796-48c1b8cc798b', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [publish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"open_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 11]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 10]\\npublish_date := [publish_date, timestamp, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"3\",\n  \"name\" : \"TableScan\",\n  \"identifier\" : \"[sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_never_unpublish_sites_delta_p1', folderName='0ba6b5f0-c6b3-4fa1-a7bb-8587cd5e28d7', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [publish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"initiator_name_26 := [initiator_name, varchar, 3]\\nuuid_33 := [uuid, varchar, 10]\\npublish_date_32 := [publish_date, timestamp, 9]\\nopen_date_30 := [open_date, timestamp, 7]\\ninstance_id_27 := [instance_id, varchar, 4]\\nopen_reason_31 := [open_reason, varchar(16), 8]\\nclose_date_24 := [close_date, timestamp, 1]\\napp_id_23 := [app_id, varchar, 0]\\nclose_reason_25 := [close_reason, varchar(16), 2]\\nwas_demo_34 := [was_demo, boolean, 11]\\nis_published_28 := [is_published, boolean, 5]\\nmsid_29 := [msid, varchar, 6]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_034440_18139_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_event_for_unpublished_sites_delta --105312\nAS\n\n    SELECT  a.*\n    FROM        sunduk.baguild.slowly_log_final_delta       a\n    INNER JOIN prod.verticals.unpublish_sites_delta         b ON a.msid=b.msid",
            "queryName": "create sunduk.baguild.slowly_event_for_unpublished_sites_delta",
            "queryStats": {
                "elapsedTime": "57.89s",
                "planningTime": "848.47ms",
                "analysisTime": "847.81ms",
                "queuedTime": "3.18ms",
                "executionTime": "57.05s",
                "totalCpuTime": "58.21m",
                "rawInputDataSize": "46.98GB",
                "internalNetworkInputDataSize": "190.49GB",
                "physicalInputDataSize": "46.98GB",
                "processedInputDataSize": "46.98GB",
                "rawInputPositions": "955468835",
                "internalNetworkInputPositions": "955468851",
                "physicalInputPositions": "955468835",
                "processedInputPositions": "955468835",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "44.25MB",
                "writtenPositions": "194378",
                "peakTotalMemoryReservation": "1.50GB",
                "peakTaskTotalMemory": "250.13MB",
                "totalSplits": 613,
                "connectorSplits": "0",
                "numberOfWorkers": 36,
                "connectorTables": [
                    "prod.verticals.unpublish_sites_delta",
                    "sunduk.baguild.slowly_log_final_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "56.19s",
                    "totalQueuedTime": "1.04ms",
                    "totalScheduledTime": "815.80ms",
                    "totalCpuTime": "29.25ms",
                    "totalBlockedTime": "4.61m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "55.26s",
                    "totalQueuedTime": "145.53ms",
                    "totalScheduledTime": "2.93m",
                    "totalCpuTime": "2.57m",
                    "totalBlockedTime": "2.04h",
                    "rawInputDataSize": "190.49GB",
                    "internalNetworkInputDataSize": "190.49GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "200.83GB",
                    "rawInputPositions": "955468835",
                    "internalNetworkInputPositions": "955468835",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "955468835",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 208,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "45.33s",
                    "totalQueuedTime": "1.12h",
                    "totalScheduledTime": "1.14h",
                    "totalCpuTime": "55.63m",
                    "totalBlockedTime": "19.76s",
                    "rawInputDataSize": "46.98GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "46.98GB",
                    "processedInputDataSize": "46.98GB",
                    "rawInputPositions": "955459418",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955459418",
                    "processedInputPositions": "955459418",
                    "outputDataSize": "200.84GB",
                    "outputPositions": "955459418",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 384,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "148.00ms",
                    "totalQueuedTime": "3.61ms",
                    "totalScheduledTime": "2.27s",
                    "totalCpuTime": "200.90ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "0B",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "0B",
                    "rawInputPositions": "9417",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "9417",
                    "processedInputPositions": "9417",
                    "outputDataSize": "459.80kB",
                    "outputPositions": "9417",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    4.9/5    elapsed: 00:04:37.666,  cpu: 00:00:00.029,  blocked: 00:04:36.600,  queue: 00:00:00.001,  scheduled: 00:00:00.815 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.814,  finishWall: 00:00:00.000)  other: 00:00:00.249,  timeCost: 0.0%,  blocked: 99.6%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  143.6/208  elapsed: 02:12:14.194,  cpu: 00:02:34.200,  blocked: 02:02:24.000,  queue: 00:00:00.145,  scheduled: 00:02:55.800 (addInputWall: 00:00:09.043,  getOutputWall: 00:02:37.067,  finishWall: 00:00:04.062)  other: 00:06:54.249,  timeCost: 4.1%,  blocked: 92.6%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "2",
                        "operatorId": "1"
                    },
                    "level": "WARN",
                    "message": "InnerJoin by non-uniq column(s), multiplier 20.6"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  180.9/384  elapsed: 02:16:38.068,  cpu: 00:55:37.800,  blocked: 00:00:19.760,  queue: 01:07:19.679,  scheduled: 01:08:23.999 (addInputWall: 00:31:34.800,  getOutputWall: 00:48:52.800,  finishWall: 00:00:04.160)  other: 00:00:34.628,  timeCost: 95.8%,  blocked: 0.2%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   15.4/16   elapsed: 00:00:02.274,  cpu: 00:00:00.200,  blocked: 00:00:00.000,  queue: 00:00:00.003,  scheduled: 00:00:02.270 (addInputWall: 00:00:00.001,  getOutputWall: 00:00:02.270,  finishWall: 00:00:00.001)  other: 00:00:00.000,  timeCost: 0.1%,  blocked: 0.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"12\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"10\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_event_for_unpublished_sites_delta; tablePath=s3a://wix-bi-sunduk/baguild/c11a16cb-d3bf-41dd-9341-16f535760904; columnHandles=[[app_id, varchar, 1], [close_date, timestamp, 2], [close_reason, varchar(16), 3], [initiator_name, varchar, 4], [instance_id, varchar, 5], [is_published, boolean, 6], [msid, varchar, 7], [open_date, timestamp, 8], [open_reason, varchar(16), 9], [uuid, varchar, 10], [was_demo, boolean, 11]], hash=1671322323]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"283\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"232\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"11\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\nclose_date := close_date\\nclose_reason := close_reason\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nopen_reason := open_reason\\nuuid := uuid\\nwas_demo := was_demo\\n\",\n  \"children\" : [ {\n    \"id\" : \"282\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"4\",\n      \"name\" : \"InnerJoin\",\n      \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_0\\\")][$hashvalue, $hashvalue_47]\",\n      \"details\" : \"Distribution: PARTITIONED\\n\",\n      \"children\" : [ {\n        \"id\" : \"230\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[2]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"2\" ]\n      }, {\n        \"id\" : \"281\",\n        \"name\" : \"LocalExchange\",\n        \"identifier\" : \"[HASH][$hashvalue_47] (\\\"msid_0\\\")\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"231\",\n          \"name\" : \"RemoteSource\",\n          \"identifier\" : \"[3]\",\n          \"details\" : \"\",\n          \"children\" : [ ],\n          \"remoteSources\" : [ \"3\" ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"328\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_log_final_delta', folderName='740566f6-2137-442d-85ca-11ab3a83e978', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_46 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 10]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"329\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = prod:TableHandle{connectorId='prod', dataRealmName='all-dynamic-schemas', schemaName='verticals', tableName='unpublish_sites_delta', folderName='e6718c84-652e-486d-9cb9-609b0dcec3e5', columns='[[msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_49 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_0\\\"), 0))\\nmsid_0 := [msid, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_034538_18329_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_publish_temp_delta -- 151519\nAS\n\n    SELECT  a.*\n            , case when date_created >= open_date and date_created < close_date then date_created end AS publish_date\n    FROM        sunduk.baguild.slowly_event_for_unpublished_sites_delta     a\n    LEFT JOIN   sunduk.baguild.pavelk_publish_events_delta                  b ON    a.msid=b.msid\n    GROUP by 1,2,3,4,5,6,7,8,9,10,11,12",
            "queryName": "create sunduk.baguild.slowly_with_publish_temp_delta",
            "queryStats": {
                "elapsedTime": "2.64s",
                "planningTime": "604.99ms",
                "analysisTime": "272.93ms",
                "queuedTime": "1.77ms",
                "executionTime": "2.37s",
                "totalCpuTime": "11.00s",
                "rawInputDataSize": "22.89MB",
                "internalNetworkInputDataSize": "107.06MB",
                "physicalInputDataSize": "22.89MB",
                "processedInputDataSize": "22.89MB",
                "rawInputPositions": "1430625",
                "internalNetworkInputPositions": "1430641",
                "physicalInputPositions": "1430625",
                "processedInputPositions": "1430625",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "82.75MB",
                "writtenPositions": "376422",
                "peakTotalMemoryReservation": "920.63kB",
                "peakTaskTotalMemory": "44.81kB",
                "totalSplits": 321,
                "connectorSplits": "0",
                "numberOfWorkers": 36,
                "connectorTables": [
                    "sunduk.baguild.pavelk_publish_events_delta",
                    "sunduk.baguild.slowly_event_for_unpublished_sites_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.76s",
                    "totalQueuedTime": "1.19ms",
                    "totalScheduledTime": "818.42ms",
                    "totalCpuTime": "22.40ms",
                    "totalBlockedTime": "4.69s",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "861.00ms",
                    "totalQueuedTime": "236.28ms",
                    "totalScheduledTime": "12.25s",
                    "totalCpuTime": "8.68s",
                    "totalBlockedTime": "2.31m",
                    "rawInputDataSize": "107.06MB",
                    "internalNetworkInputDataSize": "107.06MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "112.74MB",
                    "rawInputPositions": "1430625",
                    "internalNetworkInputPositions": "1430625",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "1430625",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "150.00ms",
                    "totalQueuedTime": "5.52ms",
                    "totalScheduledTime": "2.63s",
                    "totalCpuTime": "917.48ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "5.32MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "5.32MB",
                    "processedInputDataSize": "5.32MB",
                    "rawInputPositions": "194378",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "194378",
                    "processedInputPositions": "194378",
                    "outputDataSize": "43.17MB",
                    "outputPositions": "194378",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "244.00ms",
                    "totalQueuedTime": "448.72ms",
                    "totalScheduledTime": "5.64s",
                    "totalCpuTime": "1.39s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "17.57MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "17.57MB",
                    "processedInputDataSize": "17.57MB",
                    "rawInputPositions": "1236247",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1236247",
                    "processedInputPositions": "1236247",
                    "outputDataSize": "69.56MB",
                    "outputPositions": "1236247",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 28,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    3.1/5    elapsed: 00:00:05.516,  cpu: 00:00:00.022,  blocked: 00:00:04.690,  queue: 00:00:00.001,  scheduled: 00:00:00.818 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.817,  finishWall: 00:00:00.000)  other: 00:00:00.007,  timeCost: 3.8%,  blocked: 85.0%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  176.3/272  elapsed: 00:02:31.771,  cpu: 00:00:08.680,  blocked: 00:02:18.600,  queue: 00:00:00.236,  scheduled: 00:00:12.250 (addInputWall: 00:00:02.943,  getOutputWall: 00:00:05.976,  finishWall: 00:00:03.286)  other: 00:00:00.685,  timeCost: 57.4%,  blocked: 91.3%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "2",
                        "operatorId": "1"
                    },
                    "level": "WARN",
                    "message": "LeftJoin by non-uniq column(s), multiplier 2.0"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2   17.6/16   elapsed: 00:00:02.640,  cpu: 00:00:00.917,  blocked: 00:00:00.000,  queue: 00:00:00.005,  scheduled: 00:00:02.630 (addInputWall: 00:00:00.634,  getOutputWall: 00:00:02.400,  finishWall: 00:00:00.013)  other: 00:00:00.004,  timeCost: 12.3%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.0"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   24.9/28   elapsed: 00:00:06.079,  cpu: 00:00:01.390,  blocked: 00:00:00.000,  queue: 00:00:00.448,  scheduled: 00:00:05.640 (addInputWall: 00:00:01.549,  getOutputWall: 00:00:05.200,  finishWall: 00:00:00.147)  other: 00:00:00.000,  timeCost: 26.4%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.3"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"13\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_publish_temp_delta; tablePath=s3a://wix-bi-sunduk/baguild/87815b8b-2723-43b3-a77c-434d30720edf; columnHandles=[[app_id, varchar, 1], [close_date, timestamp, 2], [close_reason, varchar(16), 3], [initiator_name, varchar, 4], [instance_id, varchar, 5], [is_published, boolean, 6], [msid, varchar, 7], [open_date, timestamp, 8], [open_reason, varchar(16), 9], [uuid, varchar, 10], [was_demo, boolean, 11], [publish_date, timestamp, 12]], hash=-94595620]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"374\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"310\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\nclose_date := close_date\\nclose_reason := close_reason\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nopen_reason := open_reason\\nuuid := uuid\\nwas_demo := was_demo\\npublish_date := expr_13\\n\",\n  \"children\" : [ {\n    \"id\" : \"373\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"448\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"8\",\n        \"name\" : \"Aggregate(FINAL)[expr_13, app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"394\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"expr_13\\\", \\\"app_id\\\", \\\"close_date\\\", \\\"close_reason\\\", \\\"initiator_name\\\", \\\"instance_id\\\", \\\"is_published\\\", \\\"msid\\\", \\\"open_date\\\", \\\"open_reason\\\", \\\"uuid\\\", \\\"was_demo\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"392\",\n            \"name\" : \"Aggregate(PARTIAL)[expr_13, app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue_78]\",\n            \"identifier\" : \"\",\n            \"details\" : \"\",\n            \"children\" : [ {\n              \"id\" : \"447\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"$hashvalue_78 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"expr_13\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"6\",\n                \"name\" : \"Project\",\n                \"identifier\" : \"[]\",\n                \"details\" : \"expr_13 := (CASE WHEN ((\\\"date_created\\\" >= \\\"open_date\\\") AND (\\\"date_created\\\" < \\\"close_date\\\")) THEN \\\"date_created\\\" END)\\n\",\n                \"children\" : [ {\n                  \"id\" : \"4\",\n                  \"name\" : \"LeftJoin\",\n                  \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_0\\\")][$hashvalue_73, $hashvalue_75]\",\n                  \"details\" : \"Distribution: PARTITIONED\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"308\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[2]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"2\" ]\n                  }, {\n                    \"id\" : \"371\",\n                    \"name\" : \"LocalExchange\",\n                    \"identifier\" : \"[HASH][$hashvalue_75] (\\\"msid_0\\\")\",\n                    \"details\" : \"\",\n                    \"children\" : [ {\n                      \"id\" : \"309\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[3]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"3\" ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"445\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_event_for_unpublished_sites_delta', folderName='c11a16cb-d3bf-41dd-9341-16f535760904', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_74 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 10]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"446\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_publish_events_delta', folderName='de80ee25-3c6a-4104-91fa-f74a997b5d53', columns='[[action_type,varchar(12),false], [date_created,timestamp,false], [msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_77 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_0\\\"), 0))\\nmsid_0 := [msid, varchar, 2]\\ndate_created := [date_created, timestamp, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_034541_18333_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_unpublish_temp_delta -- 109912\nAS\n\n    SELECT  a.*\n            , case when date_created >= open_date and date_created < close_date then date_created end AS unpublish_date\n    FROM        sunduk.baguild.slowly_event_for_unpublished_sites_delta a\n    LEFT JOIN   sunduk.baguild.pavelk_unpublish_events_delta            b ON    a.msid=b.msid\n    GROUP by 1,2,3,4,5,6,7,8,9,10,11,12",
            "queryName": "create sunduk.baguild.slowly_with_unpublish_temp_delta",
            "queryStats": {
                "elapsedTime": "2.63s",
                "planningTime": "568.61ms",
                "analysisTime": "251.66ms",
                "queuedTime": "1.74ms",
                "executionTime": "2.38s",
                "totalCpuTime": "5.49s",
                "rawInputDataSize": "8.77MB",
                "internalNetworkInputDataSize": "41.54MB",
                "physicalInputDataSize": "8.77MB",
                "processedInputDataSize": "8.77MB",
                "rawInputPositions": "204182",
                "internalNetworkInputPositions": "204198",
                "physicalInputPositions": "204182",
                "processedInputPositions": "204182",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "45.30MB",
                "writtenPositions": "204292",
                "peakTotalMemoryReservation": "915.75kB",
                "peakTaskTotalMemory": "44.81kB",
                "totalSplits": 316,
                "connectorSplits": "0",
                "numberOfWorkers": 36,
                "connectorTables": [
                    "sunduk.baguild.pavelk_unpublish_events_delta",
                    "sunduk.baguild.slowly_event_for_unpublished_sites_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "1.81s",
                    "totalQueuedTime": "1.01ms",
                    "totalScheduledTime": "787.51ms",
                    "totalCpuTime": "23.16ms",
                    "totalBlockedTime": "5.08s",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "969.00ms",
                    "totalQueuedTime": "335.49ms",
                    "totalScheduledTime": "7.83s",
                    "totalCpuTime": "4.19s",
                    "totalBlockedTime": "2.72m",
                    "rawInputDataSize": "41.54MB",
                    "internalNetworkInputDataSize": "41.54MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "43.71MB",
                    "rawInputPositions": "204182",
                    "internalNetworkInputPositions": "204182",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "204182",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 272,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "131.00ms",
                    "totalQueuedTime": "8.59ms",
                    "totalScheduledTime": "2.14s",
                    "totalCpuTime": "897.67ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "5.04MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "5.04MB",
                    "processedInputDataSize": "5.04MB",
                    "rawInputPositions": "194378",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "194378",
                    "processedInputPositions": "194378",
                    "outputDataSize": "43.17MB",
                    "outputPositions": "194378",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "133.00ms",
                    "totalQueuedTime": "1.04s",
                    "totalScheduledTime": "4.37s",
                    "totalCpuTime": "370.99ms",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "3.73MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "3.73MB",
                    "processedInputDataSize": "3.73MB",
                    "rawInputPositions": "9804",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "9804",
                    "processedInputPositions": "9804",
                    "outputDataSize": "564.87kB",
                    "outputPositions": "9804",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 23,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    3.3/5    elapsed: 00:00:05.875,  cpu: 00:00:00.023,  blocked: 00:00:05.080,  queue: 00:00:00.001,  scheduled: 00:00:00.787 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:00.786,  finishWall: 00:00:00.000)  other: 00:00:00.006,  timeCost: 5.2%,  blocked: 86.5%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  178.1/272  elapsed: 00:02:52.581,  cpu: 00:00:04.190,  blocked: 00:02:43.200,  queue: 00:00:00.335,  scheduled: 00:00:07.830 (addInputWall: 00:00:01.721,  getOutputWall: 00:00:02.622,  finishWall: 00:00:03.447)  other: 00:00:01.215,  timeCost: 51.8%,  blocked: 94.6%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "pipelineId": "2",
                        "operatorId": "1"
                    },
                    "level": "WARN",
                    "message": "LeftJoin by non-uniq column(s), multiplier 1.1"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2   16.4/16   elapsed: 00:00:02.147,  cpu: 00:00:00.897,  blocked: 00:00:00.000,  queue: 00:00:00.008,  scheduled: 00:00:02.140 (addInputWall: 00:00:00.615,  getOutputWall: 00:00:01.910,  finishWall: 00:00:00.012)  other: 00:00:00.000,  timeCost: 14.1%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   40.6/23   elapsed: 00:00:05.404,  cpu: 00:00:00.370,  blocked: 00:00:00.000,  queue: 00:00:01.035,  scheduled: 00:00:04.370 (addInputWall: 00:00:00.664,  getOutputWall: 00:00:04.350,  finishWall: 00:00:00.023)  other: 00:00:00.000,  timeCost: 28.9%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.1"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 85.2 of data dropped"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"15\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"13\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_unpublish_temp_delta; tablePath=s3a://wix-bi-sunduk/baguild/4608aecd-b8d0-496f-8f7c-019a990b4ab1; columnHandles=[[app_id, varchar, 1], [close_date, timestamp, 2], [close_reason, varchar(16), 3], [initiator_name, varchar, 4], [instance_id, varchar, 5], [is_published, boolean, 6], [msid, varchar, 7], [open_date, timestamp, 8], [open_reason, varchar(16), 9], [uuid, varchar, 10], [was_demo, boolean, 11], [unpublish_date, timestamp, 12]], hash=407587090]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"374\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"310\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"app_id := app_id\\nclose_date := close_date\\nclose_reason := close_reason\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nopen_reason := open_reason\\nuuid := uuid\\nwas_demo := was_demo\\nunpublish_date := expr_13\\n\",\n  \"children\" : [ {\n    \"id\" : \"373\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"448\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"8\",\n        \"name\" : \"Aggregate(FINAL)[expr_13, app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue]\",\n        \"identifier\" : \"\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"394\",\n          \"name\" : \"LocalExchange\",\n          \"identifier\" : \"[HASH][$hashvalue] (\\\"expr_13\\\", \\\"app_id\\\", \\\"close_date\\\", \\\"close_reason\\\", \\\"initiator_name\\\", \\\"instance_id\\\", \\\"is_published\\\", \\\"msid\\\", \\\"open_date\\\", \\\"open_reason\\\", \\\"uuid\\\", \\\"was_demo\\\")\",\n          \"details\" : \"\",\n          \"children\" : [ {\n            \"id\" : \"392\",\n            \"name\" : \"Aggregate(PARTIAL)[expr_13, app_id, close_date, close_reason, initiator_name, instance_id, is_published, msid, open_date, open_reason, uuid, was_demo][$hashvalue_78]\",\n            \"identifier\" : \"\",\n            \"details\" : \"\",\n            \"children\" : [ {\n              \"id\" : \"447\",\n              \"name\" : \"Project\",\n              \"identifier\" : \"[]\",\n              \"details\" : \"$hashvalue_78 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"expr_13\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0))\\n\",\n              \"children\" : [ {\n                \"id\" : \"6\",\n                \"name\" : \"Project\",\n                \"identifier\" : \"[]\",\n                \"details\" : \"expr_13 := (CASE WHEN ((\\\"date_created\\\" >= \\\"open_date\\\") AND (\\\"date_created\\\" < \\\"close_date\\\")) THEN \\\"date_created\\\" END)\\n\",\n                \"children\" : [ {\n                  \"id\" : \"4\",\n                  \"name\" : \"LeftJoin\",\n                  \"identifier\" : \"[(\\\"msid\\\" = \\\"msid_0\\\")][$hashvalue_73, $hashvalue_75]\",\n                  \"details\" : \"Distribution: PARTITIONED\\n\",\n                  \"children\" : [ {\n                    \"id\" : \"308\",\n                    \"name\" : \"RemoteSource\",\n                    \"identifier\" : \"[2]\",\n                    \"details\" : \"\",\n                    \"children\" : [ ],\n                    \"remoteSources\" : [ \"2\" ]\n                  }, {\n                    \"id\" : \"371\",\n                    \"name\" : \"LocalExchange\",\n                    \"identifier\" : \"[HASH][$hashvalue_75] (\\\"msid_0\\\")\",\n                    \"details\" : \"\",\n                    \"children\" : [ {\n                      \"id\" : \"309\",\n                      \"name\" : \"RemoteSource\",\n                      \"identifier\" : \"[3]\",\n                      \"details\" : \"\",\n                      \"children\" : [ ],\n                      \"remoteSources\" : [ \"3\" ]\n                    } ],\n                    \"remoteSources\" : [ ]\n                  } ],\n                  \"remoteSources\" : [ ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"445\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_event_for_unpublished_sites_delta', folderName='c11a16cb-d3bf-41dd-9341-16f535760904', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"$hashvalue_74 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 10]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"446\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='pavelk_unpublish_events_delta', folderName='6527a6af-fc0f-4f8c-b791-13a85c5540d7', columns='[[action_type,varchar(14),false], [date_created,timestamp,false], [msid,varchar,false]]'}]\",\n  \"details\" : \"$hashvalue_77 := combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"msid_0\\\"), 0))\\nmsid_0 := [msid, varchar, 2]\\ndate_created := [date_created, timestamp, 1]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_034544_18340_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_publish_raw_delta -- 257695\nAS\n\nWITH aa AS (\n    SELECT uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason, is_published\n            , min(publish_date)     AS publish_date\n    FROM sunduk.baguild.slowly_with_publish_temp_delta\n    GROUP by 1,2,3,4,5,6,7,8,9,10,11\n)\n\n    SELECT  uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason, is_published\n            , open_date as action_date, 'open' as action_type\n    FROM aa\n    WHERE publish_date is null\n    \n    UNION ALL\n    \n    SELECT  uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason, is_published\n            , publish_date as action_date, 'publish' as action_type\n    FROM sunduk.baguild.slowly_with_publish_temp_delta\n    WHERE publish_date is not null\n\n    UNION ALL\n    \n    SELECT  uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason, is_published\n            , unpublish_date as action_date, 'unpublish' as action_type\n    FROM sunduk.baguild.slowly_with_unpublish_temp_delta\n    WHERE unpublish_date is not null",
            "queryName": "create sunduk.baguild.slowly_with_publish_raw_delta",
            "queryStats": {
                "elapsedTime": "4.81s",
                "planningTime": "1.28s",
                "analysisTime": "340.06ms",
                "queuedTime": "140.71us",
                "executionTime": "4.47s",
                "totalCpuTime": "9.77s",
                "rawInputDataSize": "6.46MB",
                "internalNetworkInputDataSize": "166.96MB",
                "physicalInputDataSize": "6.46MB",
                "processedInputDataSize": "6.46MB",
                "rawInputPositions": "957136",
                "internalNetworkInputPositions": "768083",
                "physicalInputPositions": "957136",
                "processedInputPositions": "957136",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "132.12MB",
                "writtenPositions": "573689",
                "peakTotalMemoryReservation": "618.31kB",
                "peakTaskTotalMemory": "95.13kB",
                "totalSplits": 261,
                "connectorSplits": "0",
                "numberOfWorkers": 36,
                "connectorTables": [
                    "sunduk.baguild.slowly_with_publish_temp_delta",
                    "sunduk.baguild.slowly_with_unpublish_temp_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "3.18s",
                    "totalQueuedTime": "1.20ms",
                    "totalScheduledTime": "1.67s",
                    "totalCpuTime": "24.27ms",
                    "totalBlockedTime": "7.52s",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "846.00ms",
                    "totalQueuedTime": "72.65ms",
                    "totalScheduledTime": "4.88s",
                    "totalCpuTime": "1.88s",
                    "totalBlockedTime": "58.12s",
                    "rawInputDataSize": "125.38MB",
                    "internalNetworkInputDataSize": "125.38MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "132.12MB",
                    "rawInputPositions": "573689",
                    "internalNetworkInputPositions": "573689",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "573689",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 80,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "727.00ms",
                    "totalQueuedTime": "68.91ms",
                    "totalScheduledTime": "2.06s",
                    "totalCpuTime": "1.43s",
                    "totalBlockedTime": "1.44m",
                    "rawInputDataSize": "41.58MB",
                    "internalNetworkInputDataSize": "41.58MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "44.83MB",
                    "rawInputPositions": "194378",
                    "internalNetworkInputPositions": "194378",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "194378",
                    "outputDataSize": "29.66MB",
                    "outputPositions": "131850",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 128,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "395.00ms",
                    "totalQueuedTime": "14.24ms",
                    "totalScheduledTime": "6.07s",
                    "totalCpuTime": "3.44s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "1.33MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "1.33MB",
                    "processedInputDataSize": "1.33MB",
                    "rawInputPositions": "376422",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "376422",
                    "processedInputPositions": "376422",
                    "outputDataSize": "44.84MB",
                    "outputPositions": "194378",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "570.00ms",
                    "totalQueuedTime": "7.34ms",
                    "totalScheduledTime": "4.51s",
                    "totalCpuTime": "1.64s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "1.29MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "1.29MB",
                    "processedInputDataSize": "1.29MB",
                    "rawInputPositions": "376422",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "376422",
                    "processedInputPositions": "376422",
                    "outputDataSize": "55.34MB",
                    "outputPositions": "241445",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "5": {
                    "stageDuration": "573.00ms",
                    "totalQueuedTime": "6.47ms",
                    "totalScheduledTime": "3.74s",
                    "totalCpuTime": "1.35s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "3.84MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "3.84MB",
                    "processedInputDataSize": "3.84MB",
                    "rawInputPositions": "204292",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "204292",
                    "processedInputPositions": "204292",
                    "outputDataSize": "47.13MB",
                    "outputPositions": "200394",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.slowly_with_publish_temp_delta scanned 2 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    2.9/5    elapsed: 00:00:09.205,  cpu: 00:00:00.024,  blocked: 00:00:07.520,  queue: 00:00:00.001,  scheduled: 00:00:01.670 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.670,  finishWall: 00:00:00.000)  other: 00:00:00.013,  timeCost: 7.3%,  blocked: 81.7%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   74.9/80   elapsed: 00:01:03.351,  cpu: 00:00:01.880,  blocked: 00:00:58.120,  queue: 00:00:00.072,  scheduled: 00:00:04.880 (addInputWall: 00:00:01.673,  getOutputWall: 00:00:00.043,  finishWall: 00:00:03.140)  other: 00:00:00.278,  timeCost: 21.3%,  blocked: 91.7%"
                },
                {
                    "source": {
                        "stageId": "1",
                        "taskId": "0"
                    },
                    "level": "INFO",
                    "message": "Input data skew detected: Max(81MB)/P50(77.45kB) = 1070.9 times"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  122.4/128  elapsed: 00:01:28.955,  cpu: 00:00:01.430,  blocked: 00:01:26.400,  queue: 00:00:00.068,  scheduled: 00:00:02.060 (addInputWall: 00:00:00.890,  getOutputWall: 00:00:01.140,  finishWall: 00:00:00.006)  other: 00:00:00.426,  timeCost: 9.0%,  blocked: 97.1%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   15.4/16   elapsed: 00:00:06.082,  cpu: 00:00:03.440,  blocked: 00:00:00.000,  queue: 00:00:00.014,  scheduled: 00:00:06.070 (addInputWall: 00:00:01.040,  getOutputWall: 00:00:05.022,  finishWall: 00:00:00.094)  other: 00:00:00.000,  timeCost: 26.5%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4    7.9/16   elapsed: 00:00:04.520,  cpu: 00:00:01.640,  blocked: 00:00:00.000,  queue: 00:00:00.007,  scheduled: 00:00:04.510 (addInputWall: 00:00:00.174,  getOutputWall: 00:00:04.450,  finishWall: 00:00:00.000)  other: 00:00:00.003,  timeCost: 19.7%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "5"
                    },
                    "level": "INFO",
                    "message": "stage.5    6.5/16   elapsed: 00:00:03.749,  cpu: 00:00:01.350,  blocked: 00:00:00.000,  queue: 00:00:00.006,  scheduled: 00:00:03.740 (addInputWall: 00:00:01.048,  getOutputWall: 00:00:03.680,  finishWall: 00:00:00.000)  other: 00:00:00.003,  timeCost: 16.3%,  blocked: 0.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"28\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"26\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_publish_raw_delta; tablePath=s3a://wix-bi-sunduk/baguild/cd01a22f-d989-44ec-b01a-6a7752caea86; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [open_date, timestamp, 5], [was_demo, boolean, 6], [initiator_name, varchar, 7], [open_reason, varchar(16), 8], [close_date, timestamp, 9], [close_reason, varchar(16), 10], [is_published, boolean, 11], [action_date, timestamp, 12], [action_type, varchar(9), 13]], hash=1946395683]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"699\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"601\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"27\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid_211\\nmsid := msid_212\\napp_id := app_id_213\\ninstance_id := instance_id_214\\nopen_date := open_date_215\\nwas_demo := was_demo_216\\ninitiator_name := initiator_name_217\\nopen_reason := open_reason_218\\nclose_date := close_date_219\\nclose_reason := close_reason_220\\nis_published := is_published_221\\naction_date := open_date_222\\naction_type := expr_223\\n\",\n  \"children\" : [ {\n    \"id\" : \"698\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"600\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[2,4,5]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"2\", \"4\", \"5\" ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"115\",\n  \"name\" : \"FilterProject\",\n  \"identifier\" : \"[filterPredicate = (\\\"min\\\" IS NULL)]\",\n  \"details\" : \"expr_262 := CAST('open' AS varchar(9))\\n\",\n  \"children\" : [ {\n    \"id\" : \"795\",\n    \"name\" : \"Project\",\n    \"identifier\" : \"[]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"3\",\n      \"name\" : \"Aggregate(FINAL)[uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason, is_published][$hashvalue]\",\n      \"identifier\" : \"\",\n      \"details\" : \"min := min(\\\"min_276\\\")\\n\",\n      \"children\" : [ {\n        \"id\" : \"723\",\n        \"name\" : \"LocalExchange\",\n        \"identifier\" : \"[HASH][$hashvalue] (\\\"uuid\\\", \\\"msid\\\", \\\"app_id\\\", \\\"instance_id\\\", \\\"open_date\\\", \\\"was_demo\\\", \\\"initiator_name\\\", \\\"open_reason\\\", \\\"close_date\\\", \\\"close_reason\\\", \\\"is_published\\\")\",\n        \"details\" : \"\",\n        \"children\" : [ {\n          \"id\" : \"729\",\n          \"name\" : \"RemoteSource\",\n          \"identifier\" : \"[3]\",\n          \"details\" : \"\",\n          \"children\" : [ ],\n          \"remoteSources\" : [ \"3\" ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": [
                                    {
                                        "stageId": "3",
                                        "plan": "{\n  \"id\" : \"727\",\n  \"name\" : \"Aggregate(PARTIAL)[uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason, is_published][$hashvalue_278]\",\n  \"identifier\" : \"\",\n  \"details\" : \"min_276 := min(\\\"publish_date\\\")\\n\",\n  \"children\" : [ {\n    \"id\" : \"794\",\n    \"name\" : \"ScanProject\",\n    \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_delta', folderName='87815b8b-2723-43b3-a77c-434d30720edf', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [publish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n    \"details\" : \"$hashvalue_278 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"is_published\\\"), 0))\\nopen_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 11]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 10]\\npublish_date := [publish_date, timestamp, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                        "subStages": []
                                    }
                                ]
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"116\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_delta', folderName='87815b8b-2723-43b3-a77c-434d30720edf', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [publish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"publish_date_119\\\" IS NULL))]\",\n  \"details\" : \"expr_275 := CAST('publish' AS varchar(9))\\npublish_date_119 := [publish_date, timestamp, 9]\\n    :: [(<min>, <max>)]\\nopen_reason_118 := [open_reason, varchar(16), 8]\\ninitiator_name_113 := [initiator_name, varchar, 3]\\nclose_reason_112 := [close_reason, varchar(16), 2]\\nuuid_120 := [uuid, varchar, 10]\\napp_id_110 := [app_id, varchar, 0]\\ninstance_id_114 := [instance_id, varchar, 4]\\nis_published_115 := [is_published, boolean, 5]\\nwas_demo_121 := [was_demo, boolean, 11]\\nclose_date_111 := [close_date, timestamp, 1]\\nopen_date_117 := [open_date, timestamp, 7]\\nmsid_116 := [msid, varchar, 6]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "5",
                                "plan": "{\n  \"id\" : \"21\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_unpublish_temp_delta', folderName='4608aecd-b8d0-496f-8f7c-019a990b4ab1', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [unpublish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (NOT (\\\"unpublish_date\\\" IS NULL))]\",\n  \"details\" : \"expr_197 := 'unpublish'\\nopen_reason_182 := [open_reason, varchar(16), 8]\\nuuid_183 := [uuid, varchar, 10]\\nwas_demo_184 := [was_demo, boolean, 11]\\ninitiator_name_177 := [initiator_name, varchar, 3]\\nclose_reason_176 := [close_reason, varchar(16), 2]\\nis_published_179 := [is_published, boolean, 5]\\nclose_date_175 := [close_date, timestamp, 1]\\nunpublish_date := [unpublish_date, timestamp, 9]\\n    :: [(<min>, <max>)]\\napp_id_174 := [app_id, varchar, 0]\\nopen_date_181 := [open_date, timestamp, 7]\\ninstance_id_178 := [instance_id, varchar, 4]\\nmsid_180 := [msid, varchar, 6]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_034549_18355_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.slowly_with_publish_temp_filtered_delta -- 257695\nAS\n\nWITH a AS (\n\n    SELECT  *\n            , lag(action_type,1) over\n                                (partition by uuid, msid, app_id, instance_id, open_date, close_date--, was_demo, initiator_name, open_reason, close_reason\n                                order by action_date asc) as last_action_type_temp\n            , lead(action_type,1) over\n                                (partition by uuid, msid, app_id, instance_id, open_date, close_date--, was_demo, initiator_name, open_reason, close_reason\n                                order by action_date asc) as next_action_type_temp\n    FROM sunduk.baguild.slowly_with_publish_raw_delta\n    )\n\n,b AS (\n    SELECT  uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name\n            , open_reason, close_date, close_reason, is_published\n            , case  when action_type='publish' and last_action_type_temp is null and is_published then open_date\n                    when action_type='unpublish' and last_action_type_temp is null and not is_published then open_date\n                    else action_date end AS action_date\n            , case  when action_type='publish' and last_action_type_temp is null and is_published then 'open'\n                    when action_type='unpublish' and last_action_type_temp is null and not is_published then 'open'\n                    else action_type end AS action_type\n    FROM a\n    WHERE   coalesce(action_type, 'current')<>coalesce(last_action_type_temp, 'previous')\n            AND not (action_type='unpublish' and last_action_type_temp='open' and not is_published)\n)\n\n    SELECT  *\n            , lag(action_date,1) over\n                                (partition by uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason\n                                order by action_date asc) as last_action_date\n            , lag(action_type,1) over\n                                (partition by uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason\n                                order by action_date asc) as last_action_type\n            , lead(action_date,1) over\n                                (partition by uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason\n                                order by action_date asc) as next_action_date\n            , lead(action_type,1) over\n                                (partition by uuid, msid, app_id, instance_id, open_date, was_demo, initiator_name, open_reason, close_date, close_reason\n                                order by action_date asc) as next_action_type\n    FROM a",
            "queryName": "create sunduk.baguild.slowly_with_publish_temp_filtered_delta",
            "queryStats": {
                "elapsedTime": "4.18s",
                "planningTime": "457.41ms",
                "analysisTime": "189.95ms",
                "queuedTime": "5.84ms",
                "executionTime": "3.99s",
                "totalCpuTime": "16.01s",
                "rawInputDataSize": "18.33MB",
                "internalNetworkInputDataSize": "139.36MB",
                "physicalInputDataSize": "18.33MB",
                "processedInputDataSize": "18.33MB",
                "rawInputPositions": "573689",
                "internalNetworkInputPositions": "573705",
                "physicalInputPositions": "573689",
                "processedInputPositions": "573689",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "164.08MB",
                "writtenPositions": "573689",
                "peakTotalMemoryReservation": "172.50kB",
                "peakTaskTotalMemory": "57.50kB",
                "totalSplits": 157,
                "connectorSplits": "0",
                "numberOfWorkers": 36,
                "connectorTables": [
                    "sunduk.baguild.slowly_with_publish_raw_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "3.53s",
                    "totalQueuedTime": "1.76ms",
                    "totalScheduledTime": "1.00s",
                    "totalCpuTime": "25.60ms",
                    "totalBlockedTime": "12.61s",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "2.24s",
                    "totalQueuedTime": "2.13s",
                    "totalScheduledTime": "18.02s",
                    "totalCpuTime": "13.07s",
                    "totalBlockedTime": "4.19m",
                    "rawInputDataSize": "139.36MB",
                    "internalNetworkInputDataSize": "139.36MB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "147.84MB",
                    "rawInputPositions": "573689",
                    "internalNetworkInputPositions": "573689",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "573689",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 144,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "92.00ms",
                    "totalQueuedTime": "10.73ms",
                    "totalScheduledTime": "3.83s",
                    "totalCpuTime": "2.91s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "18.33MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "18.33MB",
                    "processedInputDataSize": "18.33MB",
                    "rawInputPositions": "573689",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "573689",
                    "processedInputPositions": "573689",
                    "outputDataSize": "147.83MB",
                    "outputPositions": "573689",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 8,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    3.9/5    elapsed: 00:00:13.621,  cpu: 00:00:00.025,  blocked: 00:00:12.610,  queue: 00:00:00.001,  scheduled: 00:00:01.000 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.000,  finishWall: 00:00:00.000)  other: 00:00:00.009,  timeCost: 4.4%,  blocked: 92.6%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1  121.6/144  elapsed: 00:04:32.072,  cpu: 00:00:13.070,  blocked: 00:04:11.400,  queue: 00:00:02.126,  scheduled: 00:00:18.020 (addInputWall: 00:00:02.965,  getOutputWall: 00:00:10.797,  finishWall: 00:00:04.199)  other: 00:00:00.526,  timeCost: 78.9%,  blocked: 92.4%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2   41.8/8    elapsed: 00:00:03.846,  cpu: 00:00:02.910,  blocked: 00:00:00.000,  queue: 00:00:00.010,  scheduled: 00:00:03.830 (addInputWall: 00:00:01.318,  getOutputWall: 00:00:03.050,  finishWall: 00:00:00.050)  other: 00:00:00.005,  timeCost: 16.8%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "2",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=3.3"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"24\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"22\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=slowly_with_publish_temp_filtered_delta; tablePath=s3a://wix-bi-sunduk/baguild/b7087d97-9ffd-43c7-b9d2-7d7768a442c7; columnHandles=[[action_date, timestamp, 1], [action_type, varchar(9), 2], [app_id, varchar, 3], [close_date, timestamp, 4], [close_reason, varchar(16), 5], [initiator_name, varchar, 6], [instance_id, varchar, 7], [is_published, boolean, 8], [msid, varchar, 9], [open_date, timestamp, 10], [open_reason, varchar(16), 11], [uuid, varchar, 12], [was_demo, boolean, 13], [last_action_type_temp, varchar(9), 14], [next_action_type_temp, varchar(9), 15], [last_action_date, timestamp, 16], [last_action_type, varchar(9), 17], [next_action_date, timestamp, 18], [next_action_type, varchar(9), 19]], hash=1618656007]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"593\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"524\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"23\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"action_date := action_date\\naction_type := action_type\\napp_id := app_id\\nclose_date := close_date\\nclose_reason := close_reason\\ninitiator_name := initiator_name\\ninstance_id := instance_id\\nis_published := is_published\\nmsid := msid\\nopen_date := open_date\\nopen_reason := open_reason\\nuuid := uuid\\nwas_demo := was_demo\\nlast_action_type_temp := lag\\nnext_action_type_temp := lead\\nlast_action_date := lag_105\\nlast_action_type := lag_119\\nnext_action_date := lead_133\\nnext_action_type := lead_147\\n\",\n  \"children\" : [ {\n    \"id\" : \"592\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"18\",\n      \"name\" : \"Project\",\n      \"identifier\" : \"[]\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"17\",\n        \"name\" : \"Window\",\n        \"identifier\" : \"[partition by (<uuid, msid, app_id, instance_id, open_date, close_date>, was_demo, initiator_name, open_reason, close_reason), order by (action_date ASC_NULLS_LAST)][$hashvalue]\",\n        \"details\" : \"lead_147 := lead(\\\"action_type\\\", \\\"expr_93\\\") RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\nlead_133 := lead(\\\"action_date\\\", \\\"expr_93\\\") RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\nlag_119 := lag(\\\"action_type\\\", \\\"expr_93\\\") RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\nlag_105 := lag(\\\"action_date\\\", \\\"expr_93\\\") RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\n\",\n        \"children\" : [ {\n          \"id\" : \"10\",\n          \"name\" : \"Project\",\n          \"identifier\" : \"[]\",\n          \"details\" : \"expr_93 := BIGINT '1'\\n\",\n          \"children\" : [ {\n            \"id\" : \"5\",\n            \"name\" : \"Project\",\n            \"identifier\" : \"[]\",\n            \"details\" : \"\",\n            \"children\" : [ {\n              \"id\" : \"4\",\n              \"name\" : \"Window\",\n              \"identifier\" : \"[partition by (uuid, msid, app_id, instance_id, open_date, close_date), order by (action_date ASC_NULLS_LAST)][$hashvalue_224]\",\n              \"details\" : \"lead := lead(\\\"action_type\\\", \\\"expr\\\") RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\nlag := lag(\\\"action_type\\\", \\\"expr\\\") RANGE UNBOUNDED_PRECEDING CURRENT_ROW\\n\",\n              \"children\" : [ {\n                \"id\" : \"591\",\n                \"name\" : \"LocalExchange\",\n                \"identifier\" : \"[HASH][$hashvalue_224] (\\\"uuid\\\", \\\"msid\\\", \\\"app_id\\\", \\\"instance_id\\\", \\\"open_date\\\", \\\"close_date\\\")\",\n                \"details\" : \"\",\n                \"children\" : [ {\n                  \"id\" : \"523\",\n                  \"name\" : \"RemoteSource\",\n                  \"identifier\" : \"[2]\",\n                  \"details\" : \"\",\n                  \"children\" : [ ],\n                  \"remoteSources\" : [ \"2\" ]\n                } ],\n                \"remoteSources\" : [ ]\n              } ],\n              \"remoteSources\" : [ ]\n            } ],\n            \"remoteSources\" : [ ]\n          } ],\n          \"remoteSources\" : [ ]\n        } ],\n        \"remoteSources\" : [ ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"1\",\n  \"name\" : \"ScanProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_raw_delta', folderName='cd01a22f-d989-44ec-b01a-6a7752caea86', columns='[[action_date,timestamp,false], [action_type,varchar(9),false], [app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}]\",\n  \"details\" : \"expr := BIGINT '1'\\n$hashvalue_227 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"was_demo\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"initiator_name\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_reason\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_reason\\\"), 0))\\n$hashvalue_228 := combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(combine_hash(bigint '0', COALESCE(\\\"$operator$hash_code\\\"(\\\"uuid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"msid\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"app_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"instance_id\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"open_date\\\"), 0)), COALESCE(\\\"$operator$hash_code\\\"(\\\"close_date\\\"), 0))\\nopen_date := [open_date, timestamp, 9]\\nmsid := [msid, varchar, 8]\\nclose_date := [close_date, timestamp, 3]\\ninstance_id := [instance_id, varchar, 6]\\naction_type := [action_type, varchar(9), 1]\\nwas_demo := [was_demo, boolean, 12]\\nis_published := [is_published, boolean, 7]\\nopen_reason := [open_reason, varchar(16), 10]\\ninitiator_name := [initiator_name, varchar, 5]\\naction_date := [action_date, timestamp, 0]\\nclose_reason := [close_reason, varchar(16), 4]\\nuuid := [uuid, varchar, 11]\\napp_id := [app_id, varchar, 2]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        },
        {
            "queryId": "20200703_034553_18361_hgfpu",
            "querySql": "-- Scheduled Quix Query --\n\n-- Committer: tomasp@wix.com\n-- Internal Name: verticals_dwh_job_slowly_changing-1.43\n-- Link: https://bo.wix.com/quix#/scheduler/job/b5b0eff3-d315-4054-8357-b91b3b4e3bb5/production/\n-- Run Job Id: 0296205-200611075401274-oozie-oozi-W\nCREATE TABLE if not exists  sunduk.baguild.apps_log_merge -- 393688569\nAS\n\n    SELECT  uuid, msid, app_id, instance_id, was_demo, initiator_name\n            , open_date\n            , open_reason\n            , close_date\n            , close_reason\n            , is_published\n    FROM sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta\n    WHERE publish_date is null or is_published -- never published rows or those opened as publish from the beginning (i.e. transfer)\n    UNION ALL\n    SELECT  uuid, msid, app_id, instance_id, was_demo, initiator_name\n            , open_date\n            , open_reason\n            , publish_date AS close_date\n            , 'publish' AS close_reason\n            , FALSE AS is_published\n    FROM sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta\n    WHERE publish_date is not null AND not is_published -- published rows from start to publish\n    UNION ALL\n    SELECT  uuid, msid, app_id, instance_id, was_demo, initiator_name\n            , publish_date AS open_date\n            , 'publish' AS open_reason\n            , close_date\n            , close_reason\n            , TRUE AS is_published\n    FROM sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta\n    WHERE publish_date is not null AND not is_published -- published rows from start to publish\n    UNION ALL\n    SELECT  uuid, msid, app_id, instance_id, was_demo, initiator_name\n            , open_date\n            , open_reason\n            , coalesce(next_action_date, close_date) AS close_date\n            , coalesce(next_action_type, close_reason) AS close_reason\n            , is_published\n    FROM sunduk.baguild.slowly_with_publish_temp_filtered_delta\n    WHERE action_type = 'open'\n    UNION ALL\n    SELECT  uuid, msid, app_id, instance_id, was_demo, initiator_name\n            , open_date\n            , open_reason\n            , action_date AS close_date\n            , action_type AS close_reason\n            , is_published\n    FROM sunduk.baguild.slowly_with_publish_temp_filtered_delta\n    WHERE last_action_type is null and coalesce(action_type, 'string') <> 'open'\n    UNION ALL\n    SELECT  uuid, msid, app_id, instance_id, was_demo, initiator_name\n            , action_date AS open_date\n            , action_type AS open_reason\n            , coalesce(next_action_date, close_date) AS close_date\n            , coalesce(next_action_type, close_reason) AS close_reason\n            , case  when action_type='publish' then TRUE\n                    when action_type='unpublish' then FALSE\n                    else null\n                    end AS is_published\n    FROM sunduk.baguild.slowly_with_publish_temp_filtered_delta\n    WHERE last_action_type is null and coalesce(action_type, 'string') <> 'open'\n        UNION ALL\n    SELECT  uuid, msid, app_id, instance_id, was_demo, initiator_name\n            , action_date AS open_date\n            , action_type AS open_reason\n            , coalesce(next_action_date, close_date) AS close_date\n            , coalesce(next_action_type, close_reason) AS close_reason\n            , case  when action_type='publish' then TRUE\n                    when action_type='unpublish' then FALSE\n                    else null\n                    end AS is_published\n    FROM sunduk.baguild.slowly_with_publish_temp_filtered_delta\n    WHERE last_action_type is not null and coalesce(action_type, 'string') <> 'open'\n        UNION ALL\n    SELECT uuid,msid,app_id,instance_id,was_demo,initiator_name,open_date,open_reason,close_date,close_reason,is_published\n    FROM sunduk.baguild.apps_log\n    WHERE close_date <= date '2050-01-01'",
            "queryName": "create sunduk.baguild.apps_log_merge",
            "queryStats": {
                "elapsedTime": "10.79m",
                "planningTime": "2.64s",
                "analysisTime": "843.73ms",
                "queuedTime": "144.56us",
                "executionTime": "10.78m",
                "totalCpuTime": "4.13h",
                "rawInputDataSize": "264.50GB",
                "internalNetworkInputDataSize": "376.75GB",
                "physicalInputDataSize": "264.50GB",
                "processedInputDataSize": "264.50GB",
                "rawInputPositions": "4789010236",
                "internalNetworkInputPositions": "1924764941",
                "physicalInputPositions": "4789010236",
                "processedInputPositions": "4789010236",
                "outputDataSize": "9B",
                "outputPositions": "1",
                "physicalWrittenDataSize": "0B",
                "logicalWrittenDataSize": "395.92GB",
                "writtenPositions": "1924764925",
                "peakTotalMemoryReservation": "5.32GB",
                "peakTaskTotalMemory": "476.41MB",
                "totalSplits": 2301,
                "connectorSplits": "0",
                "numberOfWorkers": 36,
                "connectorTables": [
                    "sunduk.baguild.apps_log",
                    "sunduk.baguild.slowly_with_publish_temp_filtered_delta",
                    "sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta"
                ],
                "tableInputSize": {}
            },
            "stageStats": {
                "0": {
                    "stageDuration": "10.73m",
                    "totalQueuedTime": "1.35ms",
                    "totalScheduledTime": "1.78s",
                    "totalCpuTime": "94.58ms",
                    "totalBlockedTime": "53.52m",
                    "rawInputDataSize": "1008B",
                    "internalNetworkInputDataSize": "1008B",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "224B",
                    "rawInputPositions": "16",
                    "internalNetworkInputPositions": "16",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "16",
                    "outputDataSize": "9B",
                    "outputPositions": "1",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 5,
                    "spilledDataSize": "0B"
                },
                "1": {
                    "stageDuration": "9.90m",
                    "totalQueuedTime": "6.68m",
                    "totalScheduledTime": "1.54h",
                    "totalCpuTime": "1.32h",
                    "totalBlockedTime": "5.96h",
                    "rawInputDataSize": "376.75GB",
                    "internalNetworkInputDataSize": "376.75GB",
                    "physicalInputDataSize": "0B",
                    "processedInputDataSize": "395.92GB",
                    "rawInputPositions": "1924764925",
                    "internalNetworkInputPositions": "1924764925",
                    "physicalInputPositions": "0",
                    "processedInputPositions": "1924764925",
                    "outputDataSize": "224B",
                    "outputPositions": "16",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 80,
                    "spilledDataSize": "0B"
                },
                "2": {
                    "stageDuration": "9.02m",
                    "totalQueuedTime": "13.51h",
                    "totalScheduledTime": "51.16m",
                    "totalCpuTime": "42.02m",
                    "totalBlockedTime": "9.82h",
                    "rawInputDataSize": "40GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "40GB",
                    "processedInputDataSize": "40GB",
                    "rawInputPositions": "955265040",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955265040",
                    "processedInputPositions": "955265040",
                    "outputDataSize": "192.62GB",
                    "outputPositions": "954389593",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 419,
                    "spilledDataSize": "0B"
                },
                "3": {
                    "stageDuration": "3.27m",
                    "totalQueuedTime": "2.57h",
                    "totalScheduledTime": "35.43m",
                    "totalCpuTime": "27.09m",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "52.33GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "52.33GB",
                    "processedInputDataSize": "52.33GB",
                    "rawInputPositions": "955265040",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955265040",
                    "processedInputPositions": "955265040",
                    "outputDataSize": "186.80MB",
                    "outputPositions": "875447",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 419,
                    "spilledDataSize": "0B"
                },
                "4": {
                    "stageDuration": "2.66m",
                    "totalQueuedTime": "2.52h",
                    "totalScheduledTime": "34.31m",
                    "totalCpuTime": "25.42m",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "55.53GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "55.53GB",
                    "processedInputDataSize": "55.53GB",
                    "rawInputPositions": "955265040",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "955265040",
                    "processedInputPositions": "955265040",
                    "outputDataSize": "180.92MB",
                    "outputPositions": "875447",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 419,
                    "spilledDataSize": "0B"
                },
                "5": {
                    "stageDuration": "1.95m",
                    "totalQueuedTime": "1.26m",
                    "totalScheduledTime": "3.93s",
                    "totalCpuTime": "1.76s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "15.23MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "15.23MB",
                    "processedInputDataSize": "15.23MB",
                    "rawInputPositions": "573689",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "573689",
                    "processedInputPositions": "573689",
                    "outputDataSize": "28.37MB",
                    "outputPositions": "131850",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "6": {
                    "stageDuration": "2.10m",
                    "totalQueuedTime": "1.04m",
                    "totalScheduledTime": "4.80s",
                    "totalCpuTime": "1.58s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "9.51MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "9.51MB",
                    "processedInputDataSize": "9.51MB",
                    "rawInputPositions": "573689",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "573689",
                    "processedInputPositions": "573689",
                    "outputDataSize": "13.35MB",
                    "outputPositions": "62528",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "7": {
                    "stageDuration": "1.75m",
                    "totalQueuedTime": "1.30m",
                    "totalScheduledTime": "3.96s",
                    "totalCpuTime": "1.51s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "11.62MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "11.62MB",
                    "processedInputDataSize": "11.62MB",
                    "rawInputPositions": "573689",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "573689",
                    "processedInputPositions": "573689",
                    "outputDataSize": "13.39MB",
                    "outputPositions": "62528",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "8": {
                    "stageDuration": "2.53m",
                    "totalQueuedTime": "1.31m",
                    "totalScheduledTime": "5.34s",
                    "totalCpuTime": "2.35s",
                    "totalBlockedTime": "0.00ns",
                    "rawInputDataSize": "11.22MB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "11.22MB",
                    "processedInputDataSize": "11.22MB",
                    "rawInputPositions": "573689",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "573689",
                    "processedInputPositions": "573689",
                    "outputDataSize": "81.23MB",
                    "outputPositions": "379311",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 16,
                    "spilledDataSize": "0B"
                },
                "9": {
                    "stageDuration": "9.02m",
                    "totalQueuedTime": "18.83h",
                    "totalScheduledTime": "1.64h",
                    "totalCpuTime": "1.23h",
                    "totalBlockedTime": "8.12h",
                    "rawInputDataSize": "116.59GB",
                    "internalNetworkInputDataSize": "0B",
                    "physicalInputDataSize": "116.59GB",
                    "processedInputDataSize": "116.59GB",
                    "rawInputPositions": "1920920360",
                    "internalNetworkInputPositions": "0",
                    "physicalInputPositions": "1920920360",
                    "processedInputPositions": "1920920360",
                    "outputDataSize": "202.82GB",
                    "outputPositions": "967988221",
                    "physicalWrittenDataSize": "0B",
                    "totalMemoryReservation": "0B",
                    "totalSplits": 895,
                    "spilledDataSize": "0B"
                }
            },
            "insights": [
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.slowly_with_publish_temp_filtered_delta scanned 4 times"
                },
                {
                    "source": {},
                    "level": "INFO",
                    "message": "Multiple scans of the same table: sunduk.baguild.slowly_with_publish_temp_never_unpublish_sites_delta scanned 3 times"
                },
                {
                    "source": {
                        "stageId": "0"
                    },
                    "level": "INFO",
                    "message": "stage.0    5.0/5    elapsed: 00:53:33.089,  cpu: 00:00:00.094,  blocked: 00:53:31.200,  queue: 00:00:00.001,  scheduled: 00:00:01.780 (addInputWall: 00:00:00.000,  getOutputWall: 00:00:01.780,  finishWall: 00:00:00.000)  other: 00:00:00.108,  timeCost: 0.0%,  blocked: 99.9%"
                },
                {
                    "source": {
                        "stageId": "1"
                    },
                    "level": "INFO",
                    "message": "stage.1   76.7/80   elapsed: 12:39:24.423,  cpu: 01:19:12.000,  blocked: 05:57:36.000,  queue: 00:06:40.734,  scheduled: 01:32:24.000 (addInputWall: 01:20:28.191,  getOutputWall: 00:01:33.890,  finishWall: 00:10:42.000)  other: 05:02:43.689,  timeCost: 29.6%,  blocked: 47.1%"
                },
                {
                    "source": {
                        "stageId": "2"
                    },
                    "level": "INFO",
                    "message": "stage.2  169.8/419  elapsed: 25:31:45.528,  cpu: 00:42:01.200,  blocked: 09:49:12.000,  queue: 13:30:47.219,  scheduled: 00:51:09.600 (addInputWall: 00:13:30.600,  getOutputWall: 00:47:34.800,  finishWall: 00:00:00.000)  other: 01:20:36.709,  timeCost: 16.4%,  blocked: 38.5%"
                },
                {
                    "source": {
                        "stageId": "3"
                    },
                    "level": "INFO",
                    "message": "stage.3   79.5/419  elapsed: 04:20:10.741,  cpu: 00:27:05.400,  blocked: 00:00:00.000,  queue: 02:34:06.920,  scheduled: 00:35:25.800 (addInputWall: 00:12:15.172,  getOutputWall: 00:35:25.800,  finishWall: 00:00:00.000)  other: 01:10:38.020,  timeCost: 11.4%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "3",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 99.7 of data dropped"
                },
                {
                    "source": {
                        "stageId": "4"
                    },
                    "level": "INFO",
                    "message": "stage.4   95.5/419  elapsed: 04:14:27.579,  cpu: 00:25:25.200,  blocked: 00:00:00.000,  queue: 02:31:05.541,  scheduled: 00:34:18.600 (addInputWall: 00:12:13.382,  getOutputWall: 00:34:18.600,  finishWall: 00:00:00.000)  other: 01:09:03.437,  timeCost: 11.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "4",
                        "pipelineId": "0",
                        "operatorId": "0"
                    },
                    "level": "INFO",
                    "message": "High selectivity in filter: 99.7 of data dropped"
                },
                {
                    "source": {
                        "stageId": "5"
                    },
                    "level": "INFO",
                    "message": "stage.5    0.7/16   elapsed: 00:01:19.423,  cpu: 00:00:01.760,  blocked: 00:00:00.000,  queue: 00:01:15.492,  scheduled: 00:00:03.930 (addInputWall: 00:00:00.919,  getOutputWall: 00:00:03.900,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "5",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.7"
                },
                {
                    "source": {
                        "stageId": "6"
                    },
                    "level": "INFO",
                    "message": "stage.6    0.5/16   elapsed: 00:01:07.187,  cpu: 00:00:01.580,  blocked: 00:00:00.000,  queue: 00:01:02.384,  scheduled: 00:00:04.800 (addInputWall: 00:00:00.677,  getOutputWall: 00:00:04.788,  finishWall: 00:00:00.000)  other: 00:00:00.002,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "6",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.8"
                },
                {
                    "source": {
                        "stageId": "7"
                    },
                    "level": "INFO",
                    "message": "stage.7    0.8/16   elapsed: 00:01:22.139,  cpu: 00:00:01.510,  blocked: 00:00:00.000,  queue: 00:01:18.184,  scheduled: 00:00:03.960 (addInputWall: 00:00:00.737,  getOutputWall: 00:00:03.940,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "7",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.7"
                },
                {
                    "source": {
                        "stageId": "8"
                    },
                    "level": "INFO",
                    "message": "stage.8    0.6/16   elapsed: 00:01:23.966,  cpu: 00:00:02.350,  blocked: 00:00:00.000,  queue: 00:01:18.630,  scheduled: 00:00:05.340 (addInputWall: 00:00:00.515,  getOutputWall: 00:00:05.250,  finishWall: 00:00:00.000)  other: 00:00:00.000,  timeCost: 0.0%,  blocked: 0.0%"
                },
                {
                    "source": {
                        "stageId": "8",
                        "pipelineId": "0"
                    },
                    "level": "INFO",
                    "message": "Long tail splits detected: Max/P90=2.3"
                },
                {
                    "source": {
                        "stageId": "9"
                    },
                    "level": "INFO",
                    "message": "stage.9  200.3/895  elapsed: 30:06:32.077,  cpu: 01:13:48.000,  blocked: 08:07:11.999,  queue: 18:49:53.415,  scheduled: 01:38:24.000 (addInputWall: 00:34:33.600,  getOutputWall: 01:34:48.000,  finishWall: 00:00:00.001)  other: 01:31:02.662,  timeCost: 31.5%,  blocked: 27.0%"
                }
            ],
            "stagePlan": {
                "stageId": "0",
                "plan": "{\n  \"id\" : \"48\",\n  \"name\" : \"Output\",\n  \"identifier\" : \"[rows]\",\n  \"details\" : \"\",\n  \"children\" : [ {\n    \"id\" : \"46\",\n    \"name\" : \"TableCommit\",\n    \"identifier\" : \"[sunduk:connectorId=sunduk; schemaName=baguild; tableName=apps_log_merge; tablePath=s3a://wix-bi-sunduk/baguild/fa77181d-e310-4232-a3de-b3d60ca9aea9; columnHandles=[[uuid, varchar, 1], [msid, varchar, 2], [app_id, varchar, 3], [instance_id, varchar, 4], [was_demo, boolean, 5], [initiator_name, varchar, 6], [open_date, timestamp, 7], [open_reason, varchar(16), 8], [close_date, timestamp, 9], [close_reason, varchar(16), 10], [is_published, boolean, 11]], hash=556404833]\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1370\",\n      \"name\" : \"LocalExchange\",\n      \"identifier\" : \"[SINGLE] ()\",\n      \"details\" : \"\",\n      \"children\" : [ {\n        \"id\" : \"1184\",\n        \"name\" : \"RemoteSource\",\n        \"identifier\" : \"[1]\",\n        \"details\" : \"\",\n        \"children\" : [ ],\n        \"remoteSources\" : [ \"1\" ]\n      } ],\n      \"remoteSources\" : [ ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                "subStages": [
                    {
                        "stageId": "1",
                        "plan": "{\n  \"id\" : \"47\",\n  \"name\" : \"TableWriter\",\n  \"identifier\" : \"\",\n  \"details\" : \"uuid := uuid_399\\nmsid := msid_400\\napp_id := app_id_401\\ninstance_id := instance_id_402\\nwas_demo := was_demo_403\\ninitiator_name := initiator_name_404\\nopen_date := open_date_405\\nopen_reason := open_reason_406\\nclose_date := close_date_407\\nclose_reason := close_reason_408\\nis_published := is_published_409\\n\",\n  \"children\" : [ {\n    \"id\" : \"1369\",\n    \"name\" : \"LocalExchange\",\n    \"identifier\" : \"[SINGLE] ()\",\n    \"details\" : \"\",\n    \"children\" : [ {\n      \"id\" : \"1183\",\n      \"name\" : \"RemoteSource\",\n      \"identifier\" : \"[2,3,4,5,6,7,8,9]\",\n      \"details\" : \"\",\n      \"children\" : [ ],\n      \"remoteSources\" : [ \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\" ]\n    } ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                        "subStages": [
                            {
                                "stageId": "2",
                                "plan": "{\n  \"id\" : \"2\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_never_unpublish_sites_delta', folderName='6ad64e4b-b694-4077-bbe0-ae8f82f8f12e', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [publish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((\\\"publish_date\\\" IS NULL) OR \\\"is_published\\\")]\",\n  \"details\" : \"open_date := [open_date, timestamp, 7]\\nmsid := [msid, varchar, 6]\\nclose_date := [close_date, timestamp, 1]\\ninstance_id := [instance_id, varchar, 4]\\nwas_demo := [was_demo, boolean, 11]\\nis_published := [is_published, boolean, 5]\\nopen_reason := [open_reason, varchar(16), 8]\\ninitiator_name := [initiator_name, varchar, 3]\\nclose_reason := [close_reason, varchar(16), 2]\\nuuid := [uuid, varchar, 10]\\npublish_date := [publish_date, timestamp, 9]\\napp_id := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "3",
                                "plan": "{\n  \"id\" : \"8\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_never_unpublish_sites_delta', folderName='6ad64e4b-b694-4077-bbe0-ae8f82f8f12e', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [publish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((NOT (\\\"publish_date_31\\\" IS NULL)) AND (NOT \\\"is_published_27\\\"))]\",\n  \"details\" : \"expr_64 := CAST('publish' AS varchar(16))\\nexpr_43 := false\\nopen_reason_30 := [open_reason, varchar(16), 8]\\ninstance_id_26 := [instance_id, varchar, 4]\\nuuid_32 := [uuid, varchar, 10]\\napp_id_22 := [app_id, varchar, 0]\\nwas_demo_33 := [was_demo, boolean, 11]\\npublish_date_31 := [publish_date, timestamp, 9]\\n    :: [(<min>, <max>)]\\nis_published_27 := [is_published, boolean, 5]\\nopen_date_29 := [open_date, timestamp, 7]\\ninitiator_name_25 := [initiator_name, varchar, 3]\\nmsid_28 := [msid, varchar, 6]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "4",
                                "plan": "{\n  \"id\" : \"14\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_never_unpublish_sites_delta', folderName='6ad64e4b-b694-4077-bbe0-ae8f82f8f12e', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [publish_date,timestamp,false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((NOT (\\\"publish_date_86\\\" IS NULL)) AND (NOT \\\"is_published_82\\\"))]\",\n  \"details\" : \"expr_99 := true\\nexpr_118 := CAST('publish' AS varchar(16))\\nclose_date_78 := [close_date, timestamp, 1]\\nmsid_83 := [msid, varchar, 6]\\nuuid_87 := [uuid, varchar, 10]\\ninitiator_name_80 := [initiator_name, varchar, 3]\\nis_published_82 := [is_published, boolean, 5]\\napp_id_77 := [app_id, varchar, 0]\\ninstance_id_81 := [instance_id, varchar, 4]\\nwas_demo_88 := [was_demo, boolean, 11]\\npublish_date_86 := [publish_date, timestamp, 9]\\n    :: [(<min>, <max>)]\\nclose_reason_79 := [close_reason, varchar(16), 2]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "5",
                                "plan": "{\n  \"id\" : \"18\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_filtered_delta', folderName='b7087d97-9ffd-43c7-b9d2-7d7768a442c7', columns='[[action_date,timestamp,false], [action_type,varchar(9),false], [app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [last_action_date,timestamp,false], [last_action_type,varchar(9),false], [last_action_type_temp,varchar(9),false], [msid,varchar,false], [next_action_date,timestamp,false], [next_action_type,varchar(9),false], [next_action_type_temp,varchar(9),false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"action_type\\\" = CAST('open' AS varchar(9)))]\",\n  \"details\" : \"expr_152 := COALESCE(\\\"next_action_date\\\", \\\"close_date_134\\\")\\nexpr_153 := COALESCE(CAST(\\\"next_action_type\\\" AS varchar(16)), \\\"close_reason_135\\\")\\nopen_date_140 := [open_date, timestamp, 15]\\nclose_date_134 := [close_date, timestamp, 3]\\naction_type := [action_type, varchar(9), 1]\\n    :: [[open]]\\ninstance_id_137 := [instance_id, varchar, 6]\\nopen_reason_141 := [open_reason, varchar(16), 16]\\nnext_action_type := [next_action_type, varchar(9), 13]\\nclose_reason_135 := [close_reason, varchar(16), 4]\\nnext_action_date := [next_action_date, timestamp, 12]\\nis_published_138 := [is_published, boolean, 7]\\nuuid_142 := [uuid, varchar, 17]\\napp_id_133 := [app_id, varchar, 2]\\nwas_demo_143 := [was_demo, boolean, 18]\\ninitiator_name_136 := [initiator_name, varchar, 5]\\nmsid_139 := [msid, varchar, 11]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "6",
                                "plan": "{\n  \"id\" : \"25\",\n  \"name\" : \"Project\",\n  \"identifier\" : \"[]\",\n  \"details\" : \"expr_227 := CAST(\\\"action_type_178\\\" AS varchar(16))\\n\",\n  \"children\" : [ {\n    \"id\" : \"23\",\n    \"name\" : \"ScanFilterProject\",\n    \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_filtered_delta', folderName='b7087d97-9ffd-43c7-b9d2-7d7768a442c7', columns='[[action_date,timestamp,false], [action_type,varchar(9),false], [app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [last_action_date,timestamp,false], [last_action_type,varchar(9),false], [last_action_type_temp,varchar(9),false], [msid,varchar,false], [next_action_date,timestamp,false], [next_action_type,varchar(9),false], [next_action_type_temp,varchar(9),false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((\\\"last_action_type_186\\\" IS NULL) AND (COALESCE(\\\"action_type_178\\\", CAST('string' AS varchar(9))) <> CAST('open' AS varchar(9))))]\",\n    \"details\" : \"instance_id_183 := [instance_id, varchar, 6]\\nis_published_184 := [is_published, boolean, 7]\\nopen_reason_193 := [open_reason, varchar(16), 16]\\naction_type_178 := [action_type, varchar(9), 1]\\nuuid_194 := [uuid, varchar, 17]\\nmsid_188 := [msid, varchar, 11]\\nwas_demo_195 := [was_demo, boolean, 18]\\nlast_action_type_186 := [last_action_type, varchar(9), 9]\\n    :: [NULL]\\naction_date_177 := [action_date, timestamp, 0]\\nopen_date_192 := [open_date, timestamp, 15]\\ninitiator_name_182 := [initiator_name, varchar, 5]\\napp_id_179 := [app_id, varchar, 2]\\n\",\n    \"children\" : [ ],\n    \"remoteSources\" : [ ]\n  } ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "7",
                                "plan": "{\n  \"id\" : \"31\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_filtered_delta', folderName='b7087d97-9ffd-43c7-b9d2-7d7768a442c7', columns='[[action_date,timestamp,false], [action_type,varchar(9),false], [app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [last_action_date,timestamp,false], [last_action_type,varchar(9),false], [last_action_type_temp,varchar(9),false], [msid,varchar,false], [next_action_date,timestamp,false], [next_action_type,varchar(9),false], [next_action_type_temp,varchar(9),false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((\\\"last_action_type_249\\\" IS NULL) AND (COALESCE(\\\"action_type_241\\\", CAST('string' AS varchar(9))) <> CAST('open' AS varchar(9))))]\",\n  \"details\" : \"expr_269 := (CASE WHEN (\\\"action_type_241\\\" = CAST('publish' AS varchar(9))) THEN true WHEN (\\\"action_type_241\\\" = 'unpublish') THEN false END)\\nexpr_268 := COALESCE(CAST(\\\"next_action_type_253\\\" AS varchar(16)), \\\"close_reason_244\\\")\\nexpr_267 := COALESCE(\\\"next_action_date_252\\\", \\\"close_date_243\\\")\\nexpr_288 := CAST(\\\"action_type_241\\\" AS varchar(16))\\nnext_action_date_252 := [next_action_date, timestamp, 12]\\ninitiator_name_245 := [initiator_name, varchar, 5]\\nclose_reason_244 := [close_reason, varchar(16), 4]\\nmsid_251 := [msid, varchar, 11]\\naction_type_241 := [action_type, varchar(9), 1]\\naction_date_240 := [action_date, timestamp, 0]\\napp_id_242 := [app_id, varchar, 2]\\ninstance_id_246 := [instance_id, varchar, 6]\\nclose_date_243 := [close_date, timestamp, 3]\\nuuid_257 := [uuid, varchar, 17]\\nnext_action_type_253 := [next_action_type, varchar(9), 13]\\nwas_demo_258 := [was_demo, boolean, 18]\\nlast_action_type_249 := [last_action_type, varchar(9), 9]\\n    :: [NULL]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "8",
                                "plan": "{\n  \"id\" : \"37\",\n  \"name\" : \"ScanFilterProject\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='slowly_with_publish_temp_filtered_delta', folderName='b7087d97-9ffd-43c7-b9d2-7d7768a442c7', columns='[[action_date,timestamp,false], [action_type,varchar(9),false], [app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [last_action_date,timestamp,false], [last_action_type,varchar(9),false], [last_action_type_temp,varchar(9),false], [msid,varchar,false], [next_action_date,timestamp,false], [next_action_type,varchar(9),false], [next_action_type_temp,varchar(9),false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = ((NOT (\\\"last_action_type_312\\\" IS NULL)) AND (COALESCE(\\\"action_type_304\\\", CAST('string' AS varchar(9))) <> CAST('open' AS varchar(9))))]\",\n  \"details\" : \"expr_331 := COALESCE(CAST(\\\"next_action_type_316\\\" AS varchar(16)), \\\"close_reason_307\\\")\\nexpr_330 := COALESCE(\\\"next_action_date_315\\\", \\\"close_date_306\\\")\\nexpr_351 := CAST(\\\"action_type_304\\\" AS varchar(16))\\nexpr_332 := (CASE WHEN (\\\"action_type_304\\\" = CAST('publish' AS varchar(9))) THEN true WHEN (\\\"action_type_304\\\" = 'unpublish') THEN false END)\\napp_id_305 := [app_id, varchar, 2]\\nuuid_320 := [uuid, varchar, 17]\\nlast_action_type_312 := [last_action_type, varchar(9), 9]\\n    :: [(<min>, <max>)]\\nclose_date_306 := [close_date, timestamp, 3]\\nnext_action_type_316 := [next_action_type, varchar(9), 13]\\ninstance_id_309 := [instance_id, varchar, 6]\\nnext_action_date_315 := [next_action_date, timestamp, 12]\\ninitiator_name_308 := [initiator_name, varchar, 5]\\nwas_demo_321 := [was_demo, boolean, 18]\\nclose_reason_307 := [close_reason, varchar(16), 4]\\nmsid_314 := [msid, varchar, 11]\\naction_type_304 := [action_type, varchar(9), 1]\\naction_date_303 := [action_date, timestamp, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            },
                            {
                                "stageId": "9",
                                "plan": "{\n  \"id\" : \"1182\",\n  \"name\" : \"ScanFilter\",\n  \"identifier\" : \"[table = sunduk:TableHandle{connectorId='sunduk', dataRealmName='baguild', schemaName='baguild', tableName='apps_log', folderName='fb1d2dde-331f-4fe6-ad86-94479752e9c6', columns='[[app_id,varchar,false], [close_date,timestamp,false], [close_reason,varchar(16),false], [initiator_name,varchar,false], [instance_id,varchar,false], [is_published,boolean,false], [msid,varchar,false], [open_date,timestamp,false], [open_reason,varchar(16),false], [uuid,varchar,false], [was_demo,boolean,false]]'}, filterPredicate = (\\\"close_date_367\\\" <= \\\"@$literal$|timestamp|bigint@$literal$<f,t>(f):t\\\"(2524608000000))]\",\n  \"details\" : \"uuid_375 := [uuid, varchar, 9]\\nis_published_371 := [is_published, boolean, 5]\\nopen_date_373 := [open_date, timestamp, 7]\\nmsid_372 := [msid, varchar, 6]\\ninstance_id_370 := [instance_id, varchar, 4]\\nclose_date_367 := [close_date, timestamp, 1]\\n    :: [(<min>, 2050-01-01 00:00:00.000]]\\ninitiator_name_369 := [initiator_name, varchar, 3]\\nclose_reason_368 := [close_reason, varchar(16), 2]\\nwas_demo_376 := [was_demo, boolean, 10]\\nopen_reason_374 := [open_reason, varchar(16), 8]\\napp_id_366 := [app_id, varchar, 0]\\n\",\n  \"children\" : [ ],\n  \"remoteSources\" : [ ]\n}",
                                "subStages": []
                            }
                        ]
                    }
                ]
            }
        }
    ]
}